(()=>{var t={3059:t=>{function e(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+n:t-n}return 0|Math.min(t,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(t){this.ms=t},e.prototype.setMax=function(t){this.max=t},e.prototype.setJitter=function(t){this.jitter=t}},3371:(t,e)=>{!function(t){"use strict";e.encode=function(e){var n,a=new Uint8Array(e),s=a.length,r="";for(n=0;n<s;n+=3)r+=t[a[n]>>2],r+=t[(3&a[n])<<4|a[n+1]>>4],r+=t[(15&a[n+1])<<2|a[n+2]>>6],r+=t[63&a[n+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},e.decode=function(e){var n,a,s,r,i,o=.75*e.length,l=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var E=new ArrayBuffer(o),T=new Uint8Array(E);for(n=0;n<l;n+=4)a=t.indexOf(e[n]),s=t.indexOf(e[n+1]),r=t.indexOf(e[n+2]),i=t.indexOf(e[n+3]),T[c++]=a<<2|s>>4,T[c++]=(15&s)<<4|r>>2,T[c++]=(3&r)<<6|63&i;return E}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},5971:t=>{function e(t){if(t)return function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,a=this._callbacks["$"+t];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<a.length;s++)if((n=a[s])===e||n.fn===e){a.splice(s,1);break}return 0===a.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],a=1;a<arguments.length;a++)e[a-1]=arguments[a];if(n){a=0;for(var s=(n=n.slice(0)).length;a<s;++a)n[a].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},7833:(t,e,n)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let a=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(a++,"%c"===t&&(s=a))})),e.splice(s,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(736)(e);const{formatters:a}=t.exports;a.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},736:(t,e,n)=>{t.exports=function(t){function e(t){let n,s,r,i=null;function o(...t){if(!o.enabled)return;const a=o,s=Number(new Date),r=s-(n||s);a.diff=r,a.prev=n,a.curr=s,n=s,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let i=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,s)=>{if("%%"===n)return"%";i++;const r=e.formatters[s];if("function"==typeof r){const e=t[i];n=r.call(a,e),t.splice(i,1),i--}return n})),e.formatArgs.call(a,t),(a.log||e.log).apply(a,t)}return o.namespace=t,o.useColors=e.useColors(),o.color=e.selectColor(t),o.extend=a,o.destroy=e.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==i?i:(s!==e.namespaces&&(s=e.namespaces,r=e.enabled(t)),r),set:t=>{i=t}}),"function"==typeof e.init&&e.init(o),o}function a(t,n){const a=e(this.namespace+(void 0===n?":":n)+t);return a.log=this.log,a}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(s),...e.skips.map(s).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const a=("string"==typeof t?t:"").split(/[\s,]+/),s=a.length;for(n=0;n<s;n++)a[n]&&("-"===(t=a[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,a;for(n=0,a=e.skips.length;n<a;n++)if(e.skips[n].test(t))return!1;for(n=0,a=e.names.length;n<a;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(6585),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},104:t=>{t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},3357:(t,e,n)=>{const a=n(7292);t.exports=(t,e)=>new a(t,e),t.exports.Socket=a,t.exports.protocol=a.protocol,t.exports.Transport=n(2672),t.exports.transports=n(8520),t.exports.parser=n(6809)},7292:(t,e,n)=>{const a=n(8520),s=n(5971),r=n(7833)("engine.io-client:socket"),i=n(6809),o=n(4258),l=n(9140),{installTimerFunctions:c}=n(9773);class E extends s{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=o(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=o(e.host).host),c(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=l.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){r('creating transport "%s"',t);const e=function(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.opts.query);e.EIO=i.protocol,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return r("options: %j",n),new a[t](n)}open(){let t;if(this.opts.rememberUpgrade&&E.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emit("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return r("error while creating transport: %s",t),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){r("setting transport %s",t.name),this.transport&&(r("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(()=>{this.onClose("transport close")}))}probe(t){r('probing transport "%s"',t);let e=this.createTransport(t,{probe:1}),n=!1;E.priorWebsocketSuccess=!1;const a=()=>{n||(r('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(a=>{if(!n)if("pong"===a.type&&"probe"===a.data){if(r('probe transport "%s" pong',t),this.upgrading=!0,this.emit("upgrading",e),!e)return;E.priorWebsocketSuccess="websocket"===e.name,r('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{n||"closed"!==this.readyState&&(r("changing transport and sending upgrade packet"),T(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emit("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{r('probe transport "%s" failed',t);const n=new Error("probe error");n.transport=e.name,this.emit("upgradeError",n)}})))};function s(){n||(n=!0,T(),e.close(),e=null)}const i=n=>{const a=new Error("probe error: "+n);a.transport=e.name,s(),r('probe transport "%s" failed because of error: %s',t,n),this.emit("upgradeError",a)};function o(){i("transport closed")}function l(){i("socket closed")}function c(t){e&&t.name!==e.name&&(r('"%s" works - aborting "%s"',t.name,e.name),s())}const T=()=>{e.removeListener("open",a),e.removeListener("error",i),e.removeListener("close",o),this.removeListener("close",l),this.removeListener("upgrading",c)};e.once("open",a),e.once("error",i),e.once("close",o),this.once("close",l),this.once("upgrading",c),e.open()}onOpen(){if(r("socket open"),this.readyState="open",E.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){r("starting upgrade probes");let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(r('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else r('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(r("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,a){if("function"==typeof e&&(a=e,e=void 0),"function"==typeof n&&(a=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const s={type:t,data:e,options:n};this.emit("packetCreate",s),this.writeBuffer.push(s),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this.onClose("forced close"),r("socket closing - telling transport to close"),this.transport.close()},e=()=>{this.removeListener("upgrade",e),this.removeListener("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){r("socket error %j",t),E.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(r('socket close with reason: "%s"',t),this.clearTimeoutFn(this.pingIntervalTimer),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const a=t.length;for(;n<a;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}E.priorWebsocketSuccess=!1,E.protocol=i.protocol,t.exports=E},2672:(t,e,n)=>{const a=n(6809),s=n(5971),{installTimerFunctions:r}=n(9773),i=n(7833)("engine.io-client:transport");t.exports=class extends s{constructor(t){super(),r(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e){const n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState?this.write(t):i("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(t){const e=a.decodePacket(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){this.emit("packet",t)}onClose(){this.readyState="closed",this.emit("close")}}},8520:(t,e,n)=>{const a=n(3051),s=n(9332),r=n(2252),i=n(6855);e.polling=function(t){let e,n=!1,i=!1;const o=!1!==t.jsonp;if("undefined"!=typeof location){const e="https:"===location.protocol;let a=location.port;a||(a=e?443:80),n=t.hostname!==location.hostname||a!==t.port,i=t.secure!==e}if(t.xdomain=n,t.xscheme=i,e=new a(t),"open"in e&&!t.forceJSONP)return new s(t);if(!o)throw new Error("JSONP disabled");return new r(t)},e.websocket=i},2252:(t,e,n)=>{const a=n(5911),s=n(104),r=/\n/g,i=/\\n/g;let o;t.exports=class extends a{constructor(t){super(t),this.query=this.query||{},o||(o=s.___eio=s.___eio||[]),this.index=o.length,o.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=t=>{this.onError("jsonp poll error",t)};const e=document.getElementsByTagName("script")[0];e?e.parentNode.insertBefore(t,e):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&this.setTimeoutFn((function(){const t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)}doWrite(t,e){let n;if(!this.form){const t=document.createElement("form"),e=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;t.className="socketio",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.target=n,t.method="POST",t.setAttribute("accept-charset","utf-8"),e.name="d",t.appendChild(e),document.body.appendChild(t),this.form=t,this.area=e}function a(){s(),e()}this.form.action=this.uri();const s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(t){this.onError("jsonp polling iframe removal error",t)}try{const t='<iframe src="javascript:0" name="'+this.iframeId+'">';n=document.createElement(t)}catch(t){n=document.createElement("iframe"),n.name=this.iframeId,n.src="javascript:0"}n.id=this.iframeId,this.form.appendChild(n),this.iframe=n};s(),t=t.replace(i,"\\\n"),this.area.value=t.replace(r,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{"complete"===this.iframe.readyState&&a()}:this.iframe.onload=a}}},9332:(t,e,n)=>{const a=n(3051),s=n(5911),r=n(5971),{pick:i,installTimerFunctions:o}=n(9773),l=n(104),c=n(7833)("engine.io-client:polling-xhr");function E(){}const T=null!=new a({xdomain:!1}).responseType;class u extends r{constructor(t,e){super(),o(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=i(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new a(t);try{c("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),this.hasXDR()?(e.onload=()=>{this.onLoad()},e.onerror=()=>{this.onError(e.responseText)}):e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},c("xhr data %s",this.data),e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=u.requestsCount++,u.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(t){this.emit("data",t),this.onSuccess()}onError(t){this.emit("error",t),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=E:this.xhr.onreadystatechange=E,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete u.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&this.onData(t)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}function C(){for(let t in u.requests)u.requests.hasOwnProperty(t)&&u.requests[t].abort()}u.requestsCount=0,u.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",C):"function"==typeof addEventListener&&addEventListener("onpagehide"in l?"pagehide":"unload",C,!1)),t.exports=class extends s{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=T&&!e}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new u(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",(t=>{this.onError("xhr post error",t)}))}doPoll(){c("xhr poll");const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t=>{this.onError("xhr poll error",t)})),this.pollXhr=t}},t.exports.Request=u},5911:(t,e,n)=>{const a=n(2672),s=n(9140),r=n(6809),i=n(2121),o=n(7833)("engine.io-client:polling");t.exports=class extends a{get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{o("paused"),this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(o("we are currently polling - waiting to pause"),t++,this.once("pollComplete",(function(){o("pre-pause polling complete"),--t||e()}))),this.writable||(o("we are currently writing - waiting to pause"),t++,this.once("drain",(function(){o("pre-pause writing complete"),--t||e()})))}else e()}poll(){o("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(t){o("polling got data %s",t),r.decodePayload(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose(),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():o('ignoring poll - transport state "%s"',this.readyState))}doClose(){const t=()=>{o("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(o("transport open - closing"),t()):(o("transport not open - deferring close"),this.once("open",t))}write(t){this.writable=!1,r.encodePayload(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emit("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=i()),this.supportsBinary||t.sid||(t.b64=1),t=s.encode(t),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}}},6024:(t,e,n)=>{const a=n(104),s="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0);t.exports={WebSocket:a.WebSocket||a.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:s}},6855:(t,e,n)=>{const a=n(2672),s=n(6809),r=n(9140),i=n(2121),{pick:o}=n(9773),{WebSocket:l,usingBrowserWebSocket:c,defaultBinaryType:E,nextTick:T}=n(6024),u=n(7833)("engine.io-client:websocket"),C="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class h extends a{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=C?{}:o(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c&&!C?e?new l(t,e):new l(t):new l(t,e,n)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||E,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],a=e===t.length-1;s.encodePacket(n,this.supportsBinary,(t=>{const e={};!c&&(n.options&&(e.compress=n.options.compress),this.opts.perMessageDeflate)&&("string"==typeof t?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(e.compress=!1);try{c?this.ws.send(t):this.ws.send(t,e)}catch(t){u("websocket closed before onclose event")}a&&T((()=>{this.writable=!0,this.emit("drain")}),this.setTimeoutFn)}))}}onClose(){a.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";return this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=i()),this.supportsBinary||(t.b64=1),t=r.encode(t),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}check(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}}t.exports=h},9773:(t,e,n)=>{const a=n(104);t.exports.pick=(t,...e)=>e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{});const s=setTimeout,r=clearTimeout;t.exports.installTimerFunctions=(t,e)=>{e.useNativeTimers?(t.setTimeoutFn=s.bind(a),t.clearTimeoutFn=r.bind(a)):(t.setTimeoutFn=setTimeout.bind(a),t.clearTimeoutFn=clearTimeout.bind(a))}},3051:(t,e,n)=>{const a=n(8383),s=n(104);t.exports=function(t){const e=t.xdomain,n=t.xscheme,r=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||a))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(t){}if(!e)try{return new(s[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},7247:t=>{const e=Object.create(null);e.open="0",e.close="1",e.ping="2",e.pong="3",e.message="4",e.upgrade="5",e.noop="6";const n=Object.create(null);Object.keys(e).forEach((t=>{n[e[t]]=t})),t.exports={PACKET_TYPES:e,PACKET_TYPES_REVERSE:n,ERROR_PACKET:{type:"error",data:"parser error"}}},8893:(t,e,n)=>{const{PACKET_TYPES_REVERSE:a,ERROR_PACKET:s}=n(7247);let r;"function"==typeof ArrayBuffer&&(r=n(3371));const i=(t,e)=>{if(r){const n=r.decode(t);return o(n,e)}return{base64:!0,data:t}},o=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;t.exports=(t,e)=>{if("string"!=typeof t)return{type:"message",data:o(t,e)};const n=t.charAt(0);return"b"===n?{type:"message",data:i(t.substring(1),e)}:a[n]?t.length>1?{type:a[n],data:t.substring(1)}:{type:a[n]}:s}},2233:(t,e,n)=>{const{PACKET_TYPES:a}=n(7247),s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),r="function"==typeof ArrayBuffer,i=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};t.exports=({type:t,data:e},n,o)=>{return s&&e instanceof Blob?n?o(e):i(e,o):r&&(e instanceof ArrayBuffer||(l=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(l):l&&l.buffer instanceof ArrayBuffer))?n?o(e):i(new Blob([e]),o):o(a[t]+(e||""));var l}},6809:(t,e,n)=>{const a=n(2233),s=n(8893),r=String.fromCharCode(30);t.exports={protocol:4,encodePacket:a,encodePayload:(t,e)=>{const n=t.length,s=new Array(n);let i=0;t.forEach(((t,o)=>{a(t,!1,(t=>{s[o]=t,++i===n&&e(s.join(r))}))}))},decodePacket:s,decodePayload:(t,e)=>{const n=t.split(r),a=[];for(let t=0;t<n.length;t++){const r=s(n[t],e);if(a.push(r),"error"===r.type)break}return a}}},7007:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,a=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function r(){r.init.call(this)}t.exports=r,t.exports.once=function(t,e){return new Promise((function(n,a){function s(n){t.removeListener(e,r),a(n)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",s),n([].slice.call(arguments))}_(t,e,r,{once:!0}),"error"!==e&&function(t,e){"function"==typeof t.on&&_(t,"error",e,{once:!0})}(t,s)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var i=10;function o(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function c(t,e,n,a){var s,r,i,c;if(o(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),i=r[e]),void 0===i)i=r[e]=n,++t._eventsCount;else if("function"==typeof i?i=r[e]=a?[n,i]:[i,n]:a?i.unshift(n):i.push(n),(s=l(t))>0&&i.length>s&&!i.warned){i.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");E.name="MaxListenersExceededWarning",E.emitter=t,E.type=e,E.count=i.length,c=E,console&&console.warn&&console.warn(c)}return t}function E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(t,e,n){var a={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=E.bind(a);return s.listener=n,a.wrapFn=s,s}function u(t,e,n){var a=t._events;if(void 0===a)return[];var s=a[e];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(s):h(s,s.length)}function C(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(t,e){for(var n=new Array(e),a=0;a<e;++a)n[a]=t[a];return n}function _(t,e,n,a){if("function"==typeof t.on)a.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function s(r){a.once&&t.removeEventListener(e,s),n(r)}))}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");i=t}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var s="error"===t,r=this._events;if(void 0!==r)s=s&&void 0===r.error;else if(!s)return!1;if(s){var i;if(e.length>0&&(i=e[0]),i instanceof Error)throw i;var o=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw o.context=i,o}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)a(l,this,e);else{var c=l.length,E=h(l,c);for(n=0;n<c;++n)a(E[n],this,e)}return!0},r.prototype.addListener=function(t,e){return c(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return c(this,t,e,!0)},r.prototype.once=function(t,e){return o(e),this.on(t,T(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,T(this,t,e)),this},r.prototype.removeListener=function(t,e){var n,a,s,r,i;if(o(e),void 0===(a=this._events))return this;if(void 0===(n=a[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){i=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,s),1===n.length&&(a[t]=n[0]),void 0!==a.removeListener&&this.emit("removeListener",t,i||e)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){var e,n,a;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var s,r=Object.keys(n);for(a=0;a<r.length;++a)"removeListener"!==(s=r[a])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(a=e.length-1;a>=0;a--)this.removeListener(t,e[a]);return this},r.prototype.listeners=function(t){return u(this,t,!0)},r.prototype.rawListeners=function(t){return u(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):C.call(t,e)},r.prototype.listenerCount=C,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},8383:t=>{try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},6585:t=>{var e=1e3,n=60*e,a=60*n,s=24*a,r=7*s;function i(t,e,n,a){var s=e>=1.5*n;return Math.round(t/n)+" "+a+(s?"s":"")}t.exports=function(t,o){o=o||{};var l,c,E=typeof t;if("string"===E&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*r;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===E&&isFinite(t))return o.long?(l=t,(c=Math.abs(l))>=s?i(l,c,s,"day"):c>=a?i(l,c,a,"hour"):c>=n?i(l,c,n,"minute"):c>=e?i(l,c,e,"second"):l+" ms"):function(t){var r=Math.abs(t);return r>=s?Math.round(t/s)+"d":r>=a?Math.round(t/a)+"h":r>=n?Math.round(t/n)+"m":r>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},9140:(t,e)=>{e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),a=0,s=n.length;a<s;a++){var r=n[a].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}},4258:t=>{var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var a,s,r=t,i=t.indexOf("["),o=t.indexOf("]");-1!=i&&-1!=o&&(t=t.substring(0,i)+t.substring(i,o).replace(/:/g,";")+t.substring(o,t.length));for(var l,c,E=e.exec(t||""),T={},u=14;u--;)T[n[u]]=E[u]||"";return-1!=i&&-1!=o&&(T.source=r,T.host=T.host.substring(1,T.host.length-1).replace(/;/g,":"),T.authority=T.authority.replace("[","").replace("]","").replace(/;/g,":"),T.ipv6uri=!0),T.pathNames=(a=T.path,s=a.replace(/\/{2,9}/g,"/").split("/"),"/"!=a.substr(0,1)&&0!==a.length||s.splice(0,1),"/"==a.substr(a.length-1,1)&&s.splice(s.length-1,1),s),T.queryKey=(l=T.query,c={},l.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(c[e]=n)})),c),T}},4252:function(t){var e;e=()=>(()=>{var t={633:(t,e,n)=>{var a=n(738).default;function s(){"use strict";t.exports=s=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",E=l.asyncIterator||"@@asyncIterator",T=l.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(e){u=function(t,e,n){return t[e]=n}}function C(t,e,n,a){var s=e&&e.prototype instanceof I?e:I,r=Object.create(s.prototype),i=new V(a||[]);return o(r,"_invoke",{value:b(t,n,i)}),r}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=C;var _="suspendedStart",d="suspendedYield",p="executing",A="completed",N={};function I(){}function O(){}function S(){}var R={};u(R,c,(function(){return this}));var f=Object.getPrototypeOf,P=f&&f(f(w([])));P&&P!==r&&i.call(P,c)&&(R=P);var g=S.prototype=I.prototype=Object.create(R);function v(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(s,r,o,l){var c=h(t[s],t,r);if("throw"!==c.type){var E=c.arg,T=E.value;return T&&"object"==a(T)&&i.call(T,"__await")?e.resolve(T.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(T).then((function(t){E.value=t,o(E)}),(function(t){return n("throw",t,o,l)}))}l(c.arg)}var s;o(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,s){n(t,a,e,s)}))}return s=s?s.then(r,r):r()}})}function b(t,n,a){var s=_;return function(r,i){if(s===p)throw Error("Generator is already running");if(s===A){if("throw"===r)throw i;return{value:e,done:!0}}for(a.method=r,a.arg=i;;){var o=a.delegate;if(o){var l=m(o,a);if(l){if(l===N)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===_)throw s=A,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=p;var c=h(t,n,a);if("normal"===c.type){if(s=a.done?A:d,c.arg===N)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(s=A,a.method="throw",a.arg=c.arg)}}}function m(t,n){var a=n.method,s=t.iterator[a];if(s===e)return n.delegate=null,"throw"===a&&t.iterator.return&&(n.method="return",n.arg=e,m(t,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),N;var r=h(s,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,N;var i=r.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,N):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,N)}function y(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function V(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(y,this),this.reset(!0)}function w(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,r=function n(){for(;++s<t.length;)if(i.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(a(t)+" is not iterable")}return O.prototype=S,o(g,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:O,configurable:!0}),O.displayName=u(S,T,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===O||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,u(t,T,"GeneratorFunction")),t.prototype=Object.create(g),t},n.awrap=function(t){return{__await:t}},v(L.prototype),u(L.prototype,E,(function(){return this})),n.AsyncIterator=L,n.async=function(t,e,a,s,r){void 0===r&&(r=Promise);var i=new L(C(t,e,a,s),r);return n.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},v(g),u(g,T,"Generator"),u(g,c,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},n.values=w,V.prototype={constructor:V,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(a,s){return o.type="throw",o.arg=t,n.next=a,s&&(n.method="next",n.arg=e),!!s}for(var s=this.tryEntries.length-1;s>=0;--s){var r=this.tryEntries[s],o=r.completion;if("root"===r.tryLoc)return a("end");if(r.tryLoc<=this.prev){var l=i.call(r,"catchLoc"),c=i.call(r,"finallyLoc");if(l&&c){if(this.prev<r.catchLoc)return a(r.catchLoc,!0);if(this.prev<r.finallyLoc)return a(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return a(r.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return a(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var r=s?s.completion:{};return r.type=t,r.arg=e,s?(this.method="next",this.next=s.finallyLoc,N):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),N},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),N}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var s=a.arg;D(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:w(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),N}},n}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},738:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},756:(t,e,n)=>{var a=n(633)();t.exports=a;try{regeneratorRuntime=a}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}function s(t,n,a){return(n=e(n))in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}function r(t,e,n,a,s,r,i){try{var o=t[r](i),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,s)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(a,s){var i=t.apply(e,n);function o(t){r(i,a,s,o,l,"next",t)}function l(t){r(i,a,s,o,l,"throw",t)}o(void 0)}))}}n.r(a),n.d(a,{ACWInfo:()=>Pt,ActiveCallsResult:()=>M,AgentConfig:()=>W,AgentConfigResult:()=>j,AgentStatusInfo:()=>ht,AgentVendorStatusInfo:()=>_t,AgentWork:()=>Ct,AudioDevicesResult:()=>x,AudioStats:()=>At,AudioStatsElement:()=>Nt,CallInfo:()=>it,CallResult:()=>$,Constants:()=>G,Contact:()=>ot,ContactsFilter:()=>ft,ContactsResult:()=>J,CustomError:()=>U,DialOptions:()=>et,GenericResult:()=>nt,HangupResult:()=>X,HidDevice:()=>Y,HoldToggleResult:()=>z,InitResult:()=>tt,LogoutResult:()=>rt,MuteToggleResult:()=>H,ParticipantResult:()=>q,Phone:()=>k,PhoneCall:()=>ct,PhoneCallAttributes:()=>lt,PhoneContactsResult:()=>Q,RecordingToggleResult:()=>K,SetAgentConfigResult:()=>st,SetAgentStateResult:()=>at,SharedCapabilitiesResult:()=>B,ShowStorageAccessResult:()=>Rt,SignedRecordingUrlResult:()=>Z,StateChangeResult:()=>dt,StatsInfo:()=>It,SuperviseCallResult:()=>Ot,SupervisedCallInfo:()=>pt,SupervisorHangupResult:()=>St,TelephonyConnector:()=>Et,VendorConnector:()=>Tt,VoiceCapabilitiesResult:()=>F,initializeConnector:()=>Kt,log:()=>P,publishError:()=>Jt,publishEvent:()=>Qt,publishLog:()=>qt});var o=n(756),l=n.n(o);const c={SHARED_MESSAGE_TYPE:{SETUP_CONNECTOR:"SETUP_CONNECTOR",CONNECTOR_READY:"CONNECTOR_READY",LOG:"LOG",TELEPHONY_EVENT_DISPATCHED:"TELEPHONY_EVENT_DISPATCHED",SET_AGENT_STATUS:"SET_AGENT_STATUS",GET_AGENT_STATUS:"GET_AGENT_STATUS",LOGOUT:"LOGOUT",MESSAGE:"MESSAGE",DOWNLOAD_VENDOR_LOGS:"DOWNLOAD_VENDOR_LOGS",AGENT_WORK_EVENT:"AGENT_WORK_EVENT",GET_CONTACTS:"GET_CONTACTS"},VOICE_MESSAGE_TYPE:{ACCEPT_CALL:"ACCEPT_CALL",DECLINE_CALL:"DECLINE_CALL",END_CALL:"END_CALL",MUTE:"MUTE",UNMUTE:"UNMUTE",HOLD:"HOLD",RESUME:"RESUME",DIAL:"DIAL",SEND_DIGITS:"SEND_DIGITS",GET_PHONE_CONTACTS:"GET_PHONE_CONTACTS",SWAP_PARTICIPANTS:"SWAP_PARTICIPANTS",ADD_PARTICIPANT:"ADD_PARTICIPANT",CONFERENCE:"CONFERENCE",PAUSE_RECORDING:"PAUSE_RECORDING",RESUME_RECORDING:"RESUME_RECORDING",SUPERVISE_CALL:"SUPERVISE_CALL",SUPERVISOR_BARGE_IN:"SUPERVISOR_BARGE_IN",SUPERVISOR_DISCONNECT:"SUPERVISOR_DISCONNECT",SET_AGENT_CONFIG:"SET_AGENT_CONFIG",GET_SIGNED_RECORDING_URL:"GET_SIGNED_RECORDING_URL",WRAP_UP_CALL:"WRAP_UP_CALL",AGENT_AVAILABLE:"AGENT_AVAILABLE",GET_AUDIO_DEVICES:"GET_AUDIO_DEVICES"},SHARED_EVENT_TYPE:{ERROR:"ERROR",WARNING:"WARNING",INFO:"INFO",LOGIN_STARTED:"LOGIN_STARTED",LOGIN_RESULT:"LOGIN_RESULT",LOGOUT_RESULT:"LOGOUT_RESULT",SHOW_LOGIN:"SHOW_LOGIN",SET_AGENT_STATUS_RESULT:"SET_AGENT_STATUS_RESULT",GET_AGENT_STATUS_RESULT:"GET_AGENT_STATUS_RESULT",MESSAGE:"MESSAGE",SET_AGENT_STATUS:"SET_AGENT_STATUS",GET_AGENT_STATUS:"GET_AGENT_STATUS",STATE_CHANGE:"STATE_CHANGE",REMOTE_CONTROLLER:"REMOTE_CONTROLLER",SHOW_STORAGE_ACCESS:"SHOW_STORAGE_ACCESS",STORAGE_ACCESS_RESULT:"STORAGE_ACCESS_RESULT",GET_CONTACTS_RESULT:"GET_CONTACTS_RESULT",AFTER_CONVERSATION_WORK_STARTED:"AFTER_CONVERSATION_WORK_STARTED",AFTER_CONVERSATION_WORK_ENDED:"AFTER_CONVERSATION_WORK_ENDED"},VOICE_EVENT_TYPE:{QUEUED_CALL_STARTED:"QUEUED_CALL_STARTED",CALL_STARTED:"CALL_STARTED",CALL_CONNECTED:"CALL_CONNECTED",CALL_FAILED:"CALL_FAILED",MUTE_TOGGLE:"MUTE_TOGGLE",HOLD_TOGGLE:"HOLD_TOGGLE",PHONE_CONTACTS:"PHONE_CONTACTS",PARTICIPANT_ADDED:"PARTICIPANT_ADDED",PARTICIPANT_CONNECTED:"PARTICIPANT_CONNECTED",PARTICIPANT_REMOVED:"PARTICIPANT_REMOVED",RECORDING_TOGGLE:"RECORDING_TOGGLE",PARTICIPANTS_SWAPPED:"PARTICIPANTS_SWAPPED",PARTICIPANTS_CONFERENCED:"PARTICIPANTS_CONFERENCED",SIGNED_RECORDING_URL:"SIGNED_RECORDING_URL",UPDATE_AUDIO_STATS:"UPDATE_AUDIO_STATS",UPDATE_AUDIO_STATS_COMPLETED:"UPDATE_AUDIO_STATS_COMPLETED",SUPERVISOR_BARGED_IN:"SUPERVISOR_BARGED_IN",SUPERVISOR_CALL_STARTED:"SUPERVISOR_CALL_STARTED",SUPERVISOR_CALL_CONNECTED:"SUPERVISOR_CALL_CONNECTED",SUPERVISOR_HANGUP:"SUPERVISOR_HANGUP",CALL_BARGED_IN:"CALL_BARGED_IN",WRAP_UP_ENDED:"WRAP_UP_ENDED",AFTER_CALL_WORK_STARTED:"AFTER_CALL_WORK_STARTED",AGENT_CONFIG_UPDATED:"AGENT_CONFIG_UPDATED",AGENT_ERROR:"AGENT_ERROR",HANGUP:"HANGUP",SOFTPHONE_ERROR:"SOFTPHONE_ERROR",SHOW_TRANSFER_VIEW:"SHOW_TRANSFER_VIEW",GET_AUDIO_DEVICES:"GET_AUDIO_DEVICES",AUDIO_STATS:"AUDIO_STATS",CALL_UPDATED:"CALL_UPDATED"},INFO_TYPE:{CAN_NOT_ACCEPT_THE_CALL:"CAN_NOT_ACCEPT_THE_CALL"},SHARED_ERROR_TYPE:{CUSTOM_ERROR:"CUSTOM_ERROR",GENERIC_ERROR:"GENERIC_ERROR",AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",INVALID_AGENT_STATUS:"INVALID_AGENT_STATUS",CAN_NOT_GET_AGENT_STATUS:"CAN_NOT_GET_AGENT_STATUS",CAN_NOT_SET_AGENT_STATUS:"CAN_NOT_SET_AGENT_STATUS",LOGIN_REQUIRED:"LOGIN_REQUIRED",CAN_NOT_LOG_IN:"CAN_NOT_LOG_IN",CAN_NOT_LOG_OUT:"CAN_NOT_LOG_OUT",INVALID_STATE_CHANGE_RESULT:"INVALID_STATE_CHANGE_RESULT",INVALID_STORAGE_ACCESS_RESULT:"INVALID_STORAGE_ACCESS_RESULT",INVALID_ACW_INFO:"INVALID_ACW_INFO"},VOICE_ERROR_TYPE:{CAN_NOT_DECLINE_THE_CALL:"CAN_NOT_DECLINE_THE_CALL",CAN_NOT_END_THE_CALL:"CAN_NOT_END_THE_CALL",CAN_NOT_HOLD_CALL:"CAN_NOT_HOLD_CALL",CAN_NOT_RESUME_CALL:"CAN_NOT_RESUME_CALL",CAN_NOT_MUTE_CALL:"CAN_NOT_MUTE_CALL",CAN_NOT_UNMUTE_CALL:"CAN_NOT_UNMUTE_CALL",CAN_NOT_TOGGLE_MUTE:"CAN_NOT_TOGGLE_MUTE",CAN_NOT_TOGGLE_HOLD:"CAN_NOT_TOGGLE_HOLD",CAN_NOT_TOGGLE_RECORD:"CAN_NOT_TOGGLE_RECORD",INVALID_PARTICIPANT:"INVALID_PARTICIPANT",INVALID_PARAMS:"INVALID_PARAMS",CAN_NOT_GET_PHONE_CONTACTS:"CAN_NOT_GET_PHONE_CONTACTS",CAN_NOT_SWAP_PARTICIPANTS:"CAN_NOT_SWAP_PARTICIPANTS",CAN_NOT_CONFERENCE:"CAN_NOT_CONFERENCE",INVALID_DESTINATION:"INVALID_DESTINATION",INVALID_PHONE_NUMBER:"INVALID_PHONE_NUMBER",CAN_NOT_HANGUP_PARTICIPANT:"CAN_NOT_HANGUP_PARTICIPANT",CAN_NOT_ADD_PARTICIPANT:"CAN_NOT_ADD_PARTICIPANT",CAN_NOT_CONNECT_PARTICIPANT:"CAN_NOT_CONNECT_PARTICIPANT",CAN_NOT_START_THE_CALL:"CAN_NOT_START_THE_CALL",CAN_NOT_PAUSE_RECORDING:"CAN_NOT_PAUSE_RECORDING",CAN_NOT_RESUME_RECORDING:"CAN_NOT_RESUME_RECORDING",CAN_NOT_SET_AGENT_CONFIG:"CAN_NOT_SET_AGENT_CONFIG",CAN_NOT_SET_CAPABILITIES:"CAN_NOT_SET_CAPABILITIES",CAN_NOT_UPDATE_PHONE_NUMBER:"CAN_NOT_UPDATE_PHONE_NUMBER",CAN_NOT_GET_SIGNED_RECORDING_URL:"CAN_NOT_GET_SIGNED_RECORDING_URL",CAN_NOT_SUPERVISE_CALL:"CAN_NOT_SUPERVISE_CALL",CAN_NOT_DISCONNECT_SUPERVISOR:"CAN_NOT_DISCONNECT_SUPERVISOR",CAN_NOT_BARGE_IN_SUPERVISOR:"CAN_NOT_BARGE_IN_SUPERVISOR",CAN_NOT_BARGE_IN_CALL:"CAN_NOT_BARGE_IN_CALL",AGENT_ERROR:"AGENT_ERROR",MICROPHONE_NOT_SHARED:"MICROPHONE_NOT_SHARED",UNSUPPORTED_BROWSER:"UNSUPPORTED_BROWSER",USER_BUSY_ERROR:"USER_BUSY_ERROR",WEBRTC_ERROR:"WEBRTC_ERROR",CAN_NOT_GET_AUDIO_DEVICES:"CAN_NOT_GET_AUDIO_DEVICES",CAN_NOT_UPDATE_CALL:"CAN_NOT_UPDATE_CALL"},AGENT_STATUS:{ONLINE:"Online",OFFLINE:"Offline",ACW:"AfterCallWork"},PARTICIPANT_TYPE:{AGENT:"Agent",INITIAL_CALLER:"Initial_Caller",THIRD_PARTY:"Third_Party",SUPERVISOR:"Supervisor"},CALL_TYPE:{INBOUND:"Inbound",OUTBOUND:"Outbound",CALLBACK:"Callback",ADD_PARTICIPANT:"AddParticipant",TRANSFER:"Transfer",INTERNAL_CALL:"InternalCall",DIALED_CALLBACK:"DialedCallback",CONSULT:"Consult"},CALL_SUBTYPE:{PSTN:"PSTN",WEB_RTC:"WebRTC"},DIALER_TYPE:{OUTBOUND_PREVIEW:"OutboundPreview",NONE:"None"},CONTACT_TYPE:{PHONEBOOK:"PhoneBook",QUEUE:"Queue",PHONENUMBER:"PhoneNumber",AGENT:"Agent",FLOW:"Flow"},CONTACT_LIST_TYPE:{TRANSFER:"Transfer",CONFERENCE:"Conference",ALL:"All"},AGENT_CONFIG_TYPE:{SHOW_AGENT_SETTINGS:"SHOW_AGENT_SETTINGS",PHONES:"PHONES",SELECTED_PHONE:"SELECTED_PHONE"},SHARED_CAPABILITIES_TYPE:{DEBUG_ENABLED:"DEBUG_ENABLED",CONTACT_SEARCH:"CONTACT_SEARCH",VENDOR_PROVIDED_AVAILABILITY:"VENDOR_PROVIDED_AVAILABILITY",VENDOR_PROVIDED_QUEUE_WAIT_TIME:"VENDOR_PROVIDED_QUEUE_WAIT_TIME",TRANSFER_TO_OMNI_FLOW:"TRANSFER_TO_OMNI_FLOW",PENDING_STATUS_CHANGE:"PENDING_STATUS_CHANGE",SFDC_PENDING_STATE:"SFDC_PENDING_STATE",AUTO_ACCEPT_ENABLED:"AUTO_ACCEPT_ENABLED"},VOICE_CAPABILITIES_TYPE:{MUTE:"MUTE",RECORD:"RECORD",MERGE:"MERGE",SWAP:"SWAP",BLIND_TRANSFER:"BLIND_TRANSFER",SIGNED_RECORDING_URL:"SIGNED_RECORDING_URL",SUPERVISOR_LISTEN_IN:"SUPERVISOR_LISTEN_IN",SUPERVISOR_BARGE_IN:"SUPERVISOR_BARGE_IN",MOS:"MOS",PHONEBOOK:"PHONEBOOK",HAS_GET_EXTERNAL_SPEAKER:"HAS_GET_EXTERNAL_SPEAKER",HAS_SET_EXTERNAL_SPEAKER:"HAS_SET_EXTERNAL_SPEAKER",HAS_GET_EXTERNAL_MICROPHONE:"HAS_GET_EXTERNAL_MICROPHONE",HAS_SET_EXTERNAL_MICROPHONE:"HAS_SET_EXTERNAL_MICROPHONE",CAN_CONSULT:"CAN_CONSULT",DIAL_PAD:"DIAL_PAD",HAS_HID_SUPPORT:"HAS_HID_SUPPORT",PHONEBOOK_DISABLE:"PHONEBOOK_DISABLE"},CALL_STATE:{RINGING:"ringing",CONNECTED:"connected",TRANSFERRING:"transferring",TRANSFERRED:"transferred",ENDED:"ended"},PHONE_TYPE:{DESK_PHONE:"DESK_PHONE",SOFT_PHONE:"SOFT_PHONE"},HANGUP_REASON:{PHONE_CALL_ERROR:"error",PHONE_CALL_ENDED:"ended"},AGENT_AVAILABILITY:{AVAILABLE:"AVAILABLE",BUSY:"BUSY",OFFLINE:"OFFLINE"},REMOVE_PARTICIPANT_VARIANT:{ALWAYS:"ALWAYS",NEVER:"NEVER",ALWAYS_EXCEPT_ON_HOLD:"ALWAYS_EXCEPT_ON_HOLD"},LOG_LEVEL:{ERROR:"ERROR",INFO:"INFO"},LOG_SOURCE:{SYSTEM:"SYSTEM",PARTNER:"PARTNER"},CONTACTS_FILTER_TYPES:{AGENT:"AGENT",QUEUE:"QUEUE",CONTACT:"CONTACT",DIRECTORY:"DIRECTORY",FLOW:"FLOW",AVAILABLE:"AVAILABLE"},WORK_EVENT:{ASSIGNED:"ASSIGNED",ACCEPTED:"ACCEPTED",DECLINED:"DECLINED",COMPLETED:"COMPLETED",CLOSED:"CLOSED",PAUSED:"PAUSED",UNPAUSED:"UNPAUSED"},DIAL_OPTIONS:{CALLBACK:"isCallback=true",CONSULT:"isConsultCall"},HANGUP_STATUS:{MISSED_AGENT:"MissedCallAgent",DECLINED:"DeclinedByAgent",FAILED_CONNECT_AGENT:"FailedConnectAgent",FAILED_CONNECT_CUSTOMER:"FailedConnectCustomer",CALLBACK_MISSED_OR_REJECTED:"CallbackMissedOrRejected"}};var E=["/internalNameLabel","/reqGeneralInfo/reqAdapterUrl","/reqGeneralInfo/reqVendorInfoApiName","isACWAllowed","isHVSEnabled","orgDomainName","phoneServiceChannelId","telephonySettingsComponentFqn"],T=["/reqHvcc"],u=["/reqHvcc/reqTelephonyIntegrationCertificate"];function C(t,n){for(var a=0;a<n.length;a++){var s=n[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,e(s.key),s)}}function h(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function A(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(N=function(){return!!t})()}function I(t){var e="function"==typeof Map?new Map:void 0;return I=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(N())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,e);var s=new(t.bind.apply(t,a));return n&&p(s,n.prototype),s}(t,arguments,d(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,t)},I(t)}var O=75e5,S=function(t){return"string"==typeof t?t:JSON.stringify(t)},R=0,f=[];function P(t,e,n){!function(t,e,n){if(!e)throw new Error("Log Message required");t=t||c.LOG_LEVEL.INFO,n=n||c.LOG_SOURCE.PARTNER;var a=[(new Date).toISOString(),S(t),S(n),"".concat(S(e),"\n")].join("|");R+a.length>=O&&(f=[],R=0),R+=a.length,f.push(a)}(e,t,n)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function v(e,n,a){return n=d(n),function(e,n){if(n&&("object"==t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(e,L()?Reflect.construct(n,a||[],d(e).constructor):n.apply(e,a))}function L(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(L=function(){return!!t})()}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y,D,V,w,G={SHARED_EVENT_TYPE:{LOGIN_RESULT:c.SHARED_EVENT_TYPE.LOGIN_RESULT,LOGOUT_RESULT:c.SHARED_EVENT_TYPE.LOGOUT_RESULT,MESSAGE:c.SHARED_EVENT_TYPE.MESSAGE,SET_AGENT_STATUS:c.SHARED_EVENT_TYPE.SET_AGENT_STATUS,GET_AGENT_STATUS:c.SHARED_EVENT_TYPE.GET_AGENT_STATUS,STATE_CHANGE:c.SHARED_EVENT_TYPE.STATE_CHANGE,STORAGE_ACCESS_RESULT:c.SHARED_EVENT_TYPE.STORAGE_ACCESS_RESULT,GET_CONTACTS_RESULT:c.SHARED_EVENT_TYPE.GET_CONTACTS_RESULT,AFTER_CONVERSATION_WORK_STARTED:c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_STARTED,AFTER_CONVERSATION_WORK_ENDED:c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_ENDED},VOICE_EVENT_TYPE:{CALL_STARTED:c.VOICE_EVENT_TYPE.CALL_STARTED,QUEUED_CALL_STARTED:c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED,CALL_CONNECTED:c.VOICE_EVENT_TYPE.CALL_CONNECTED,HANGUP:c.VOICE_EVENT_TYPE.HANGUP,MUTE_TOGGLE:c.VOICE_EVENT_TYPE.MUTE_TOGGLE,HOLD_TOGGLE:c.VOICE_EVENT_TYPE.HOLD_TOGGLE,RECORDING_TOGGLE:c.VOICE_EVENT_TYPE.RECORDING_TOGGLE,PARTICIPANTS_SWAPPED:c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED,PARTICIPANTS_CONFERENCED:c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED,PARTICIPANT_ADDED:c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED,PARTICIPANT_CONNECTED:c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,PARTICIPANT_REMOVED:c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,AFTER_CALL_WORK_STARTED:c.VOICE_EVENT_TYPE.AFTER_CALL_WORK_STARTED,WRAP_UP_ENDED:c.VOICE_EVENT_TYPE.WRAP_UP_ENDED,AGENT_ERROR:c.VOICE_EVENT_TYPE.AGENT_ERROR,SOFTPHONE_ERROR:c.VOICE_EVENT_TYPE.SOFTPHONE_ERROR,UPDATE_AUDIO_STATS:c.VOICE_EVENT_TYPE.UPDATE_AUDIO_STATS,CALL_BARGED_IN:c.VOICE_EVENT_TYPE.CALL_BARGED_IN,SUPERVISOR_BARGED_IN:c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN,SUPERVISOR_CALL_STARTED:c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED,SUPERVISOR_CALL_CONNECTED:c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED,SUPERVISOR_HANGUP:c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,SHOW_TRANSFER_VIEW:c.VOICE_EVENT_TYPE.SHOW_TRANSFER_VIEW,AUDIO_STATS:c.VOICE_EVENT_TYPE.AUDIO_STATS,CALL_UPDATED:c.VOICE_EVENT_TYPE.CALL_UPDATED},SHARED_ERROR_TYPE:{GENERIC_ERROR:c.SHARED_ERROR_TYPE.GENERIC_ERROR,INVALID_AGENT_STATUS:c.SHARED_ERROR_TYPE.INVALID_AGENT_STATUS},VOICE_ERROR_TYPE:{INVALID_PARTICIPANT:c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT,INVALID_DESTINATION:c.VOICE_ERROR_TYPE.INVALID_DESTINATION,CAN_NOT_UPDATE_PHONE_NUMBER:c.VOICE_ERROR_TYPE.CAN_NOT_UPDATE_PHONE_NUMBER,INVALID_PARAMS:c.VOICE_ERROR_TYPE.INVALID_PARAMS},AGENT_STATUS:m({},c.AGENT_STATUS),PARTICIPANT_TYPE:m({},c.PARTICIPANT_TYPE),CALL_TYPE:m({},c.CALL_TYPE),CALL_SUBTYPE:m({},c.CALL_SUBTYPE),DIALER_TYPE:m({},c.DIALER_TYPE),CONTACT_TYPE:m({},c.CONTACT_TYPE),CONTACT_LIST_TYPE:m({},c.CONTACT_LIST_TYPE),CALL_STATE:m({},c.CALL_STATE),HANGUP_REASON:m({},c.HANGUP_REASON),PHONE_TYPE:m({},c.PHONE_TYPE),AGENT_AVAILABILITY:m({},c.AGENT_AVAILABILITY),REMOVE_PARTICIPANT_VARIANT:m({},c.REMOVE_PARTICIPANT_VARIANT),LOG_LEVEL:m({},c.LOG_LEVEL),CONTACTS_FILTER_TYPES:m({},c.CONTACTS_FILTER_TYPES),WORK_EVENT:m({},c.WORK_EVENT),HANGUP_STATUS:m({},c.HANGUP_STATUS)},U=function(t){function e(t){var n,a=t.labelName,s=t.namespace,r=t.message;return _(this,e),n=v(this,e,[r]),ut.validateString(a),ut.validateString(s),r&&ut.validateString(r),n.labelName=a,n.namespace=s,n.message=r,n}return A(e,t),h(e)}(I(Error)),k=h((function t(e){var n=e.type,a=e.number;_(this,t),ut.validateEnum(n,Object.values(c.PHONE_TYPE)),a&&ut.validateString(a),this.type=n,this.number=a})),Y=h((function t(e){var n=e.productId,a=e.vendorId;_(this,t),n&&ut.validateNumber(n),a&&ut.validateNumber(a),this.productId=n,this.vendorId=a})),H=h((function t(e){var n=e.isMuted,a=e.call,s=e.isGlobal;_(this,t),this.isMuted=n,this.call=a,this.isGlobal=s})),M=h((function t(e){var n=e.activeCalls,a=void 0===n?[]:n;_(this,t),a.length>0&&a.forEach((function(t){ut.validateClassObject(t,ct)})),this.activeCalls=a})),x=h((function t(e){var n=e.audioDevices,a=void 0===n?[]:n;_(this,t),this.audioDevices=a})),B=h((function t(e){var n=e.debugEnabled,a=void 0===n||n,s=e.hasContactSearch,r=void 0!==s&&s,i=e.hasAgentAvailability,o=void 0!==i&&i,l=e.hasQueueWaitTime,c=void 0!==l&&l,E=e.hasTransferToOmniFlow,T=void 0!==E&&E,u=e.hasPendingStatusChange,C=void 0!==u&&u,h=e.hasSFDCPendingState,d=void 0!==h&&h,p=e.hasAutoAcceptEnabled,A=void 0!==p&&p;_(this,t),ut.validateBoolean(a),ut.validateBoolean(r),ut.validateBoolean(o),ut.validateBoolean(c),ut.validateBoolean(T),ut.validateBoolean(C),ut.validateBoolean(d),ut.validateBoolean(A),this.debugEnabled=a,this.hasContactSearch=r,this.hasAgentAvailability=o,this.hasQueueWaitTime=c,this.hasTransferToOmniFlow=T,this.hasPendingStatusChange=C,this.hasSFDCPendingState=d,this.hasAutoAcceptEnabled=A})),F=h((function t(e){var n=e.hasMute,a=void 0===n||n,s=e.hasRecord,r=void 0===s||s,i=e.hasMerge,o=void 0===i||i,l=e.hasSwap,c=void 0===l||l,E=e.hasBlindTransfer,T=void 0!==E&&E,u=e.hasSignedRecordingUrl,C=void 0!==u&&u,h=e.supportsMos,d=void 0!==h&&h,p=e.hasSupervisorListenIn,A=void 0!==p&&p,N=e.hasSupervisorBargeIn,I=void 0!==N&&N,O=e.hasPhoneBook,S=void 0!==O&&O,R=e.hasGetExternalSpeakerDeviceSetting,f=void 0!==R&&R,P=e.hasSetExternalSpeakerDeviceSetting,g=void 0!==P&&P,v=e.hasGetExternalMicrophoneDeviceSetting,L=void 0!==v&&v,b=e.hasSetExternalMicrophoneDeviceSetting,m=void 0!==b&&b,y=e.canConsult,D=void 0!==y&&y,V=e.isDialPadDisabled,w=void 0!==V&&V,G=e.isHidSupported,U=void 0!==G&&G,k=e.isPhoneBookDisabled,Y=void 0!==k&&k;_(this,t),ut.validateBoolean(a),ut.validateBoolean(r),ut.validateBoolean(o),ut.validateBoolean(c),ut.validateBoolean(T),ut.validateBoolean(C),ut.validateBoolean(d),ut.validateBoolean(A),ut.validateBoolean(I),ut.validateBoolean(S),ut.validateBoolean(f),ut.validateBoolean(g),ut.validateBoolean(L),ut.validateBoolean(m),ut.validateBoolean(D),ut.validateBoolean(w),ut.validateBoolean(U),ut.validateBoolean(Y),this.hasMute=a,this.hasRecord=r,this.hasMerge=o,this.hasSwap=c,this.hasBlindTransfer=T,this.hasSignedRecordingUrl=C,this.supportsMos=d,this.hasSupervisorListenIn=A,this.hasSupervisorBargeIn=I,this.hasPhoneBook=S,this.hasGetExternalSpeakerDeviceSetting=f,this.hasSetExternalSpeakerDeviceSetting=g,this.hasGetExternalMicrophoneDeviceSetting=L,this.hasSetExternalMicrophoneDeviceSetting=m,this.canConsult=D,this.isDialPadDisabled=w,this.isHidSupported=U,this.isPhoneBookDisabled=Y})),j=h((function t(e){var n=e.phones,a=void 0===n?[c.PHONE_TYPE.SOFT_PHONE]:n,s=e.selectedPhone,r=void 0===s?new k({type:c.PHONE_TYPE.SOFT_PHONE}):s,i=e.speakerDeviceId,o=void 0===i?"":i,l=e.microphoneDeviceId,E=void 0===l?"":l;_(this,t),ut.validateClassObject(a,Array),ut.validateClassObject(r,k),ut.validateString(o),ut.validateString(E),this.phones=a,this.selectedPhone=r,this.speakerDeviceId=o,this.microphoneDeviceId=E})),W=h((function t(e){var n=e.selectedPhone,a=e.speakerDeviceId,s=e.microphoneDeviceId,r=e.hidDeviceInfo;_(this,t),ut.validateClassObject(n,k),void 0!==r&&ut.validateClassObject(r,Y),this.selectedPhone=n,this.speakerDeviceId=a,this.microphoneDeviceId=s,this.hidDeviceInfo=r})),K=h((function t(e){var n=e.isRecordingPaused,a=e.contactId,s=void 0===a?null:a,r=e.initialContactId,i=void 0===r?null:r,o=e.instanceId,l=void 0===o?null:o,c=e.region,E=void 0===c?null:c;_(this,t),this.isRecordingPaused=n,this.contactId=s,this.initialContactId=i,this.instanceId=l,this.region=E})),q=h((function t(e){var n=e.initialCallHasEnded,a=e.callInfo,s=e.callAttributes,r=e.phoneNumber,i=e.callId,o=e.contact,l=void 0===o?null:o,c=e.connectionId;_(this,t),ut.validateClassObject(a,it),this.initialCallHasEnded=n,this.callInfo=a,this.callAttributes=s,this.phoneNumber=r,this.callId=i,this.contact=l,this.connectionId=c||i})),J=h((function t(e){var n=e.contacts,a=void 0===n?[]:n,s=e.contactTypes,r=void 0===s?[]:s;_(this,t),a.length>0&&a.forEach((function(t){ut.validateClassObject(t,ot)})),r.length>0&&r.forEach((function(t){ut.validateEnum(t,Object.values(c.CONTACT_TYPE))})),this.contacts=a,this.contactTypes=r})),Q=function(t){function e(t){var n=t.contacts,a=void 0===n?[]:n,s=t.contactTypes,r=void 0===s?[]:s;return _(this,e),v(this,e,[{contacts:a,contactTypes:r}])}return A(e,t),h(e)}(J),$=h((function t(e){var n=e.call;_(this,t),void 0!==n&&ut.validateClassObject(n,ct),this.call=n})),X=h((function t(e){var n=e.calls;_(this,t),n instanceof Array?(n.forEach((function(t){return ut.validateClassObject(t,ct)})),this.calls=n):(ut.validateClassObject(n,ct),this.calls=[n])})),z=h((function t(e){var n=e.isThirdPartyOnHold,a=e.isCustomerOnHold,s=e.calls,r=e.isCallMerged;_(this,t),s&&(Object.values(s).forEach((function(t){ut.validateClassObject(t,ct)})),this.calls=s),this.isThirdPartyOnHold=n,this.isCustomerOnHold=a,this.isCallMerged=r})),Z=h((function t(e){var n=e.success,a=e.url,s=e.duration,r=e.callId;_(this,t),n&&(ut.validateString(a),ut.validateString(r),s&&ut.validateNumber(s)),this.success=n,this.url=a,this.duration=s,this.callId=r})),tt=h((function t(e){var n=e.showLogin,a=void 0!==n&&n,s=e.loginFrameHeight,r=void 0===s?350:s,i=e.isSilentLogin,o=void 0!==i&&i,l=e.showStorageAccess,c=void 0!==l&&l;_(this,t),this.showLogin=a,this.loginFrameHeight=r,this.isSilentLogin=!this.showLogin&&o,this.showStorageAccess=c})),et=h((function t(e){var n=e.isCallback,a=void 0!==n&&n,s=e.isConsultCall,r=void 0!==s&&s;_(this,t),this.isCallback=a,this.isConsultCall=r})),nt=h((function t(e){var n=e.success;_(this,t),this.success=n})),at=function(t){function e(t){var n,a=t.success,s=t.isStatusSyncNeeded,r=void 0===s||s;return _(this,e),(n=v(this,e,[{success:a}])).isStatusSyncNeeded=r,n}return A(e,t),h(e)}(nt),st=function(t){function e(t){var n,a=t.success,s=t.isSystemEvent,r=void 0!==s&&s;return _(this,e),(n=v(this,e,[{success:a}])).isSystemEvent=r,n}return A(e,t),h(e,[{key:"setIsSystemEvent",value:function(t){this.isSystemEvent=t}}])}(nt),rt=h((function t(e){var n=e.success,a=e.loginFrameHeight,s=void 0===a?350:a;_(this,t),this.success=n,this.loginFrameHeight=s})),it=h((function t(e){var n=e.callStateTimestamp,a=void 0===n?null:n,s=e.isOnHold,r=e.isMuted,i=void 0!==r&&r,o=e.isRecordingPaused,l=void 0!==o&&o,E=e.initialCallId,T=e.queueId,u=void 0===T?null:T,C=e.queueName,h=void 0===C?null:C,d=e.queueTimestamp,p=void 0===d?null:d,A=e.isSoftphoneCall,N=void 0===A||A,I=e.acceptEnabled,O=void 0===I||I,S=e.declineEnabled,R=void 0===S||S,f=e.muteEnabled,P=void 0===f||f,g=e.swapEnabled,v=void 0===g||g,L=e.conferenceEnabled,b=void 0===L||L,m=e.holdEnabled,y=void 0===m||m,D=e.recordEnabled,V=void 0===D||D,w=e.addCallerEnabled,U=void 0===w||w,k=e.extensionEnabled,Y=void 0===k||k,H=e.isReplayable,M=void 0===H||H,x=e.isBargeable,B=void 0!==x&&x,F=e.isExternalTransfer,j=e.showMuteButton,W=void 0===j||j,K=e.showRecordButton,q=void 0===K||K,J=e.showAddCallerButton,Q=void 0===J||J,$=e.showAddBlindTransferButton,X=void 0===$||$,z=e.showMergeButton,Z=void 0===z||z,tt=e.showSwapButton,et=void 0===tt||tt,nt=e.removeParticipantVariant,at=void 0===nt?G.REMOVE_PARTICIPANT_VARIANT.ALWAYS:nt,st=e.additionalFields,rt=void 0===st?null:st,it=e.isMultiParty,ot=void 0!==it&&it,lt=e.isHIDCall,ct=void 0!==lt&&lt,Et=e.endCallDisabled,Tt=void 0!==Et&&Et,Ct=e.renderContactId,ht=void 0===Ct?null:Ct;_(this,t),a&&ut.validateDate(a),p&&ut.validateDate(p),u&&ut.validateString(u),h&&ut.validateString(h),ut.validateBoolean(l),ut.validateBoolean(i),ut.validateBoolean(N),ut.validateBoolean(O),ut.validateBoolean(R),ut.validateBoolean(P),ut.validateBoolean(v),ut.validateBoolean(b),ut.validateBoolean(y),ut.validateBoolean(V),ut.validateBoolean(U),ut.validateBoolean(Y),ut.validateBoolean(B),ut.validateBoolean(W),ut.validateBoolean(q),ut.validateBoolean(Q),ut.validateBoolean(X),ut.validateBoolean(Z),ut.validateBoolean(et),ut.validateBoolean(ct),ut.validateBoolean(Tt),void 0!==F&&ut.validateBoolean(F),ut.validateEnum(at,Object.values(c.REMOVE_PARTICIPANT_VARIANT)),rt&&ut.validateString(rt),ut.validateBoolean(ot),ht&&ut.validateString(ht),this.callStateTimestamp=a,this.isRecordingPaused=l,this.isMuted=i,this.isOnHold=s,this.initialCallId=E,this.queueName=h,this.queueId=u,this.queueTimestamp=p,this.isSoftphoneCall=N,this.acceptEnabled=O,this.declineEnabled=R,this.muteEnabled=P,this.swapEnabled=v,this.conferenceEnabled=b,this.holdEnabled=y,this.recordEnabled=V,this.addCallerEnabled=U,this.extensionEnabled=Y,this.isReplayable=M,this.isBargeable=B,this.isExternalTransfer=F,this.removeParticipantVariant=at,this.showMuteButton=W,this.showRecordButton=q,this.showAddCallerButton=Q,this.showAddBlindTransferButton=X,this.showMergeButton=Z,this.showSwapButton=et,this.additionalFields=rt,this.isMultiParty=ot,this.isHIDCall=ct,this.endCallDisabled=Tt,this.renderContactId=ht})),ot=h((function t(e){var n=e.phoneNumber,a=e.id,s=e.type,r=e.name,i=e.listType,o=e.prefix,l=e.extension,E=e.endpointARN,T=e.queue,u=e.availability,C=e.recordId,h=e.description,d=e.queueWaitTime;_(this,t),n&&ut.validateString(n),s&&ut.validateEnum(s,Object.values(c.CONTACT_TYPE)),a&&ut.validateString(a),r&&ut.validateString(r),i&&ut.validateEnum(i,Object.values(G.CONTACT_LIST_TYPE)),o&&ut.validateString(o),l&&ut.validateString(l),u&&ut.validateEnum(u,Object.values(c.AGENT_AVAILABILITY)),C&&ut.validateString(C),h&&ut.validateString(h),d&&ut.validateString(d),this.phoneNumber=n,this.id=a,this.type=s,this.name=r,this.listType=i,this.prefix=o,this.extension=l,this.endpointARN=E,this.queue=T,c.CONTACT_TYPE.AGENT===this.type?this.availability=u:this.availability=null,this.queueWaitTime=d,this.recordId=C,this.description=h})),lt=h((function t(e){var n=e.voiceCallId,a=e.participantType,s=e.dialerType,r=void 0===s?G.DIALER_TYPE.NONE:s,i=e.parentId,o=e.isOnHold,l=e.hasSupervisorBargedIn,E=void 0!==l&&l,T=e.isAutoMergeOn,u=void 0!==T&&T,C=e.isConsultCall,h=void 0!==C&&C;_(this,t),n&&ut.validateString(n),a&&ut.validateEnum(a,Object.values(c.PARTICIPANT_TYPE)),i&&ut.validateString(i),void 0!==o&&ut.validateBoolean(o),ut.validateBoolean(E),ut.validateEnum(r,Object.values(c.DIALER_TYPE)),ut.validateBoolean(u),ut.validateBoolean(h),this.voiceCallId=n,this.participantType=a,this.parentId=i,this.isOnHold=o,this.dialerType=r,this.hasSupervisorBargedIn=E,this.isAutoMergeOn=u,this.isConsultCall=h})),ct=h((function t(e){var n=e.callId,a=e.callType,s=e.callSubtype,r=e.contact,i=e.state,o=e.callAttributes,l=e.phoneNumber,E=e.callInfo,T=e.reason,u=e.closeCallOnError,C=e.agentStatus,h=e.agentARN,d=e.fromContact,p=e.toContact,A=e.connectionId;_(this,t),n&&(ut.validateString(n),this.callId=n),A?(ut.validateString(A),this.connectionId=A):n&&(this.connectionId=n),a&&(ut.validateEnum(a,Object.values(c.CALL_TYPE)),this.callType=a),s&&(ut.validateEnum(s,Object.values(c.CALL_SUBTYPE)),this.callSubtype=s),l&&(ut.validateString(l),this.phoneNumber=l),E&&(ut.validateClassObject(E,it),this.callInfo=E),r&&(ut.validateClassObject(r,ot),this.contact=r),d&&(ut.validateClassObject(d,ot),this.fromContact=d),p?(ut.validateClassObject(p,ot),this.toContact=p):r&&(this.toContact=r),T&&(this.reason=T),u&&(this.closeCallOnError=u),C&&(this.agentStatus=C),h&&(this.agentARN=h),this.state=i,this.callAttributes=o})),Et=h((function t(){_(this,t)}),[{key:"getActiveCalls",value:function(){throw new Error("Not implemented")}},{key:"acceptCall",value:function(t){throw new Error("Not implemented")}},{key:"declineCall",value:function(t){throw new Error("Not implemented")}},{key:"endCall",value:function(t,e){throw new Error("Not implemented")}},{key:"mute",value:function(t){throw new Error("Not implemented")}},{key:"unmute",value:function(t){throw new Error("Not implemented")}},{key:"hold",value:function(t){throw new Error("Not implemented")}},{key:"resume",value:function(t){throw new Error("Not implemented")}},{key:"dial",value:function(t,e){throw new Error("Not implemented")}},{key:"sendDigits",value:function(t){throw new Error("Not implemented")}},{key:"getPhoneContacts",value:function(t){throw new Error("Not implemented")}},{key:"swap",value:function(t,e){throw new Error("Not implemented")}},{key:"conference",value:function(t){throw new Error("Not implemented")}},{key:"addParticipant",value:function(t,e,n){throw new Error("Not implemented")}},{key:"pauseRecording",value:function(){throw new Error("Not implemented")}},{key:"resumeRecording",value:function(){throw new Error("Not implemented")}},{key:"getAgentConfig",value:function(){throw new Error("Not implemented")}},{key:"setAgentConfig",value:function(t){throw new Error("Not implemented")}},{key:"getVoiceCapabilities",value:function(){throw new Error("Not implemented")}},{key:"wrapUpCall",value:function(t){throw new Error("Not implemented")}},{key:"getSignedRecordingUrl",value:function(t,e,n){throw new Error("Not implemented")}},{key:"superviseCall",value:function(t){throw new Error("Not implemented")}},{key:"supervisorDisconnect",value:function(t){throw new Error("Not implemented")}},{key:"supervisorBargeIn",value:function(t){throw new Error("Not implemented")}}]),Tt=h((function t(){_(this,t)}),[{key:"init",value:function(t){throw new Error("Not implemented")}},{key:"getTelephonyConnector",value:function(){throw new Error("Not implemented")}},{key:"onAgentWorkEvent",value:function(t){throw new Error("Not implemented")}},{key:"setAgentStatus",value:function(t,e,n){throw new Error("Not implemented")}},{key:"getAgentStatus",value:function(){this.logMessageToVendor(c.LOG_LEVEL.INFO,"getAgentStatus API is NOT Implemented")}},{key:"logout",value:function(){throw new Error("Not implemented")}},{key:"handleMessage",value:function(t){throw new Error("Not implemented")}},{key:"downloadLogs",value:function(t){!function(t,e){if(document&&t){var n="string"==typeof t?t:JSON.stringify(t),a=new Blob([n],{type:"text/plain"}),s=document.createElement("a"),r=URL.createObjectURL(a);s.download=e,s.href=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}}(f.join(""),"log-".concat((new Date).getTime(),".txt"))}},{key:"logMessageToVendor",value:function(t,e,n){}},{key:"getContacts",value:function(t,e){throw new Error("Not implemented")}},{key:"getAudioDevices",value:function(){throw new Error("Not implemented")}},{key:"getSharedCapabilities",value:function(){throw new Error("Not implemented")}}]),ut=h((function t(){_(this,t)}),null,[{key:"validateString",value:function(e){if("string"!=typeof e)throw new Error("Invalid argument. Expecting a string but got ".concat(t(e)));return this}},{key:"validateNumber",value:function(e){if("number"!=typeof e)throw new Error("Invalid argument. Expecting a number but got ".concat(t(e)));return this}},{key:"validateBoolean",value:function(e){if("boolean"!=typeof e)throw new Error("Invalid argument. Expecting a boolean but got ".concat(t(e)));return this}},{key:"validateEnum",value:function(t,e){if(!new RegExp(e.join("|"),"i").test(t))throw new Error("Invalid argument. Expecting a value from ".concat(JSON.stringify(e)," but got ").concat(t));return this}},{key:"validateDate",value:function(e){if(!(e instanceof Date))throw new Error("Invalid argument. Expecting a Date object but got ".concat(t(e)));return this}},{key:"validateClassObject",value:function(e,n){if(!(e instanceof n))throw new Error("Invalid className. Expecting object of class ".concat(n," but got ").concat(t(e)));return this}},{key:"validateClassObjects",value:function(e){for(var n=!1,a=arguments.length,s=new Array(a>1?a-1:0),r=1;r<a;r++)s[r-1]=arguments[r];for(var i=0;i<s.length;i++)try{this.validateClassObject(e,s[i]),n=!0;break}catch(t){}if(!n)throw new Error("Invalid className. Expecting object matching a class name in ".concat(s," but got ").concat(t(e)));return this}}]),Ct=h((function t(e){var n=e.workItemId,a=e.workId,s=e.workEvent;_(this,t),ut.validateEnum(s,Object.values(c.WORK_EVENT)),this.workEvent=s,this.workItemId=n,this.workId=a})),ht=h((function t(e){var n=e.statusId,a=e.statusApiName,s=e.statusName;_(this,t),ut.validateString(n),a&&ut.validateString(a),s&&ut.validateString(s),this.statusId=n,this.statusApiName=a,this.statusName=s})),_t=h((function t(e){var n=e.statusId,a=e.statusType,s=e.statusName;_(this,t),n&&ut.validateString(n),a&&ut.validateString(a),s&&ut.validateString(s),this.statusId=n,this.statusType=a,this.statusName=s})),dt=h((function t(e){var n=e.newVendorStateInfo,a=e.oldVendorStateInfo;_(this,t),ut.validateClassObject(n,_t),ut.validateString(n.statusName),a&&ut.validateClassObject(a,_t),this.newVendorStateInfo=n,this.oldVendorStateInfo=a})),pt=h((function t(e){var n=e.callId,a=e.voiceCallId,s=e.callType,r=e.from,i=e.to,o=e.supervisorName,l=e.isBargedIn,c=e.connectionId;_(this,t),ut.validateString(n),this.callId=n,this.voiceCallId=a,this.callType=s,this.from=r,this.to=i,this.supervisorName=o,this.isBargedIn=l,this.connectionId=c||n})),At=h((function t(e){var n=e.callId,a=e.stats,s=e.isAudioStatsCompleted;_(this,t),n&&(ut.validateString(n),this.callId=n),a&&(ut.validateClassObject(a,Array),a.forEach((function(t){return ut.validateClassObject(t,Nt)})),this.stats=a),s&&(ut.validateBoolean(s),this.isAudioStatsCompleted=s)})),Nt=h((function t(e){var n=e.inputChannelStats,a=e.outputChannelStats;_(this,t),n&&ut.validateClassObject(n,It),a&&ut.validateClassObject(a,It),this.inputChannelStats=n,this.outputChannelStats=a})),It=h((function t(e){var n=e.packetsCount,a=e.packetsLost,s=e.jitterBufferMillis,r=e.roundTripTimeMillis;_(this,t),n=null==n||n<0?0:n,a=null==a||a<0?0:a,s=null==s||s<0?0:s,r=null==r||r<0?0:r,this.statsCount=0,this.packetsCount=n,this.packetsLost=a,this.jitterBufferMillis=s,this.roundTripTimeMillis=r})),Ot=h((function t(e){var n=e.call;_(this,t),ut.validateClassObject(n,ct),this.call=n})),St=function(t){function e(t){var n=t.calls;return _(this,e),v(this,e,[{calls:n}])}return A(e,t),h(e)}(X),Rt=h((function t(e){var n=e.success,a=void 0!==n&&n,s=e.showLogin,r=void 0!==s&&s,i=e.loginFrameHeight,o=void 0===i?350:i;_(this,t),this.success=a,this.showLogin=r,this.loginFrameHeight=o})),ft=h((function t(e){if(_(this,t),e){var n=e.contains,a=void 0===n?null:n,s=e.limit,r=void 0===s?50:s,i=e.offset,o=void 0===i?0:i,l=e.types,E=void 0===l?[]:l;a&&ut.validateString(a),ut.validateNumber(r),ut.validateNumber(o);var T,u=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,e){if(t){if("string"==typeof t)return g(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}(t))){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,i=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return r=t.done,t},e:function(t){i=!0,s=t},f:function(){try{r||null==e.return||e.return()}finally{if(i)throw s}}}}(E);try{for(u.s();!(T=u.n()).done;)T.value,ut.validateEnum(E,Object.values(c.CONTACTS_FILTER_TYPES))}catch(t){u.e(t)}finally{u.f()}this.contains=a,this.limit=r,this.offset=o,this.types=E}})),Pt=h((function t(e){var n=e.agentWorkId,a=e.workItemId;if(_(this,t),n&&(ut.validateString(n),this.agentWorkId=n),a&&(ut.validateString(a),this.workItemId=a),!n&&!a)throw new Error("You must pass at least one of agent work id or work item (voice call or messaging session) id")})),gt=!1;function vt(t){var e=function(t){var e=y[t];return{packetsCount:e.packetsCount/e.statsCount,packetsLost:e.packetsLost/e.statsCount,jitterBufferMillis:e.jitterBufferMillis/e.statsCount,roundTripTimeMillis:e.roundTripTimeMillis/e.statsCount}}(t),n=e.roundTripTimeMillis+2*e.jitterBufferMillis+10,a=0;return a=n<160?93.2-n/40:93.2-(n-120)/10,1+.035*(a-=e.packetsLost/e.packetsCount*2.5)+7e-6*a*(a-60)*(100-a)}function Lt(){if(gt&&y){var t=vt("inputChannelStats"),e=vt("outputChannelStats");return y=null,isNaN(e)&&isNaN(t)?0:isNaN(e)?t:isNaN(t)?e:Math.min(t,e)}}function bt(){y=new Nt({inputChannelStats:new It({packetsCount:0,packetsLost:0,jitterBufferMillis:0,roundTripTimeMillis:0}),outputChannelStats:new It({packetsCount:0,packetsLost:0,jitterBufferMillis:0,roundTripTimeMillis:0})})}function mt(t){return t&&t.type?t.type:t}function yt(e){if(e){if("function"==typeof e)return;if("object"===t(e)){var n=Array.isArray(e),a=n?[]:{};if(n)e.forEach((function(t){a.push(yt(t))}));else for(var s in e)"phoneNumber"!==s&&"number"!==s&&"name"!==s&&"callAttributes"!==s&&"/reqHvcc/reqTelephonyIntegrationCertificate"!==s&&(a[s]=yt(e[s]));return a}}return e}function Dt(t){return t&&t.message?t.message:t}function Vt(t,e,n){var a=yt(e);P({eventType:t,payload:e},n?c.LOG_LEVEL.ERROR:c.LOG_LEVEL.INFO,c.LOG_SOURCE.SYSTEM),D.postMessage({type:c.SHARED_MESSAGE_TYPE.LOG,payload:{eventType:t,payload:a,isError:n}})}function wt(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];D.postMessage({type:c.SHARED_MESSAGE_TYPE.TELEPHONY_EVENT_DISPATCHED,payload:{telephonyEventType:t,telephonyEventPayload:e}}),n&&Vt(t,e,!1)}function Gt(t,e,n){console.error("SCV dispatched error ".concat(t," for eventType ").concat(n),e),wt(c.SHARED_EVENT_TYPE.ERROR,{message:t},!1),Vt(n,{errorType:t,error:e},!0)}function Ut(t,e){var n={customError:{labelName:t.labelName,namespace:t.namespace,message:t.message}};console.error("SCV dispatched custom error for eventType ".concat(e),n),wt(c.SHARED_EVENT_TYPE.ERROR,n,!1),Vt(e,{errorType:c.SHARED_ERROR_TYPE.CUSTOM_ERROR,error:t},!0)}function kt(t,e){console.info("SCV info message dispatched for eventType ".concat(t," with payload ").concat(JSON.stringify(e))),wt(c.SHARED_EVENT_TYPE.INFO,{message:t},!1),Vt(t,e,!1)}function Yt(){return Ht.apply(this,arguments)}function Ht(){return(Ht=i(l().mark((function t(){var e,n,a,r,i,o,E,T,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,V.getTelephonyConnector();case 3:return n=t.sent,t.next=6,n.getAgentConfig();case 6:return a=t.sent,t.next=9,V.getSharedCapabilities();case 9:return r=t.sent,t.next=12,n.getVoiceCapabilities();case 12:return i=t.sent,ut.validateClassObject(a,j),ut.validateClassObject(i,F),i.supportsMos&&(gt=!0),t.next=18,n.getActiveCalls();case 18:o=t.sent,ut.validateClassObject(o,M),E=o.activeCalls,T=c.SHARED_MESSAGE_TYPE.CONNECTOR_READY,u={agentConfig:s(s({},c.AGENT_CONFIG_TYPE.PHONES,a.phones),c.AGENT_CONFIG_TYPE.SELECTED_PHONE,a.selectedPhone),capabilities:(e={},s(s(s(s(s(s(s(s(s(s(e,c.SHARED_CAPABILITIES_TYPE.DEBUG_ENABLED,r.debugEnabled),c.SHARED_CAPABILITIES_TYPE.CONTACT_SEARCH,r.hasContactSearch),c.SHARED_CAPABILITIES_TYPE.VENDOR_PROVIDED_AVAILABILITY,r.hasAgentAvailability),c.SHARED_CAPABILITIES_TYPE.VENDOR_PROVIDED_QUEUE_WAIT_TIME,r.hasQueueWaitTime),c.SHARED_CAPABILITIES_TYPE.TRANSFER_TO_OMNI_FLOW,r.hasTransferToOmniFlow),c.SHARED_CAPABILITIES_TYPE.PENDING_STATUS_CHANGE,r.hasPendingStatusChange),c.SHARED_CAPABILITIES_TYPE.SFDC_PENDING_STATE,r.hasSFDCPendingState),c.SHARED_CAPABILITIES_TYPE.AUTO_ACCEPT_ENABLED,r.hasAutoAcceptEnabled),c.VOICE_CAPABILITIES_TYPE.MUTE,i.hasMute),c.VOICE_CAPABILITIES_TYPE.RECORD,i.hasRecord),s(s(s(s(s(s(s(s(s(s(e,c.VOICE_CAPABILITIES_TYPE.MERGE,i.hasMerge),c.VOICE_CAPABILITIES_TYPE.SWAP,i.hasSwap),c.VOICE_CAPABILITIES_TYPE.BLIND_TRANSFER,i.hasBlindTransfer),c.VOICE_CAPABILITIES_TYPE.SIGNED_RECORDING_URL,i.hasSignedRecordingUrl),c.VOICE_CAPABILITIES_TYPE.SUPERVISOR_LISTEN_IN,i.hasSupervisorListenIn),c.VOICE_CAPABILITIES_TYPE.SUPERVISOR_BARGE_IN,i.hasSupervisorBargeIn),c.VOICE_CAPABILITIES_TYPE.MOS,i.supportsMos),c.VOICE_CAPABILITIES_TYPE.PHONEBOOK,i.hasPhoneBook),c.VOICE_CAPABILITIES_TYPE.HAS_GET_EXTERNAL_SPEAKER,i.hasGetExternalSpeakerDeviceSetting),c.VOICE_CAPABILITIES_TYPE.HAS_SET_EXTERNAL_SPEAKER,i.hasSetExternalSpeakerDeviceSetting),s(s(s(s(s(s(e,c.VOICE_CAPABILITIES_TYPE.HAS_GET_EXTERNAL_MICROPHONE,i.hasGetExternalMicrophoneDeviceSetting),c.VOICE_CAPABILITIES_TYPE.HAS_SET_EXTERNAL_MICROPHONE,i.hasSetExternalMicrophoneDeviceSetting),c.VOICE_CAPABILITIES_TYPE.CAN_CONSULT,i.canConsult),c.VOICE_CAPABILITIES_TYPE.DIAL_PAD,i.isDialPadDisabled),c.VOICE_CAPABILITIES_TYPE.HAS_HID_SUPPORT,i.isHidSupported),c.VOICE_CAPABILITIES_TYPE.PHONEBOOK_DISABLE,i.isPhoneBookDisabled)),callInProgress:E.length>0?E[0]:null},D.postMessage({type:T,payload:u}),Vt(T,u,!1),t.next=31;break;case 27:t.prev=27,t.t0=t.catch(0),D.postMessage({type:c.SHARED_MESSAGE_TYPE.CONNECTOR_READY,payload:{}}),Vt(c.SHARED_MESSAGE_TYPE.CONNECTOR_READY,{},!1);case 31:case"end":return t.stop()}}),t,null,[[0,27]])})))).apply(this,arguments)}function Mt(t){return xt.apply(this,arguments)}function xt(){return(xt=i(l().mark((function t(e){var n,a,s,r,i,o,E,T,u,C,h,_,d,p,A,N,I,O,S,R,P,g,v,L,b,m,y,D,G,k,Y,H,B,F,j,W,K,q,z,tt,it,lt,ct,Et,Tt,Ct,ht,dt,pt,At,Nt,It,Rt,ft,Pt,gt,vt,Lt,yt,Yt,Ht,Mt,xt,Bt,Ft,jt,Wt,Kt,qt,Jt,$t,Xt,zt,Zt,te,ee,ne,ae,se,re,ie,oe,le,ce;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.data.type)!==c.SHARED_MESSAGE_TYPE.LOG&&Vt(n,e.data,!1),t.t0=n,t.next=t.t0===c.VOICE_MESSAGE_TYPE.ACCEPT_CALL?5:t.t0===c.VOICE_MESSAGE_TYPE.DECLINE_CALL?32:t.t0===c.VOICE_MESSAGE_TYPE.END_CALL?48:t.t0===c.VOICE_MESSAGE_TYPE.MUTE?69:t.t0===c.VOICE_MESSAGE_TYPE.UNMUTE?83:t.t0===c.VOICE_MESSAGE_TYPE.HOLD?97:t.t0===c.VOICE_MESSAGE_TYPE.RESUME?121:t.t0===c.SHARED_MESSAGE_TYPE.SET_AGENT_STATUS?145:t.t0===c.SHARED_MESSAGE_TYPE.GET_AGENT_STATUS?171:t.t0===c.VOICE_MESSAGE_TYPE.DIAL?183:t.t0===c.VOICE_MESSAGE_TYPE.SEND_DIGITS?214:t.t0===c.VOICE_MESSAGE_TYPE.GET_PHONE_CONTACTS?226:t.t0===c.SHARED_MESSAGE_TYPE.GET_CONTACTS?242:t.t0===c.VOICE_MESSAGE_TYPE.SWAP_PARTICIPANTS?255:t.t0===c.VOICE_MESSAGE_TYPE.CONFERENCE?269:t.t0===c.VOICE_MESSAGE_TYPE.ADD_PARTICIPANT?283:t.t0===c.VOICE_MESSAGE_TYPE.PAUSE_RECORDING?309:t.t0===c.VOICE_MESSAGE_TYPE.RESUME_RECORDING?323:t.t0===c.SHARED_MESSAGE_TYPE.LOGOUT?337:t.t0===c.SHARED_MESSAGE_TYPE.MESSAGE?350:t.t0===c.VOICE_MESSAGE_TYPE.WRAP_UP_CALL?352:t.t0===c.VOICE_MESSAGE_TYPE.AGENT_AVAILABLE?357:t.t0===c.VOICE_MESSAGE_TYPE.SET_AGENT_CONFIG?399:t.t0===c.VOICE_MESSAGE_TYPE.GET_AUDIO_DEVICES?415:t.t0===c.VOICE_MESSAGE_TYPE.GET_SIGNED_RECORDING_URL?430:t.t0===c.SHARED_MESSAGE_TYPE.DOWNLOAD_VENDOR_LOGS?448:t.t0===c.SHARED_MESSAGE_TYPE.LOG?450:t.t0===c.VOICE_MESSAGE_TYPE.SUPERVISE_CALL?453:t.t0===c.VOICE_MESSAGE_TYPE.SUPERVISOR_DISCONNECT?473:t.t0===c.VOICE_MESSAGE_TYPE.SUPERVISOR_BARGE_IN?489:t.t0===c.SHARED_MESSAGE_TYPE.AGENT_WORK_EVENT?504:507;break;case 5:if(t.prev=5,!e.data.call||!e.data.call.callType||e.data.call.callType.toLowerCase()!==c.CALL_TYPE.OUTBOUND.toLowerCase()&&e.data.call.callType.toLowerCase()!==c.CALL_TYPE.DIALED_CALLBACK.toLowerCase()){t.next=8;break}return t.abrupt("return");case 8:return bt(),t.next=11,V.getTelephonyConnector();case 11:if(a=t.sent,!w){t.next=19;break}return t.next=15,a.supervisorDisconnect();case 15:s=t.sent,ut.validateClassObject(s,St),w=!1,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,s.calls);case 19:return t.next=21,a.acceptCall(e.data.call);case 21:r=t.sent,ut.validateClassObject(r,$),wt((i=r.call).callType.toLowerCase()===c.CALL_TYPE.CALLBACK.toLowerCase()?c.VOICE_EVENT_TYPE.CALL_STARTED:c.VOICE_EVENT_TYPE.CALL_CONNECTED,i),t.next=31;break;case 27:t.prev=27,t.t1=t.catch(5),w=!1,t.t1 instanceof U?Ut(t.t1,c.VOICE_MESSAGE_TYPE.ACCEPT_CALL):kt(c.INFO_TYPE.CAN_NOT_ACCEPT_THE_CALL,{messagetype:c.VOICE_MESSAGE_TYPE.ACCEPT_CALL,additionalInfo:t.t1});case 31:return t.abrupt("break",508);case 32:return t.prev=32,t.next=35,V.getTelephonyConnector();case 35:return o=t.sent,t.next=38,o.declineCall(e.data.call);case 38:E=t.sent,ut.validateClassObject(E,$),T=E.call,wt(c.VOICE_EVENT_TYPE.HANGUP,T),t.next=47;break;case 44:t.prev=44,t.t2=t.catch(32),t.t2 instanceof U?Ut(t.t2,c.VOICE_MESSAGE_TYPE.DECLINE_CALL):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_DECLINE_THE_CALL,t.t2,c.VOICE_MESSAGE_TYPE.DECLINE_CALL);case 47:return t.abrupt("break",508);case 48:return t.prev=48,t.next=51,V.getTelephonyConnector();case 51:return u=t.sent,t.next=54,u.endCall(e.data.call,e.data.agentStatus);case 54:return C=t.sent,ut.validateClassObject(C,X),t.next=58,u.getActiveCalls();case 58:h=t.sent,ut.validateClassObject(h,M),_=h.activeCalls,d=C.calls,0===_.length?wt(c.VOICE_EVENT_TYPE.HANGUP,d):wt(c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,d.length>0&&d[0]),t.next=68;break;case 65:t.prev=65,t.t3=t.catch(48),t.t3 instanceof U?Ut(t.t3,c.VOICE_MESSAGE_TYPE.END_CALL):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_END_THE_CALL,t.t3,c.VOICE_MESSAGE_TYPE.END_CALL);case 68:return t.abrupt("break",508);case 69:return t.prev=69,t.next=72,V.getTelephonyConnector();case 72:return p=t.sent,t.next=75,p.mute(e.data.call);case 75:A=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.MUTE_TOGGLE,payload:A}),t.next=82;break;case 79:t.prev=79,t.t4=t.catch(69),t.t4 instanceof U?Ut(t.t4,c.VOICE_MESSAGE_TYPE.MUTE):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_MUTE_CALL,t.t4,c.VOICE_MESSAGE_TYPE.MUTE);case 82:return t.abrupt("break",508);case 83:return t.prev=83,t.next=86,V.getTelephonyConnector();case 86:return N=t.sent,t.next=89,N.unmute(e.data.call);case 89:I=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.MUTE_TOGGLE,payload:I}),t.next=96;break;case 93:t.prev=93,t.t5=t.catch(83),t.t5 instanceof U?Ut(t.t5,c.VOICE_MESSAGE_TYPE.UNMUTE):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_UNMUTE_CALL,t.t5,c.VOICE_MESSAGE_TYPE.UNMUTE);case 96:return t.abrupt("break",508);case 97:return t.prev=97,t.next=100,V.getTelephonyConnector();case 100:return O=t.sent,t.next=103,O.hold(e.data.call);case 103:S=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.HOLD_TOGGLE,payload:S}),t.next=120;break;case 107:if(t.prev=107,t.t6=t.catch(97),!(t.t6 instanceof U)){t.next=113;break}Ut(t.t6,c.VOICE_MESSAGE_TYPE.HOLD),t.next=120;break;case 113:t.t7=mt(t.t6),t.next=t.t7===c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT?116:118;break;case 116:return Gt(c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT,Dt(t.t6),c.VOICE_MESSAGE_TYPE.HOLD),t.abrupt("break",120);case 118:return Gt(c.VOICE_ERROR_TYPE.CAN_NOT_HOLD_CALL,Dt(t.t6),c.VOICE_MESSAGE_TYPE.HOLD),t.abrupt("break",120);case 120:return t.abrupt("break",508);case 121:return t.prev=121,t.next=124,V.getTelephonyConnector();case 124:return R=t.sent,t.next=127,R.resume(e.data.call);case 127:P=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.HOLD_TOGGLE,payload:P}),t.next=144;break;case 131:if(t.prev=131,t.t8=t.catch(121),!(t.t8 instanceof U)){t.next=137;break}Ut(t.t8,c.VOICE_MESSAGE_TYPE.RESUME),t.next=144;break;case 137:t.t9=mt(t.t8),t.next=t.t9===c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT?140:142;break;case 140:return Gt(c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT,Dt(t.t8),c.VOICE_MESSAGE_TYPE.RESUME),t.abrupt("break",144);case 142:return Gt(c.VOICE_ERROR_TYPE.CAN_NOT_RESUME_CALL,Dt(t.t8),c.VOICE_MESSAGE_TYPE.RESUME),t.abrupt("break",144);case 144:return t.abrupt("break",508);case 145:return t.prev=145,g=e.data.statusInfo||{},v=e.data.enqueueNextState||!1,t.next=150,V.setAgentStatus(e.data.agentStatus,g,v);case 150:L=t.sent,ut.validateClassObject(L,nt,at),b=L.success,m=L.isStatusSyncNeeded,wt(c.SHARED_EVENT_TYPE.SET_AGENT_STATUS_RESULT,void 0!==m?{success:b,isStatusSyncNeeded:m}:{success:b}),t.next=170;break;case 156:if(t.prev=156,t.t10=t.catch(145),!(t.t10 instanceof U)){t.next=162;break}Ut(t.t10,c.SHARED_MESSAGE_TYPE.SET_AGENT_STATUS),t.next=170;break;case 162:e.data.statusInfo&&wt(c.SHARED_EVENT_TYPE.SET_AGENT_STATUS_RESULT,{success:!1}),t.t11=mt(t.t10),t.next=t.t11===c.SHARED_ERROR_TYPE.INVALID_AGENT_STATUS?166:168;break;case 166:return Gt(c.SHARED_ERROR_TYPE.INVALID_AGENT_STATUS,Dt(t.t10),c.SHARED_MESSAGE_TYPE.SET_AGENT_STATUS),t.abrupt("break",170);case 168:return Gt(c.SHARED_ERROR_TYPE.CAN_NOT_SET_AGENT_STATUS,Dt(t.t10),c.SHARED_MESSAGE_TYPE.SET_AGENT_STATUS),t.abrupt("break",170);case 170:return t.abrupt("break",508);case 171:return t.prev=171,t.next=174,V.getAgentStatus();case 174:y=t.sent,ut.validateClassObject(y,_t),wt(c.SHARED_EVENT_TYPE.GET_AGENT_STATUS_RESULT,y),t.next=182;break;case 179:t.prev=179,t.t12=t.catch(171),t.t12 instanceof U?Ut(t.t12,c.SHARED_MESSAGE_TYPE.GET_AGENT_STATUS):Gt(c.SHARED_ERROR_TYPE.CAN_NOT_GET_AGENT_STATUS,Dt(t.t12),c.SHARED_MESSAGE_TYPE.GET_AGENT_STATUS);case 182:return t.abrupt("break",508);case 183:return t.prev=183,t.next=186,V.getTelephonyConnector();case 186:return D=t.sent,G=e.data.params&&e.data.params.indexOf(c.DIAL_OPTIONS.CALLBACK)>=0,k=e.data.params&&e.data.params.indexOf(c.DIAL_OPTIONS.CONSULT)>=0,t.next=191,D.dial(new ot(e.data.contact),new et({isCallback:G,isConsultCall:k}));case 191:Y=t.sent,ut.validateClassObject(Y,$),H=Y.call,c.CALL_TYPE.DIALED_CALLBACK.toLowerCase()===H.callType.toLowerCase()&&G?wt(c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED,H):wt(c.VOICE_EVENT_TYPE.CALL_STARTED,H),t.next=213;break;case 197:if(t.prev=197,t.t13=t.catch(183),wt(c.VOICE_EVENT_TYPE.CALL_FAILED),!(t.t13 instanceof U)){t.next=204;break}Ut(t.t13,c.VOICE_MESSAGE_TYPE.DIAL),t.next=213;break;case 204:t.t14=mt(t.t13),t.next=t.t14===c.VOICE_ERROR_TYPE.INVALID_DESTINATION?207:t.t14===c.SHARED_ERROR_TYPE.GENERIC_ERROR?209:211;break;case 207:return Gt(c.VOICE_ERROR_TYPE.INVALID_DESTINATION,Dt(t.t13),c.VOICE_MESSAGE_TYPE.DIAL),t.abrupt("break",213);case 209:return Gt(c.SHARED_ERROR_TYPE.GENERIC_ERROR,Dt(t.t13),c.VOICE_MESSAGE_TYPE.DIAL),t.abrupt("break",213);case 211:return Gt(c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,Dt(t.t13),c.VOICE_MESSAGE_TYPE.DIAL),t.abrupt("break",213);case 213:return t.abrupt("break",508);case 214:return t.prev=214,t.next=217,V.getTelephonyConnector();case 217:return B=t.sent,t.next=220,B.sendDigits(e.data.digits);case 220:t.next=225;break;case 222:t.prev=222,t.t15=t.catch(214),Vt(c.VOICE_MESSAGE_TYPE.SEND_DIGITS,e.data.digits,!0);case 225:return t.abrupt("break",508);case 226:return t.prev=226,t.next=229,V.getTelephonyConnector();case 229:return F=t.sent,t.next=232,F.getPhoneContacts(e.data.filter);case 232:j=t.sent,ut.validateClassObject(j,Q),W=j.contacts.map((function(t){return{id:t.id,type:t.type,name:t.name,listType:t.listType,phoneNumber:t.phoneNumber,prefix:t.prefix,extension:t.extension,endpointARN:t.endpointARN,queue:t.queue,availability:t.availability,queueWaitTime:t.queueWaitTime,recordId:t.recordId,description:t.description}})),wt(c.VOICE_EVENT_TYPE.PHONE_CONTACTS,{contacts:W,contactTypes:j.contactTypes}),t.next=241;break;case 238:t.prev=238,t.t16=t.catch(226),t.t16 instanceof U?Ut(t.t16,c.VOICE_MESSAGE_TYPE.GET_PHONE_CONTACTS):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_GET_PHONE_CONTACTS,t.t16,c.VOICE_MESSAGE_TYPE.GET_PHONE_CONTACTS);case 241:return t.abrupt("break",508);case 242:return t.prev=242,t.next=245,V.getContacts(e.data.filter,e.data.workItemId);case 245:K=t.sent,ut.validateClassObject(K,J),q=K.contacts.map((function(t){return{id:t.id,type:t.type,name:t.name,listType:t.listType,phoneNumber:t.phoneNumber,prefix:t.prefix,extension:t.extension,endpointARN:t.endpointARN,queue:t.queue,availability:t.availability,queueWaitTime:t.queueWaitTime,recordId:t.recordId,description:t.description}})),wt(c.SHARED_EVENT_TYPE.GET_CONTACTS_RESULT,{contacts:q,contactTypes:K.contactTypes}),t.next=254;break;case 251:t.prev=251,t.t17=t.catch(242),Ut(t.t17,c.SHARED_MESSAGE_TYPE.GET_CONTACTS);case 254:return t.abrupt("break",508);case 255:return t.prev=255,t.next=258,V.getTelephonyConnector();case 258:return z=t.sent,t.next=261,z.swap(e.data.callToHold,e.data.callToResume);case 261:tt=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED,payload:tt}),t.next=268;break;case 265:t.prev=265,t.t18=t.catch(255),t.t18 instanceof U?Ut(t.t18,c.VOICE_MESSAGE_TYPE.SWAP_PARTICIPANTS):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_SWAP_PARTICIPANTS,t.t18,c.VOICE_MESSAGE_TYPE.SWAP_PARTICIPANTS);case 268:return t.abrupt("break",508);case 269:return t.prev=269,t.next=272,V.getTelephonyConnector();case 272:return it=t.sent,t.next=275,it.conference(e.data.calls);case 275:lt=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED,payload:lt}),t.next=282;break;case 279:t.prev=279,t.t19=t.catch(269),t.t19 instanceof U?Ut(t.t19,c.VOICE_MESSAGE_TYPE.CONFERENCE):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_CONFERENCE,t.t19,c.VOICE_MESSAGE_TYPE.CONFERENCE);case 282:return t.abrupt("break",508);case 283:return t.prev=283,t.next=286,V.getTelephonyConnector();case 286:return ct=t.sent,t.next=289,ct.addParticipant(new ot(e.data.contact),e.data.call,e.data.isBlindTransfer);case 289:Et=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED,payload:Et}),e.data.isBlindTransfer&&wt(c.VOICE_EVENT_TYPE.HANGUP,e.data.call),t.next=308;break;case 294:if(t.prev=294,t.t20=t.catch(283),wt(c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,{reason:c.SHARED_EVENT_TYPE.ERROR.toLowerCase()}),!(t.t20 instanceof U)){t.next=301;break}Ut(t.t20,c.VOICE_MESSAGE_TYPE.ADD_PARTICIPANT),t.next=308;break;case 301:t.t21=mt(t.t20),t.next=t.t21===c.VOICE_ERROR_TYPE.INVALID_DESTINATION?304:306;break;case 304:return Gt(c.VOICE_ERROR_TYPE.INVALID_DESTINATION,Dt(t.t20),c.VOICE_MESSAGE_TYPE.ADD_PARTICIPANT),t.abrupt("break",308);case 306:return Gt(c.VOICE_ERROR_TYPE.CAN_NOT_ADD_PARTICIPANT,Dt(t.t20),c.VOICE_MESSAGE_TYPE.ADD_PARTICIPANT),t.abrupt("break",308);case 308:return t.abrupt("break",508);case 309:return t.prev=309,t.next=312,V.getTelephonyConnector();case 312:return Tt=t.sent,t.next=315,Tt.pauseRecording(e.data.call);case 315:Ct=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.RECORDING_TOGGLE,payload:Ct}),t.next=322;break;case 319:t.prev=319,t.t22=t.catch(309),t.t22 instanceof U?Ut(t.t22,c.VOICE_MESSAGE_TYPE.PAUSE_RECORDING):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_PAUSE_RECORDING,t.t22,c.VOICE_MESSAGE_TYPE.PAUSE_RECORDING);case 322:return t.abrupt("break",508);case 323:return t.prev=323,t.next=326,V.getTelephonyConnector();case 326:return ht=t.sent,t.next=329,ht.resumeRecording(e.data.call);case 329:dt=t.sent,Qt({eventType:c.VOICE_EVENT_TYPE.RECORDING_TOGGLE,payload:dt}),t.next=336;break;case 333:t.prev=333,t.t23=t.catch(323),t.t23 instanceof U?Ut(t.t23,c.VOICE_MESSAGE_TYPE.RESUME_RECORDING):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_RESUME_RECORDING,t.t23,c.VOICE_MESSAGE_TYPE.RESUME_RECORDING);case 336:return t.abrupt("break",508);case 337:return t.prev=337,t.next=340,V.logout();case 340:pt=t.sent,ut.validateClassObject(pt,rt),At=pt.success,Nt=pt.loginFrameHeight,wt(c.SHARED_EVENT_TYPE.LOGOUT_RESULT,{success:At,loginFrameHeight:Nt}),t.next=349;break;case 346:t.prev=346,t.t24=t.catch(337),t.t24 instanceof U?Ut(t.t24,c.SHARED_MESSAGE_TYPE.LOGOUT):Gt(c.SHARED_ERROR_TYPE.CAN_NOT_LOG_OUT,t.t24,c.SHARED_MESSAGE_TYPE.LOGOUT);case 349:return t.abrupt("break",508);case 350:return V.handleMessage(e.data.message),t.abrupt("break",508);case 352:return t.next=354,V.getTelephonyConnector();case 354:return t.sent.wrapUpCall(e.data.call),t.abrupt("break",508);case 357:if(!e.data||!e.data.isAvailable){t.next=398;break}return t.next=360,V.getTelephonyConnector();case 360:return It=t.sent,t.next=363,It.getActiveCalls();case 363:Rt=t.sent,ut.validateClassObject(Rt,M),ft=Rt.activeCalls,t.t25=l().keys(ft);case 367:if((t.t26=t.t25()).done){t.next=398;break}if(Pt=t.t26.value,gt=ft[Pt],vt=!gt.callInfo||gt.callInfo.isReplayable,Lt=gt.callAttributes&&gt.callAttributes.participantType===c.PARTICIPANT_TYPE.SUPERVISOR,yt=Lt&&gt.callAttributes&&gt.callAttributes.hasSupervisorBargedIn,!vt){t.next=396;break}gt.isReplayedCall=!0,t.t27=gt.state,t.next=t.t27===c.CALL_STATE.CONNECTED?378:t.t27===c.CALL_STATE.RINGING?385:t.t27===c.CALL_STATE.TRANSFERRING?391:t.t27===c.CALL_STATE.TRANSFERRED?393:395;break;case 378:if(!Lt){t.next=383;break}return w=!0,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED,gt),yt&&wt(c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN,gt),t.abrupt("break",396);case 383:return wt(c.VOICE_EVENT_TYPE.CALL_CONNECTED,gt),t.abrupt("break",396);case 385:if(!Lt){t.next=389;break}return w=!0,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED,gt),t.abrupt("break",396);case 389:return wt(c.VOICE_EVENT_TYPE.CALL_STARTED,gt),t.abrupt("break",396);case 391:return wt(c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED,{phoneNumber:gt.contact.phoneNumber,contact:gt.contact,callInfo:gt.callInfo,callAttributes:gt.callAttributes,initialCallHasEnded:gt.callAttributes.initialCallHasEnded,callId:gt.callId,connectionId:gt.connectionId}),t.abrupt("break",396);case 393:return wt(c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,{phoneNumber:gt.contact.phoneNumber,contact:gt.contact,callInfo:gt.callInfo,callAttributes:gt.callAttributes,initialCallHasEnded:gt.callAttributes.initialCallHasEnded,callId:gt.callId,connectionId:gt.connectionId}),t.abrupt("break",396);case 395:return t.abrupt("break",396);case 396:t.next=367;break;case 398:return t.abrupt("break",508);case 399:return t.prev=399,t.next=402,V.getTelephonyConnector();case 402:return Yt=t.sent,t.next=405,Yt.setAgentConfig(e.data.config);case 405:Ht=t.sent,ut.validateClassObjects(Ht,nt,st),Ht instanceof st&&Ht.setIsSystemEvent(!!e.data.config.isSystemEvent),wt(c.VOICE_EVENT_TYPE.AGENT_CONFIG_UPDATED,Ht),t.next=414;break;case 411:t.prev=411,t.t28=t.catch(399),t.t28 instanceof U?Ut(t.t28,c.VOICE_MESSAGE_TYPE.SET_AGENT_CONFIG):Gt(mt(t.t28)===c.VOICE_ERROR_TYPE.CAN_NOT_UPDATE_PHONE_NUMBER?c.VOICE_ERROR_TYPE.CAN_NOT_UPDATE_PHONE_NUMBER:c.VOICE_ERROR_TYPE.CAN_NOT_SET_AGENT_CONFIG,Dt(t.t28),c.VOICE_MESSAGE_TYPE.SET_AGENT_CONFIG);case 414:return t.abrupt("break",508);case 415:return t.prev=415,t.next=418,V.getTelephonyConnector();case 418:return Mt=t.sent,t.next=421,Mt.getAudioDevices();case 421:xt=t.sent,ut.validateClassObject(xt,x),wt(c.VOICE_EVENT_TYPE.GET_AUDIO_DEVICES,xt),t.next=429;break;case 426:t.prev=426,t.t29=t.catch(415),Gt(c.VOICE_ERROR_TYPE.CAN_NOT_GET_AUDIO_DEVICES,Dt(t.t29),c.VOICE_MESSAGE_TYPE.GET_AUDIO_DEVICES);case 429:return t.abrupt("break",508);case 430:return t.prev=430,Bt=e.data,Ft=Bt.recordingUrl,jt=Bt.vendorCallKey,Wt=Bt.callId,t.next=434,V.getTelephonyConnector();case 434:return Kt=t.sent,t.next=437,Kt.getSignedRecordingUrl(Ft,jt,Wt);case 437:qt=t.sent,ut.validateClassObject(qt,Z),wt(c.VOICE_EVENT_TYPE.SIGNED_RECORDING_URL,qt),t.next=447;break;case 442:t.prev=442,t.t30=t.catch(430),Jt=new Z({success:!1}),wt(c.VOICE_EVENT_TYPE.SIGNED_RECORDING_URL,Jt,!1),Vt(c.VOICE_MESSAGE_TYPE.GET_SIGNED_RECORDING_URL,Jt,!0);case 447:return t.abrupt("break",508);case 448:return V.downloadLogs(JSON.parse(JSON.stringify(f))),t.abrupt("break",508);case 450:return $t=e.data,Xt=$t.logLevel,zt=$t.logMessage,Zt=$t.payload,V.logMessageToVendor(Xt,zt,Zt),t.abrupt("break",508);case 453:return t.prev=453,w=!0,t.next=457,V.getTelephonyConnector();case 457:return te=t.sent,t.next=460,te.superviseCall(e.data.call);case 460:return ee=t.sent,ut.validateClassObject(ee,Ot),t.next=464,te.getAgentConfig();case 464:t.sent.selectedPhone.type===c.PHONE_TYPE.SOFT_PHONE?wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED,ee.call):wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED,ee.call),t.next=472;break;case 468:t.prev=468,t.t31=t.catch(453),w=!1,t.t31 instanceof U?Ut(t.t31,c.VOICE_MESSAGE_TYPE.SUPERVISE_CALL):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_SUPERVISE_CALL,t.t31,c.VOICE_MESSAGE_TYPE.SUPERVISE_CALL);case 472:return t.abrupt("break",508);case 473:return t.prev=473,t.next=476,V.getTelephonyConnector();case 476:return ne=t.sent,t.next=479,ne.supervisorDisconnect(e.data.call);case 479:ae=t.sent,ut.validateClassObject(ae,St),w=!1,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,ae.calls),t.next=488;break;case 485:t.prev=485,t.t32=t.catch(473),t.t32 instanceof U?Ut(t.t32,c.VOICE_MESSAGE_TYPE.SUPERVISOR_DISCONNECT):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_DISCONNECT_SUPERVISOR,t.t32,c.VOICE_MESSAGE_TYPE.SUPERVISOR_DISCONNECT);case 488:return t.abrupt("break",508);case 489:return t.prev=489,t.next=492,V.getTelephonyConnector();case 492:return se=t.sent,t.next=495,se.supervisorBargeIn(e.data.call);case 495:re=t.sent,ut.validateClassObject(re,Ot),wt(c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN,re.call),t.next=503;break;case 500:t.prev=500,t.t33=t.catch(489),t.t33 instanceof U?Ut(t.t33,c.VOICE_MESSAGE_TYPE.SUPERVISOR_BARGE_IN):Gt(c.VOICE_ERROR_TYPE.CAN_NOT_BARGE_IN_SUPERVISOR,t.t33,c.VOICE_MESSAGE_TYPE.SUPERVISOR_BARGE_IN);case 503:return t.abrupt("break",508);case 504:return ie=e.data.agentWork,oe=ie.workItemId,le=ie.workId,ce=ie.workEvent,V.onAgentWorkEvent({workItemId:oe,workId:le,workEvent:ce}),t.abrupt("break",508);case 507:return t.abrupt("break",508);case 508:case"end":return t.stop()}}),t,null,[[5,27],[32,44],[48,65],[69,79],[83,93],[97,107],[121,131],[145,156],[171,179],[183,197],[214,222],[226,238],[242,251],[255,265],[269,279],[283,294],[309,319],[323,333],[337,346],[399,411],[415,426],[430,442],[453,468],[473,485],[489,500]])})))).apply(this,arguments)}function Bt(t){return Ft.apply(this,arguments)}function Ft(){return(Ft=i(l().mark((function t(e){var n,a,s,r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.data.type,t.next=t.t0===c.SHARED_MESSAGE_TYPE.SETUP_CONNECTOR?3:33;break;case 3:if(n=/^https:\/\/[\w-.]+(lightning\.[\w]+\.soma\.force\.com|\.lightning\.force\.com|\.lightning\.pc-rnd\.force\.com|\.stm\.force\.com|\.vf\.force\.com|\.salesforce\.com|\.my\.salesforce-sites\.com|\.lightning\.localhost\.[\w]+\.force.com|\.lightning\.force-com\.[\w.-]+\.crm\.dev|\.pc-rnd\.(salesforce|crmforce)\.mil)$/,a=new URL(e.origin),s=a.protocol+"//"+a.hostname,!n.test(s)){t.next=31;break}return(D=e.ports[0]).onmessage=Mt,Vt(c.SHARED_MESSAGE_TYPE.SETUP_CONNECTOR,jt(e.data.connectorConfig),!1),t.prev=10,t.next=13,V.init(e.data.connectorConfig);case 13:r=t.sent,ut.validateClassObject(r,tt),r.showStorageAccess?wt(c.SHARED_EVENT_TYPE.SHOW_STORAGE_ACCESS,{success:!0}):r.showLogin?wt(c.SHARED_EVENT_TYPE.SHOW_LOGIN,{loginFrameHeight:r.loginFrameHeight}):r.isSilentLogin?wt(c.SHARED_EVENT_TYPE.SHOW_LOGIN,{isSilentLogin:r.isSilentLogin}):Yt(),t.next=31;break;case 18:if(t.prev=18,t.t1=t.catch(10),!(t.t1 instanceof U)){t.next=24;break}Ut(t.t1,c.SHARED_MESSAGE_TYPE.SETUP_CONNECTOR),t.next=31;break;case 24:t.t2=mt(t.t1),t.next=t.t2===c.VOICE_ERROR_TYPE.INVALID_PARAMS?27:29;break;case 27:return Gt(c.VOICE_ERROR_TYPE.INVALID_PARAMS,Dt(t.t1),c.SHARED_MESSAGE_TYPE.SETUP_CONNECTOR),t.abrupt("break",31);case 29:return Gt(c.SHARED_ERROR_TYPE.CAN_NOT_LOG_IN,Dt(t.t1),c.SHARED_MESSAGE_TYPE.SETUP_CONNECTOR),t.abrupt("break",31);case 31:return window.removeEventListener("message",Bt),t.abrupt("break",34);case 33:return t.abrupt("break",34);case 34:case"end":return t.stop()}}),t,null,[[10,18]])})))).apply(this,arguments)}function jt(t){t=t||{};var e={};return E.forEach((function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),T.forEach((function(n){Object.keys(t).forEach((function(a){a.startsWith(n)&&!u.includes(a)&&(e[a]=t[a])}))})),e}function Wt(t,e,n,a){try{return ut.validateClassObject(t,e),!0}catch(t){return n&&Gt(n,t,a),!1}}function Kt(t){V=t,window.addEventListener("message",Bt)}function qt(t){Vt(t.eventType,t.payload,t.isError)}function Jt(t){var e=t.eventType,n=t.error;if(n instanceof U)Ut(n,e);else switch(e){case c.SHARED_EVENT_TYPE.LOGIN_RESULT:Gt(c.SHARED_ERROR_TYPE.CAN_NOT_LOG_IN,n,c.SHARED_EVENT_TYPE.LOGIN_RESULT);break;case c.SHARED_EVENT_TYPE.LOGOUT_RESULT:Gt(c.SHARED_ERROR_TYPE.CAN_NOT_LOG_OUT,n,c.SHARED_EVENT_TYPE.LOGOUT_RESULT);break;case c.VOICE_EVENT_TYPE.CALL_STARTED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,n,c.VOICE_EVENT_TYPE.CALL_STARTED);break;case c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,n,c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED);break;case c.VOICE_EVENT_TYPE.CALL_CONNECTED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,n,c.VOICE_EVENT_TYPE.CALL_CONNECTED);break;case c.VOICE_EVENT_TYPE.HANGUP:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_END_THE_CALL,n,c.VOICE_EVENT_TYPE.HANGUP);break;case c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED:Gt(mt(n)===c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT?c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT:c.VOICE_ERROR_TYPE.CAN_NOT_ADD_PARTICIPANT,n,c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED);break;case c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_CONNECT_PARTICIPANT,n,c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED);break;case c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_HANGUP_PARTICIPANT,n,c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED);break;case c.VOICE_EVENT_TYPE.MUTE_TOGGLE:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_MUTE,n,c.VOICE_EVENT_TYPE.MUTE_TOGGLE);break;case c.VOICE_EVENT_TYPE.HOLD_TOGGLE:Gt(mt(n)===c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT?c.VOICE_ERROR_TYPE.INVALID_PARTICIPANT:c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_HOLD,n,c.VOICE_EVENT_TYPE.HOLD_TOGGLE);break;case c.VOICE_EVENT_TYPE.RECORDING_TOGGLE:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_RECORD,n,c.VOICE_EVENT_TYPE.RECORDING_TOGGLE);break;case c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_SWAP_PARTICIPANTS,n,c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED);break;case c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_CONFERENCE,n,c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED);break;case c.VOICE_EVENT_TYPE.AGENT_ERROR:Gt(c.VOICE_ERROR_TYPE.AGENT_ERROR,n,c.VOICE_EVENT_TYPE.AGENT_ERROR);break;case c.VOICE_EVENT_TYPE.SOFTPHONE_ERROR:switch(mt(n)){case c.VOICE_ERROR_TYPE.UNSUPPORTED_BROWSER:case c.VOICE_ERROR_TYPE.MICROPHONE_NOT_SHARED:case c.VOICE_ERROR_TYPE.USER_BUSY_ERROR:case c.VOICE_ERROR_TYPE.WEBRTC_ERROR:Gt(mt(n),n,c.VOICE_EVENT_TYPE.SOFTPHONE_ERROR);break;default:Gt(c.SHARED_ERROR_TYPE.GENERIC_ERROR,n,c.VOICE_EVENT_TYPE.SOFTPHONE_ERROR)}break;case c.VOICE_EVENT_TYPE.CALL_UPDATED:Gt(c.VOICE_ERROR_TYPE.CAN_NOT_UPDATE_CALL,n,c.VOICE_EVENT_TYPE.CALL_UPDATED);break;default:console.error("Unhandled error scenario with arguments ",arguments)}}function Qt(t){return $t.apply(this,arguments)}function $t(){return($t=i(l().mark((function t(e){var n,a,s,r,i,o,E,T,u,C,h,_,d,p,A,N,I,O,S,R,f,P,g,v,L,b,m,D,G,U,k,Y,x,B,F,j,W,J,Q,Z,tt,et,at;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.eventType,a=e.payload,s=e.registerLog,r=void 0===s||s,t.t0=n,t.next=t.t0===c.SHARED_EVENT_TYPE.LOGIN_RESULT?4:t.t0===c.SHARED_EVENT_TYPE.LOGOUT_RESULT?6:t.t0===c.VOICE_EVENT_TYPE.CALL_STARTED?8:t.t0===c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED?10:t.t0===c.VOICE_EVENT_TYPE.CALL_CONNECTED?12:t.t0===c.VOICE_EVENT_TYPE.HANGUP?28:t.t0===c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED?30:t.t0===c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED?32:t.t0===c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED?34:t.t0===c.SHARED_EVENT_TYPE.MESSAGE?44:t.t0===c.VOICE_EVENT_TYPE.AFTER_CALL_WORK_STARTED?46:t.t0===c.VOICE_EVENT_TYPE.WRAP_UP_ENDED?48:t.t0===c.SHARED_EVENT_TYPE.REMOTE_CONTROLLER?50:t.t0===c.VOICE_EVENT_TYPE.MUTE_TOGGLE?52:t.t0===c.VOICE_EVENT_TYPE.HOLD_TOGGLE?54:t.t0===c.VOICE_EVENT_TYPE.RECORDING_TOGGLE?57:t.t0===c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED?60:t.t0===c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED?62:t.t0===c.VOICE_EVENT_TYPE.CALL_UPDATED?64:t.t0===c.VOICE_EVENT_TYPE.UPDATE_AUDIO_STATS?66:t.t0===c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN?68:t.t0===c.VOICE_EVENT_TYPE.CALL_BARGED_IN?70:t.t0===c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED?72:t.t0===c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED?74:t.t0===c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP?76:t.t0===c.SHARED_EVENT_TYPE.SET_AGENT_STATUS?78:t.t0===c.VOICE_EVENT_TYPE.SHOW_TRANSFER_VIEW?80:t.t0===c.SHARED_EVENT_TYPE.STORAGE_ACCESS_RESULT?82:t.t0===c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_STARTED?84:t.t0===c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_ENDED?86:t.t0===c.SHARED_EVENT_TYPE.GET_AGENT_STATUS?88:t.t0===c.SHARED_EVENT_TYPE.STATE_CHANGE?90:92;break;case 4:return Wt(a,nt,c.SHARED_ERROR_TYPE.CAN_NOT_LOG_IN,c.SHARED_EVENT_TYPE.LOGIN_RESULT)&&(wt(c.SHARED_EVENT_TYPE.LOGIN_RESULT,a,r),a.success&&Yt()),t.abrupt("break",92);case 6:return Wt(a,rt,c.SHARED_ERROR_TYPE.CAN_NOT_LOG_OUT,c.SHARED_EVENT_TYPE.LOGOUT_RESULT)&&wt(c.SHARED_EVENT_TYPE.LOGOUT_RESULT,{success:a.success,loginFrameHeight:a.loginFrameHeight},r),t.abrupt("break",92);case 8:return Wt(a,$,c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,c.VOICE_EVENT_TYPE.CALL_STARTED)&&wt(c.VOICE_EVENT_TYPE.CALL_STARTED,a.call,!0),t.abrupt("break",92);case 10:return Wt(a,$,c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED)&&wt(c.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED,a.call,!0),t.abrupt("break",92);case 12:if(!Wt(a,$,c.VOICE_ERROR_TYPE.CAN_NOT_START_THE_CALL,c.VOICE_EVENT_TYPE.CALL_CONNECTED)){t.next=27;break}if(bt(),!w){t.next=26;break}return t.next=17,V.getTelephonyConnector();case 17:return i=t.sent,t.next=20,i.supervisorDisconnect();case 20:return o=t.sent,ut.validateClassObject(o,St),w=!1,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,o,!0),wt(c.VOICE_EVENT_TYPE.CALL_CONNECTED,a.call,!0),t.abrupt("break",92);case 26:wt(c.VOICE_EVENT_TYPE.CALL_CONNECTED,a.call,!0);case 27:return t.abrupt("break",92);case 28:return Wt(a,X,c.VOICE_ERROR_TYPE.CAN_NOT_END_THE_CALL,c.VOICE_EVENT_TYPE.HANGUP)&&wt(c.VOICE_EVENT_TYPE.HANGUP,a.calls,!0),t.abrupt("break",92);case 30:return Wt(a,q,c.VOICE_ERROR_TYPE.CAN_NOT_ADD_PARTICIPANT,c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED)&&(E=a.contact,T=a.initialCallHasEnded,u=a.callInfo,C=a.callAttributes,h=a.phoneNumber,_=a.callId,d=a.connectionId,wt(c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED,{contact:E,initialCallHasEnded:T,callInfo:u,callAttributes:C,phoneNumber:h,callId:_,connectionId:d},!0)),t.abrupt("break",92);case 32:return Wt(a,q,c.VOICE_ERROR_TYPE.CAN_NOT_CONNECT_PARTICIPANT,c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED)&&(p=a.initialCallHasEnded,A=a.callInfo,N=a.callAttributes,I=a.phoneNumber,O=a.callId,S=a.contact,R=a.connectionId,wt(c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,{initialCallHasEnded:p,callInfo:A,callAttributes:N,phoneNumber:I,callId:O,contact:S,connectionId:R},!0)),t.abrupt("break",92);case 34:if(!Wt(a,$,c.VOICE_ERROR_TYPE.CAN_NOT_HANGUP_PARTICIPANT,c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED)){t.next=43;break}return f=a.call,t.next=38,V.getTelephonyConnector();case 38:return P=t.sent,t.next=41,P.getActiveCalls();case 41:Wt(g=t.sent,M)&&(0===(v=g.activeCalls).length?wt(c.VOICE_EVENT_TYPE.HANGUP,f,!0):f&&f.callAttributes&&f.callType!==c.CALL_TYPE.CONSULT&&f.callAttributes.participantType===c.PARTICIPANT_TYPE.INITIAL_CALLER?wt(Object.values(v).filter((function(t){return t.callType===c.CALL_TYPE.ADD_PARTICIPANT})).pop().state===c.CALL_STATE.TRANSFERRING?c.VOICE_EVENT_TYPE.PARTICIPANT_ADDED:c.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,{initialCallHasEnded:!0},!0):wt(c.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,{callId:f?f.callId:null,connectionId:f?f.connectionId:null,reason:f?f.reason:null},!0));case 43:return t.abrupt("break",92);case 44:return wt(c.SHARED_EVENT_TYPE.MESSAGE,a,r),t.abrupt("break",92);case 46:return wt(c.VOICE_EVENT_TYPE.AFTER_CALL_WORK_STARTED,a,r),t.abrupt("break",92);case 48:return wt(c.VOICE_EVENT_TYPE.WRAP_UP_ENDED,a,r),t.abrupt("break",92);case 50:return Mt(a),t.abrupt("break",92);case 52:return Wt(a,H,c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_MUTE,c.VOICE_EVENT_TYPE.MUTE_TOGGLE)&&wt(c.VOICE_EVENT_TYPE.MUTE_TOGGLE,a,r),t.abrupt("break",92);case 54:return L=a.isThirdPartyOnHold,b=a.isCustomerOnHold,m=a.calls,Wt(a,z,c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_HOLD,c.VOICE_EVENT_TYPE.HOLD_TOGGLE)&&wt(c.VOICE_EVENT_TYPE.HOLD_TOGGLE,{isThirdPartyOnHold:L,isCustomerOnHold:b,calls:m},r),t.abrupt("break",92);case 57:return D=a.isRecordingPaused,G=a.contactId,U=a.initialContactId,k=a.instanceId,Y=a.region,Wt(a,K,c.VOICE_ERROR_TYPE.CAN_NOT_TOGGLE_RECORD,c.VOICE_EVENT_TYPE.RECORDING_TOGGLE)&&wt(c.VOICE_EVENT_TYPE.RECORDING_TOGGLE,{isRecordingPaused:D,contactId:G,initialContactId:U,instanceId:k,region:Y},r),t.abrupt("break",92);case 60:return Wt(a,z,c.VOICE_ERROR_TYPE.CAN_NOT_SWAP_PARTICIPANTS,c.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED)&&(x=a.isThirdPartyOnHold,B=a.isCustomerOnHold,F=a.calls,wt(c.VOICE_EVENT_TYPE.HOLD_TOGGLE,{isThirdPartyOnHold:x,isCustomerOnHold:B,calls:F},!0)),t.abrupt("break",92);case 62:return Wt(a,z,c.VOICE_ERROR_TYPE.CAN_NOT_CONFERENCE,c.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED)&&(j=a.isThirdPartyOnHold,W=a.isCustomerOnHold,J=a.calls,Q=a.isCallMerged,wt(c.VOICE_EVENT_TYPE.HOLD_TOGGLE,{isThirdPartyOnHold:j,isCustomerOnHold:W,isCallMerged:Q,calls:J},!0)),t.abrupt("break",92);case 64:return Wt(a,$,c.VOICE_ERROR_TYPE.CAN_NOT_UPDATE_CALL,c.VOICE_EVENT_TYPE.CALL_UPDATED)&&wt(c.VOICE_EVENT_TYPE.CALL_UPDATED,a,r),t.abrupt("break",92);case 66:return Wt(a,At)&&(a.stats&&(l=a.stats,y&&l.forEach((function(t){t.inputChannelStats&&(y.inputChannelStats.statsCount++,y.inputChannelStats.packetsCount+=0|t.inputChannelStats.packetsCount,y.inputChannelStats.packetsLost+=0|t.inputChannelStats.packetsLost,y.inputChannelStats.jitterBufferMillis+=0|t.inputChannelStats.jitterBufferMillis,y.inputChannelStats.roundTripTimeMillis+=0|t.inputChannelStats.roundTripTimeMillis),t.outputChannelStats&&(y.outputChannelStats.statsCount++,y.outputChannelStats.packetsCount+=0|t.outputChannelStats.packetsCount,y.outputChannelStats.packetsLost+=0|t.outputChannelStats.packetsLost,y.outputChannelStats.jitterBufferMillis+=0|t.outputChannelStats.jitterBufferMillis,y.outputChannelStats.roundTripTimeMillis+=0|t.outputChannelStats.roundTripTimeMillis)})),Z=a.callId?{stats:a.stats,callId:a.callId}:{stats:a.stats},wt(c.VOICE_EVENT_TYPE.AUDIO_STATS,{audioStats:Z},r)),a.isAudioStatsCompleted&&a.callId&&(tt=a.callId,et=Lt(),wt(c.VOICE_EVENT_TYPE.UPDATE_AUDIO_STATS_COMPLETED,{callId:tt,mos:et},r))),t.abrupt("break",92);case 68:return Wt(a,Ot,c.VOICE_ERROR_TYPE.CAN_NOT_BARGE_IN_SUPERVISOR,c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN)&&wt(c.VOICE_EVENT_TYPE.SUPERVISOR_BARGED_IN,a.call,!0),t.abrupt("break",92);case 70:return Wt(a,pt,c.SHARED_ERROR_TYPE.GENERIC_ERROR,c.VOICE_EVENT_TYPE.CALL_BARGED_IN)&&wt(c.VOICE_EVENT_TYPE.CALL_BARGED_IN,a,!0),t.abrupt("break",92);case 72:return Wt(a,Ot,c.VOICE_ERROR_TYPE.CAN_NOT_SUPERVISE_CALL,c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED)&&(w=!0,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_STARTED,a.call,!0)),t.abrupt("break",92);case 74:return Wt(a,Ot,c.VOICE_ERROR_TYPE.CAN_NOT_SUPERVISE_CALL,c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED)&&(w=!0,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED,a.call,!0)),t.abrupt("break",92);case 76:return Wt(a,St,c.VOICE_ERROR_TYPE.CAN_NOT_DISCONNECT_SUPERVISOR,c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP)&&(w=!1,wt(c.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,a.calls,!0)),t.abrupt("break",92);case 78:return Wt(a,ht,c.SHARED_ERROR_TYPE.CAN_NOT_SET_AGENT_STATUS,c.SHARED_EVENT_TYPE.SET_AGENT_STATUS)&&(at=a.statusId,wt(c.SHARED_EVENT_TYPE.SET_AGENT_STATUS,{statusId:at},r)),t.abrupt("break",92);case 80:return wt(c.VOICE_EVENT_TYPE.SHOW_TRANSFER_VIEW,a),t.abrupt("break",92);case 82:return Wt(a,Rt,c.SHARED_ERROR_TYPE.INVALID_STORAGE_ACCESS_RESULT,c.SHARED_EVENT_TYPE.STORAGE_ACCESS_RESULT)&&(wt(c.SHARED_EVENT_TYPE.STORAGE_ACCESS_RESULT,a),a.success&&(a.showLogin?wt(c.SHARED_EVENT_TYPE.SHOW_LOGIN,{loginFrameHeight:a.loginFrameHeight},r):Yt())),t.abrupt("break",92);case 84:return Wt(a,Pt,c.SHARED_ERROR_TYPE.INVALID_ACW_INFO,c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_STARTED)&&wt(c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_STARTED,a,r),t.abrupt("break",92);case 86:return Wt(a,Pt,c.SHARED_ERROR_TYPE.INVALID_ACW_INFO,c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_ENDED)&&wt(c.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_ENDED,a,r),t.abrupt("break",92);case 88:return Wt(a,_t,c.SHARED_ERROR_TYPE.CAN_NOT_GET_AGENT_STATUS,c.SHARED_EVENT_TYPE.GET_AGENT_STATUS)&&wt(c.SHARED_EVENT_TYPE.GET_AGENT_STATUS,a,r),t.abrupt("break",92);case 90:return Wt(a,dt,c.SHARED_ERROR_TYPE.INVALID_STATE_CHANGE_RESULT,c.SHARED_EVENT_TYPE.STATE_CHANGE)&&wt(c.SHARED_EVENT_TYPE.STATE_CHANGE,a),t.abrupt("break",92);case 92:case"end":return t.stop()}var l}),t)})))).apply(this,arguments)}})(),a})(),t.exports=e()},6930:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;const a=n(2785);function s(t,e){if(!t)return t;if(a.isBinary(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let a=0;a<t.length;a++)n[a]=s(t[a],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const a in t)t.hasOwnProperty(a)&&(n[a]=s(t[a],e));return n}return t}function r(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=r(t[n],e);else if("object"==typeof t)for(const n in t)t.hasOwnProperty(n)&&(t[n]=r(t[n],e));return t}e.deconstructPacket=function(t){const e=[],n=t.data,a=t;return a.data=s(n,e),a.attachments=e.length,{packet:a,buffers:e}},e.reconstructPacket=function(t,e){return t.data=r(t.data,e),t.attachments=void 0,t}},7519:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;const a=n(5971),s=n(6930),r=n(2785),i=n(7833)("socket.io-parser");var o;e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(o=e.PacketType||(e.PacketType={})),e.Encoder=class{encode(t){return i("encoding packet %j",t),t.type!==o.EVENT&&t.type!==o.ACK||!r.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===o.EVENT?o.BINARY_EVENT:o.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==o.BINARY_EVENT&&t.type!==o.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),i("encoded %j as %s",t,e),e}encodeAsBinary(t){const e=s.deconstructPacket(t),n=this.encodeAsString(e.packet),a=e.buffers;return a.unshift(n),a}};class l extends a{constructor(){super()}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===o.BINARY_EVENT||e.type===o.BINARY_ACK?(this.reconstructor=new c(e),0===e.attachments&&super.emit("decoded",e)):super.emit("decoded",e)}else{if(!r.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emit("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===o[n.type])throw new Error("unknown packet type "+n.type);if(n.type===o.BINARY_EVENT||n.type===o.BINARY_ACK){const a=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const s=t.substring(a,e);if(s!=Number(s)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(s)}if("/"===t.charAt(e+1)){const a=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(a,e)}else n.nsp="/";const a=t.charAt(e+1);if(""!==a&&Number(a)==a){const a=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(a,e+1))}if(t.charAt(++e)){const a=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!l.isPayloadValid(n.type,a))throw new Error("invalid payload");n.data=a}return i("decoded %s as %j",t,n),n}static isPayloadValid(t,e){switch(t){case o.CONNECT:return"object"==typeof e;case o.DISCONNECT:return void 0===e;case o.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case o.EVENT:case o.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case o.ACK:case o.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}e.Decoder=l;class c{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},2785:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;const n="function"==typeof ArrayBuffer,a=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),r="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);function i(t){return n&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||s&&t instanceof Blob||r&&t instanceof File}e.isBinary=i,e.hasBinary=function t(e,n){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let n=0,a=e.length;n<a;n++)if(t(e[n]))return!0;return!1}if(i(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return!0;return!1}},2121:t=>{"use strict";var e,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,s={},r=0,i=0;function o(t){var e="";do{e=n[t%a]+e,t=Math.floor(t/a)}while(t>0);return e}function l(){var t=o(+new Date);return t!==e?(r=0,e=t):t+"."+o(r++)}for(;i<a;i++)s[n[i]]=i;l.encode=o,l.decode=function(t){var e=0;for(i=0;i<t.length;i++)e=e*a+s[t.charAt(i)];return e},t.exports=l},7230:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.io=e.Socket=e.Manager=e.protocol=void 0;const a=n(9543),s=n(2081),r=n(7833)("socket.io-client");t.exports=e=o;const i=e.managers={};function o(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};const n=(0,a.url)(t,e.path||"/socket.io"),o=n.source,l=n.id,c=n.path,E=i[l]&&c in i[l].nsps;let T;return e.forceNew||e["force new connection"]||!1===e.multiplex||E?(r("ignoring socket cache for %s",o),T=new s.Manager(o,e)):(i[l]||(r("new io instance for %s",o),i[l]=new s.Manager(o,e)),T=i[l]),n.query&&!e.query&&(e.query=n.queryKey),T.socket(n.path,e)}e.io=o;var l=n(7519);Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return l.protocol}}),e.connect=o;var c=n(2081);Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return c.Manager}});var E=n(9521);Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return E.Socket}}),e.default=o},2081:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;const a=n(3357),s=n(9773),r=n(9521),i=n(7519),o=n(9221),l=n(3059),c=n(6278),E=n(7833)("socket.io-client:manager");class T extends c.StrictEventEmitter{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,(0,s.installTimerFunctions)(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const a=e.parser||i;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(E("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;E("opening %s",this.uri),this.engine=a(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=(0,o.on)(e,"open",(function(){n.onopen(),t&&t()})),r=(0,o.on)(e,"error",(e=>{E("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;E("connect attempt will timeout after %d",t),0===t&&s();const n=this.setTimeoutFn((()=>{E("connect attempt timed out after %d",t),s(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(s),this.subs.push(r),this}connect(t){return this.open(t)}onopen(){E("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push((0,o.on)(t,"ping",this.onping.bind(this)),(0,o.on)(t,"data",this.ondata.bind(this)),(0,o.on)(t,"error",this.onerror.bind(this)),(0,o.on)(t,"close",this.onclose.bind(this)),(0,o.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){E("error",t),this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new r.Socket(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return void E("socket %s is still active, skipping close",t);this._close()}_packet(t){E("writing packet %j",t);const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){E("cleanup"),this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){E("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t){E("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)E("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();E("will wait %dms before reconnect attempt",e),this._reconnecting=!0;const n=this.setTimeoutFn((()=>{t.skipReconnect||(E("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(E("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):(E("reconnect success"),t.onreconnect())})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}e.Manager=T},9221:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,n){return t.on(e,n),function(){t.off(e,n)}}},9521:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;const a=n(7519),s=n(9221),r=n(6278),i=n(7833)("socket.io-client:socket"),o=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class l extends r.StrictEventEmitter{constructor(t,e,n){super(),this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const t=this.io;this.subs=[(0,s.on)(t,"open",this.onopen.bind(this)),(0,s.on)(t,"packet",this.onpacket.bind(this)),(0,s.on)(t,"error",this.onerror.bind(this)),(0,s.on)(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(o.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:a.PacketType.EVENT,data:e,options:{}};n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(i("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++);const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return!this.flags.volatile||s&&this.connected?this.connected?this.packet(n):this.sendBuffer.push(n):i("discard packet as the transport is not currently writable"),this.flags={},this}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){i("transport is open - connecting"),"function"==typeof this.auth?this.auth((t=>{this.packet({type:a.PacketType.CONNECT,data:t})})):this.packet({type:a.PacketType.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t){i("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case a.PacketType.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case a.PacketType.EVENT:case a.PacketType.BINARY_EVENT:this.onevent(t);break;case a.PacketType.ACK:case a.PacketType.BINARY_ACK:this.onack(t);break;case a.PacketType.DISCONNECT:this.ondisconnect();break;case a.PacketType.CONNECT_ERROR:const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];i("emitting event %j",e),null!=t.id&&(i("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...s){n||(n=!0,i("sending ack %j",s),e.packet({type:a.PacketType.ACK,id:t,data:s}))}}onack(t){const e=this.acks[t.id];"function"==typeof e?(i("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):i("bad ack %s",t.id)}onconnect(t){i("socket connected with id %s",t),this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>this.packet(t))),this.sendBuffer=[]}ondisconnect(){i("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(i("performing disconnect (%s)",this.nsp),this.packet({type:a.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}e.Socket=l},6278:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StrictEventEmitter=void 0;const a=n(5971);e.StrictEventEmitter=class extends a{on(t,e){return super.on(t,e),this}once(t,e){return super.once(t,e),this}emit(t,...e){return super.emit(t,...e),this}emitReserved(t,...e){return super.emit(t,...e),this}listeners(t){return super.listeners(t)}}},9543:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;const a=n(4258),s=n(7833)("socket.io-client:url");e.url=function(t,e="",n){let r=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(s("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),s("parse %s",t),r=a(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,n),r.exports}(()=>{"use strict";var t=n(4252),e=n(7230);e.Manager,e.Socket;const a={LOGIN_SUBMIT:"LOGIN_SUBMIT",SHOW_LOGIN_PAGE:"SHOW_LOGIN_PAGE",GET_SHOW_LOGIN_PAGE:"GET_SHOW_LOGIN_PAGE",SET_SHOW_LOGIN_PAGE:"SET_SHOW_LOGIN_PAGE",AGENT_CONFIG:"AGENT_CONFIG",AGENT_WORK_EVENT:"AGENT_WORK_EVENT",CAPABILITIES:"CAPABILITIES",GET_AGENT_CONFIG:"GET_AGENT_CONFIG",SET_AGENT_CONFIG:"SET_AGENT_CONFIG",GET_CAPABILITIES:"GET_CAPABILITIES",SET_CAPABILITIES:"SET_CAPABILITIES",SET_CONTACT_TYPES:"SET_CONTACT_TYPES",START_OUTBOUND_CALL:"START_OUTBOUND_CALL",START_INBOUND_CALL:"START_INBOUND_CALL",CONNECT_PARTICIPANT:"CONNECT_PARTICIPANT",REMOVE_PARTICIPANT:"REMOVE_PARTICIPANT",REMOVE_SUPERVISOR:"REMOVE_SUPERVISOR",CONNECT_SUPERVISOR:"CONNECT_SUPERVISOR",CONNECT_CALL:"CONNECT_CALL",AGENT_HANGUP:"AGENT_HANGUP",END_CALL:"END_CALL",CONSULT:"CONSULT",HARDPHONE_EVENT:"HARDPHONE_EVENT",SET_AGENT_STATUS:"SET_AGENT_STATUS",GET_PHONE_CONTACTS:"GET_PHONE_CONTACTS",GET_ACTIVE_CALLS:"GET_ACTIVE_CALLS",CALL_INFO_UPDATED:"CALL_INFO_UPDATED",ACTIVE_CALLS:"ACTIVE_CALLS",SOFTPHONE_LOGOUT:"SOFTPHONE_LOGOUT",CREATE_TRANSCRIPTION:"SEND_TRANSCRIPTION",INBOUND_CALL_TYPE:"inbound",MESSAGE_FROM_CONNECTOR:"MESSAGE_FROM_CONNECTOR",MESSAGE_TO_CONNECTOR:"MESSAGE_TO_CONNECTOR",SENDER_TYPE:{END_USER:"END_USER",HUMAN_AGENT:"HUMAN_AGENT",VIRTUAL_AGENT:"VIRTUAL_AGENT",SUPERVISOR:"SUPERVISOR",EXTERNAL_USER:"EXTERNAL_USER"},PARTICIPANT_TYPE:{...t.Constants.PARTICIPANT_TYPE},CALL_TYPE:{...t.Constants.CALL_TYPE},CALL_CONTROL:{ACCEPT_CALL:"ACCEPT_CALL",DECLINE_CALL:"DECLINE_CALL",MUTE:"MUTE",HOLD:"HOLD",SWAP_PARTICIPANTS:"SWAP_PARTICIPANTS",ADD_PARTICIPANT:"ADD_PARTICIPANT",CONFERENCE:"CONFERENCE",RECORD:"RECORD"},HANGUP_REASON:{PHONE_CALL_ERROR:"error",PHONE_CALL_ENDED:"ended"},SEND_RECORDING:"SEND_RECORDING",SEND_VOICE_MAIL:"SEND_VOICE_MAIL",SEND_REALTIME_CONVERSATION_EVENTS:"SEND_REALTIME_CONVERSATION_EVENTS",LOGIN_RESULT:"LOGIN_RESULT",LOGOUT_RESULT:"LOGOUT_RESULT",CALL_CONNECTED:"CALL_CONNECTED",THROW_ERROR:"THROW_ERROR",CUSTOM_ERROR:"CUSTOM_ERROR",ERROR:"ERROR",PARTICIPANT_CONNECTED:"PARTICIPANT_CONNECTED",PARTICIPANT_REMOVED:"PARTICIPANT_REMOVED",MESSAGE:"MESSAGE",REMOTE_CONTROLLER:"REMOTE_CONTROLLER",SHARED_EVENT_TYPE:{...t.Constants.SHARED_EVENT_TYPE},VOICE_EVENT_TYPE:t.Constants.VOICE_EVENT_TYPE,AGENT_ERROR_STATUS:{DECLINED_BY_AGENT:"DeclinedByAgent",FAILED_TO_CONNECT_AGENT:"FailedToConnectAgent",MISSED_BY_AGENT:"MissedByAgent"},REQUEST_CALLBACK:"REQUEST_CALLBACK",PUSH_DIALER:"PUSH_DIALER",PROGRESSIVE_DIALER:"PROGRESSIVE_DIALER",CTR_SYNC:"CTR_SYNC",CTR_SYNC_RESULT:"CTR_SYNC_RESULT",SEND_AUDIO_STATS:"SEND_AUDIO_STATS",CONTACT_TYPE:{...t.Constants.CONTACT_TYPE},CALL_UPDATED:"CALL_UPDATED"},s="CALL_STARTED",r="INTERNAL_CALL_STARTED",i="PARTICIPANT_CONNECTED",o="CALL_BARGED_IN",l="CALL_DESTROYED",c="MUTE",E="UNMUTE",T="MERGE",u={[t.Constants.CONTACTS_FILTER_TYPES.AGENT]:t.Constants.CONTACT_TYPE.AGENT,[t.Constants.CONTACTS_FILTER_TYPES.CONTACT]:t.Constants.CONTACT_TYPE.PHONENUMBER,[t.Constants.CONTACTS_FILTER_TYPES.DIRECTORY]:t.Constants.CONTACT_TYPE.PHONEBOOK,[t.Constants.CONTACTS_FILTER_TYPES.QUEUE]:t.Constants.CONTACT_TYPE.QUEUE};var C=n(7007);class h{parseInputReport(t,e){throw new Error("This method should be overridden by subclasses.")}}let _=[],d=!1,p=null,A=null;class N extends h{async parseInputReport(t,e){const{data:n}=t,a=n.getUint8(0),s=await e.getActiveCalls();0!==s.activeCalls.length&&(p=s.activeCalls[0],A=p.callInfo,A.isHIDCall=!0,1===a||3===a?(d=!0,_=[a]):2!==a&&0!==a||(d&&1===_.length?(await this.performAction("muteToggle",e),_=[],d=!1):await this.performAction("acceptOrHangupCall",e)))}async performAction(e,n){switch(e){case"muteToggle":if(A.isMuted){const e=await n.unmute(p);n.log("unmute call triggered using HID: ",p),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.MUTE_TOGGLE,payload:e})}else{const e=await n.mute(p);n.log("mute call triggered using HID: ",p),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.MUTE_TOGGLE,payload:e})}break;case"acceptOrHangupCall":p.state===t.Constants.CALL_STATE.RINGING&&"inbound"===p.callType?(n.log("answer call triggered using HID: ",p),n.connectCall(A)):(n.log("hangup call triggered using HID: ",p),n.hangup(t.Constants.HANGUP_REASON.PHONE_CALL_ENDED))}}}let I=[1,0,1,0],O=[],S=null,R=null;class f extends h{async parseInputReport(t,e){const{data:n}=t,a=n.getUint8(0),s=await e.getActiveCalls();0!==s.activeCalls.length&&(S=s.activeCalls[0],R=S.callInfo,R.isHIDCall=!0,O.push(a),this.compareAcceptHangupCalbuffer(O)&&(O=[],await this.performAction("acceptOrHangupCall",e)))}async performAction(e,n){"acceptOrHangupCall"===e&&(S.state===t.Constants.CALL_STATE.RINGING&&"inbound"===S.callType?(n.log("answer call triggered using HID: ",S),n.connectCall(R)):(n.log("hangup call triggered using HID: ",S),n.hangup(t.Constants.HANGUP_REASON.PHONE_CALL_ENDED)))}compareAcceptHangupCalbuffer(t){return 4===t.length&&t.every(((t,e)=>t===I[e]))}}class P extends t.PhoneCall{constructor(e,n,a,s,r){const i=t.Constants.CALL_STATE.RINGING;a.initialCallHasEnded=!1,a.isOnHold=s&&s.isOnHold,r=r||Math.random().toString(36).substring(7),a.participantType===t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER&&(s.parentCallId=r),super({callId:r,callType:e,contact:n,state:i,callAttributes:a,phoneNumber:n&&n.phoneNumber,callInfo:s})}set parentCallId(t){this.callInfo.parentCallId=t}}class g{constructor(){this.userId,this.scrtUrl,this.orgId,this.instanceUrl,this.authorizationContext,this.customPlatformEvent,this.customEventPayloadField,this.customEventTypeField,this.routingOwner,this.channelAddressIdentifier}}class v extends C.EventEmitter{}const L=new v;class b{constructor(e={isLoginRequired:!0,agentConfig:JSON.parse(localStorage.getItem("agentConfig"))||{phones:["SOFT_PHONE","DESK_PHONE"],selectedPhone:{type:"SOFT_PHONE"}},updateRemoveTransferCallParticipantVariant:t.Constants.REMOVE_PARTICIPANT_VARIANT.ALWAYS,capabilities:JSON.parse(localStorage.getItem("capabilities"))||{hasMute:!0,hasRecord:!0,hasMerge:!0,hasSwap:!0,hasSignedRecordingUrl:!1,debugEnabled:!0,signedRecordingUrl:"",signedRecordingDuration:null,hasContactSearch:!0,hasAgentAvailability:!0,hasQueueWaitTime:!0,supportsMos:!1,hasSupervisorListenIn:!0,hasSupervisorBargeIn:!0,hasBlindTransfer:!0,hasTransferToOmniFlow:!0,hasPendingStatusChange:!0,hasPhoneBook:!1,canConsult:!0,isDialPadDisabled:!1,isPhoneBookDisabled:!1,isHidSupported:!1,hasSetExternalMicrophoneDeviceSetting:!1,hasSetExternalSpeakerDeviceSetting:!1},agentId:null,userFullName:null,activeCalls:this.getActiveCallsObj(),destroyedCalls:[],agentStatus:"Available",publishHardphoneErrors:!0,agentAvailable:!1,messagingContacts:this.getAllMessagingContacts(20),phoneContacts:this.getAllPhoneContacts(20),onlineUsers:[],activeConferenceCalls:[],callInfoObj:{},userFullNames:{},userPresenceStatuses:null,isMultipartyAllowed:null,isConsultAllowed:null,contactCenterChannels:null,delayMs:0,contactTypes:JSON.parse(localStorage.getItem("contactTypes"))||[t.Constants.CONTACT_TYPE.AGENT,t.Constants.CONTACT_TYPE.QUEUE,t.Constants.CONTACT_TYPE.PHONEBOOK,t.Constants.CONTACT_TYPE.PHONENUMBER],contactCenterAdditionalSettings:new g,flowConfig:null}){this.state={...e,showLoginPage:!!JSON.parse(localStorage.getItem("showLoginPage")),throwError:!!JSON.parse(localStorage.getItem("throwError"))},this.eventEmitter=L}getCall(t){if(!this.hasActiveCalls())throw new Error("Couldn't find an active call",t);if(t.callId){const e=this.state.activeCalls[t.callId];if(!e)throw new Error("Couldn't find an active call for callId "+t.callId);return e}if(t.callAttributes&&t.callAttributes.isConsultCall){const e=Object.values(this.state.activeCalls).filter((t=>!0===t.callAttributes.isConsultCall)).pop();if(!e)throw new Error("Couldn't find an active consult call "+t.callAttributes.participantType);return e}if(t.callAttributes&&t.callAttributes.participantType){const e=Object.values(this.state.activeCalls).filter((e=>e.callAttributes.participantType===t.callAttributes.participantType)).shift();if(!e)throw new Error("Couldn't find an active call for participant "+t.callAttributes.participantType);return e}if(t.contact&&t.contact.id){return Object.values(this.state.activeCalls).filter((e=>e.contact.id===t.contact.id)).pop()||null}if(t.callInfo&&t.callInfo.renderContactId){return Object.values(this.state.activeCalls).filter((e=>e.callInfo.renderContactId===t.callInfo.renderContactId)).pop()||null}throw new Error("Call is not defined or invalid.",t)}addCall(e){if(e instanceof P||e instanceof t.PhoneCall)this.state.activeCalls[e.callId]=e;else{let n=new t.PhoneCall({});Object.assign(n,{callId:e.callId,callType:e.callType,contact:e.contact,state:e.state,callAttributes:e.callAttributes,phoneNumber:e.contact&&e.contact.phoneNumber,callInfo:e.callInfo}),this.state.activeCalls[e.callId]=n}localStorage.setItem("activeCalls",JSON.stringify(this.state.activeCalls))}messageUser(t,n,a){const s=e(),r=this.state.agentId;s.emit("message",{fromUsername:r,toUsername:t,messageType:n,data:a})}toggleAgentPresence(t){const n=e(),a=this.state.agentId,s=this.state.userFullName,r=this.state.userId;n.emit("presence",{isAvailable:t,username:a,fullName:s,userId:r})}getPrimaryCall(){let e;try{e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}})}catch(n){try{e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}})}catch(t){try{e=this.getCall({callAttributes:{isConsultCall:!0}})}catch(t){return this.getActiveCallsList()[0]}}}return e}updateCallInfo(e,n){let a;try{a=this.getCall({...n||{},callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}})}catch(e){a=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}})}return Object.assign(a.callInfo,e),this.addCall(a),a}showLoginPage(t){localStorage.setItem("showLoginPage",t),this.state.showLoginPage=t}setAgentConfig(e){if(e)return e.selectedPhone&&Object.keys(e.selectedPhone).length>0&&(this.state.agentConfig.selectedPhone=e.selectedPhone),e.hidDeviceInfo&&Object.keys(e.hidDeviceInfo).length>0&&(this.state.agentConfig.hidDeviceInfo=e.hidDeviceInfo),localStorage.setItem("agentConfig",JSON.stringify(this.state.agentConfig)),void 0!==e.hidDeviceInfo&&async function(t,e){const n=await navigator.hid.getDevices();if(n&&n.length>0){const a=n.find((e=>e.vendorId===t?.hidDeviceInfo?.vendorId&&e.productId===t?.hidDeviceInfo?.productId));if(a){const t=function(t){switch(t.productName){case"Plantronics Blackwire 5220 Series":return new N;case"Jabra EVOLVE LINK MS":return new f;default:throw new Error("Unsupported HID device")}}(a);await a.open().then((()=>{a.oninputreport=n=>{t.parseInputReport(n,e)}}))}}}(e,this),this.executeAsync("setAgentConfig",new t.SetAgentConfigResult({success:!0}))}updateAgentConfig(t){this.state.agentConfig.selectedPhone=t.selectedPhone,localStorage.setItem("agentConfig",JSON.stringify(this.state.agentConfig))}setCapabilities(){return localStorage.setItem("capabilities",JSON.stringify(this.state.capabilities)),this.executeAsync("setCapabilities",new t.GenericResult({success:!0}))}updateCapabilities(t){this.state.capabilities.hasSignedRecordingUrl=t.hasSignedRecordingUrl,this.state.capabilities.signedRecordingUrl=t.signedRecordingUrl,this.state.capabilities.signedRecordingDuration=t.signedRecordingDuration,this.state.capabilities.hasMute=t.hasMute,this.state.capabilities.hasRecord=t.hasRecord,this.state.capabilities.hasSwap=t.hasSwap,this.state.capabilities.hasMerge=t.hasMerge,this.state.capabilities.hasContactSearch=t.hasContactSearch,this.state.capabilities.supportsMos=t.supportsMos,this.state.capabilities.hasAgentAvailability=t.hasAgentAvailability,this.state.capabilities.hasQueueWaitTime=t.hasQueueWaitTime,this.state.capabilities.hasSupervisorListenIn=t.hasSupervisorListenIn,this.state.capabilities.hasSupervisorBargeIn=t.hasSupervisorBargeIn,this.state.capabilities.hasBlindTransfer=t.hasBlindTransfer,this.state.capabilities.hasTransferToOmniFlow=t.hasTransferToOmniFlow,this.state.capabilities.debugEnabled=t.debugEnabled,this.state.capabilities.hasPendingStatusChange=t.hasPendingStatusChange,this.state.capabilities.hasPhoneBook=t.hasPhoneBook,this.state.capabilities.canConsult=t.canConsult,this.state.capabilities.isDialPadDisabled=t.isDialPadDisabled,this.state.capabilities.isPhoneBookDisabled=t.isPhoneBookDisabled,this.state.capabilities.isHidSupported=t.isHidSupported,this.state.capabilities.hasSetExternalMicrophoneDeviceSetting=t.hasSetExternalMicrophoneDeviceSetting,this.state.capabilities.hasSetExternalSpeakerDeviceSetting=t.hasSetExternalSpeakerDeviceSetting,localStorage.setItem("capabilities",JSON.stringify(this.state.capabilities))}updateContactTypes(t){this.state.contactTypes=t,localStorage.setItem("contactTypes",JSON.stringify(this.state.contactTypes))}throwError(t){localStorage.setItem("throwError",t),this.state.throwError=t}customErrorChanged(t){localStorage.setItem("customError",t),this.state.customError=t}subsystemLoginResult(e){this.state.agentAvailable=e,(0,t.publishEvent)({eventType:t.Constants.SHARED_EVENT_TYPE.LOGIN_RESULT,payload:new t.GenericResult({success:this.state.showLoginPage&&e})})}log(...e){if(this.state.capabilities.debugEnabled){const n=e.map((t=>"string"==typeof t?t:JSON.stringify(t))).join(" ");(0,t.log)({message:n},t.Constants.LOG_LEVEL.INFO)}else Function.apply.call(console.log,console,["[sdk]",...e])}filterContacts(t,e){if(!e)return t;let n=t;e.contains&&(n=n.filter((t=>Object.keys(t).some((n=>t[n]&&t[n].toLowerCase().includes(e.contains.toLowerCase())))))),(e.types||[e.type&&e.type.toUpperCase()]||0).forEach((t=>{const e=u[t]||t,a=u[t]?"type":"availability";n=n.filter((t=>t[a]===e))}));const a=e.offset?e.offset:0,s=e.limit?a+e.limit:n.length;return n.slice(a,s)}getActiveCallsList(){return Object.values(this.state.activeCalls)}getCallsToDestroy(e){let n=[];if(e.callAttributes&&e.callAttributes.participantType===t.Constants.PARTICIPANT_TYPE.AGENT){try{const e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}});n.push(e)}catch(t){}try{const e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}});n.push(e)}catch(t){}0===n.length&&n.push(this.getCall(e))}else n.push(this.getCall(e));return n}destroyCalls(t,e){let n=[];return this.state.isMultipartyAllowed?t.callId?n.push(t):n.push(this.getCall(t)):n=this.getCallsToDestroy(t),this.processCallsToDestroy(n,e)}processCallsToDestroy(e,n){return e.forEach((e=>{const a=t.Constants.CALL_STATE.ENDED;e.state=a,e.reason=n,!this.state.isMultipartyAllowed&&this.shouldMessageOtherUser(e)&&this.messageUser(null,l,{callId:e.callId,reason:n}),this.state.destroyedCalls.push(e),delete this.state.activeCalls[e.callId]})),localStorage.setItem("activeCalls",JSON.stringify(this.state.activeCalls)),this.state.agentAvailable=0===Object.keys(this.state.activeCalls).length,e}shouldMessageOtherUser(e){return e.callType===t.Constants.CALL_TYPE.INTERNAL_CALL.toLocaleLowerCase()}destroyCall(t,e){return this.destroyCalls(t,e).pop()}async init(n){const a=this.state.agentId=n.userName;if(this.state.userFullName=n.userFullName,this.state.userId=n.userId,this.state.userPresenceStatuses=n.userPresenceStatuses,this.state.contactCenterChannels=n.contactCenterChannels,this.state.isMultipartyAllowed=n.isSCVMultipartyAllowed,this.state.isConsultAllowed=n.isSCVMultipartyConsultAllowed,n.messagingChannel&&0!==n.messagingChannel.length&&!await this.fetchServer("/is-local-config","GET"))try{this.readCallCenterConfigAndSetState(n)}catch(t){return Promise.reject("Failed to configure tenant information")}const s=e();s.on("onlineUsers",(t=>{this.state.onlineUsers=t.users,this.state.userFullNames=new Map(JSON.parse(t.userNames))})),s.on("connect",(()=>{s.emit("join",{username:a,id:this.state.userId})})),s.on("message",(t=>{this.handleSocketMessage(t)}));const r={scrtBaseUrl:n.scrtUrl,orgId:n.organizationId,callCenterName:n["/reqGeneralInfo/reqInternalName"]};return fetch("/api/configureTenantInfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((t=>t.json())).then((e=>e.success?(this.toggleAgentPresence(!0),this.state.agentAvailable=!this.state.showLoginPage,this.executeAsync("ssoLogin",this.state.showLoginPage?new t.InitResult({showLogin:!0,loginFrameHeight:350}):new t.InitResult({}))):Promise.reject("Failed to configure tenant information")))}fetchServer(t,e,n){return fetch("/api/fetchServer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,method:e,endpoint:t})}).then((t=>t.json())).then((t=>t))}readCallCenterConfigAndSetState(t){this.fetchServer("/getsettings","GET").then((e=>{if(!e)return new Error("Couldn't fetch settings from /getsettings");{this.state.channelAddressIdentifier=e.channelAddressIdentifier,this.state.contactCenterAdditionalSettings.userId=t.userId,this.state.contactCenterAdditionalSettings.scrtUrl=t.scrtUrl,this.state.contactCenterAdditionalSettings.orgId=t.organizationId;let n=t.domain;this.state.contactCenterAdditionalSettings.instanceUrl=n,t.messagingChannel&&Object.keys(t.messagingChannel).forEach((e=>{let n=t.messagingChannel[e];if(n.ChannelAddressIdentifier===this.state.channelAddressIdentifier){let e=n.ChannelDefinitionId;Object.keys(t.conversationChannelDefinition).forEach((n=>{let a=t.conversationChannelDefinition[n];a.Id===e&&(this.state.contactCenterAdditionalSettings.authorizationContext=a.DeveloperName,this.state.contactCenterAdditionalSettings.customPlatformEvent=a.CustomPlatformEvent,this.state.contactCenterAdditionalSettings.customEventPayloadField=a.CustomEventPayloadField,this.state.contactCenterAdditionalSettings.customEventTypeField=a.CustomEventTypeField,this.state.contactCenterAdditionalSettings.routingOwner=a.RoutingOwner)}))}})),this.fetchContactCenterConfigToEnv()}}))}async fetchContactCenterConfigToEnv(){const t={authorizationContext:this.state.contactCenterAdditionalSettings.authorizationContext,userId:this.state.contactCenterAdditionalSettings.userId,userName:this.state.agentId,customEventPayloadField:this.state.contactCenterAdditionalSettings.customEventPayloadField,customPlatformEvent:this.state.contactCenterAdditionalSettings.customPlatformEvent,customEventTypeField:this.state.contactCenterAdditionalSettings.customEventTypeField,routingOwner:this.state.contactCenterAdditionalSettings.routingOwner,instanceUrl:this.state.contactCenterAdditionalSettings.instanceUrl,scrtUrl:this.state.contactCenterAdditionalSettings.scrtUrl,orgId:this.state.contactCenterAdditionalSettings.orgId};return await this.fetchServer("/setcallcenterconfig","POST",t).then((t=>{if(200!==t.status)return new Error("Couldn't fetch settings to /setcallcenterconfig");console.log(t)}))}handleSocketMessage(e){if(e.messageType)switch(e.messageType){case s:this.startTransferOrConsultCall(e);break;case r:this.startInternalCall(e);break;case i:e.fromUsername===this.state.agentId||this.isSupervisorListeningIn()||this.connectParticipant(e.data.callInfo,e.data.callType,e.data.call);break;case o:this.publishCallBargedInEventToAgents(e.data);break;case l:this.isSupervisorListeningIn()||this.processCallDestroyed(e.data);break;case c:e.fromUsername!==this.state.agentId&&this.processBroadcastMute(e.data,!0);break;case E:e.fromUsername!==this.state.agentId&&this.processBroadcastMute(e.data,!1);break;case T:if(!this.hasActiveCalls())return;if(e.fromUsername!==this.state.agentId&&e.data.consultCall&&!this.isSupervisorListeningIn()){let n;this.state.activeConferenceCalls=e.data.activeConferenceCalls;let a=this.getActiveCallsList();n=1===a.length&&this.hasConsultCall(a)?a[0]:this.getPrimaryCall();let s=this.state.activeConferenceCalls.find((({callId:t})=>t===n.callId));s&&(s.callAttributes.participantType=t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER,s.receiverContact=s.receiverContact||this.state.activeCalls[n.callId].receiverContact),e.data.consultCall.callId===n.callId&&(e.data.consultCall.callAttributes.participantType=t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER),e.data.consultCall.contact=new t.Contact({id:e.fromUsername}),e.data.consultCall.callInfo.renderContactId=e.fromUsername,this.mergeConsultCall(e.data.consultCall),this.updateConferenceUsers(!0)}break;default:this.log("Could not handle message "+e.messageType,e)}else e.data&&e.data.type&&this.eventEmitter.emit("event",e)}updateCallInfoObj(t){this.state.callInfoObj=t.data.callInfo,localStorage.setItem("callInfo",JSON.stringify(this.state.callInfoObj))}generateCallId(){return Math.random().toString(36).substring(7)}startTransferOrConsultCall(e){const n=e.data.isConsultCall;let a=e.data.flowConfig||{isUnifiedRoutingEnabled:!1};a.isTransferFlow=!0;const s=e.data.callInfo||{};s.callStateTimestamp=e.data.callInfo?.callStateTimestamp?new Date(e.data.callInfo.callStateTimestamp):new Date;const r=new t.PhoneCall({callType:n?t.Constants.CALL_TYPE.CONSULT:t.Constants.CALL_TYPE.TRANSFER,phoneNumber:e.data.phoneNumber,callId:e.data.callId||this.generateCallId(),callAttributes:new t.PhoneCallAttributes({participantType:n?t.Constants.PARTICIPANT_TYPE.THIRD_PARTY:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER,voiceCallId:e.data.voiceCallId,parentId:e.data.callAttributes?.parentId,isConsultCall:n}),state:t.Constants.CALL_STATE.RINGING}),i=s.renderContact||e.data.renderContact;if(r.callInfo=Object.assign(s,JSON.parse(localStorage.getItem("callInfo"))),this.state.isMultipartyAllowed||(r.callInfo.isOnHold=!1),i&&(r.contact=new t.Contact(i),r.toContact=this.getCurrentUserContact()),r.callInfo.renderContactId=e.fromUsername,this.addCall(r),a?.isUnifiedRoutingEnabled);else{let e=new t.CallResult({call:r});(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_STARTED,payload:e})}this.state.isMultipartyAllowed&&!n&&(this.state.activeConferenceCalls=e.data.activeConferenceCalls)}startInternalCall(e){const n=new t.Contact({phoneNumber:e.data.contact.phoneNumber,id:e.data.contact.id,type:e.data.contact.type,name:e.data.contact.name}),a=new t.PhoneCall({callType:t.Constants.CALL_TYPE.INTERNAL_CALL,phoneNumber:e.data.contact.phoneNumber,callId:e.data.callId,contact:n,callInfo:new t.CallInfo({isOnHold:!1,renderContactId:e.data.renderContact.name}),callAttributes:new t.PhoneCallAttributes({participantType:t.Constants.PARTICIPANT_TYPE.AGENT})});this.addCall(a);let s=new t.CallResult({call:a});(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_STARTED,payload:s})}updateConferenceUsers(e){this.state.isMultipartyAllowed&&this.state.activeConferenceCalls.length>0&&setTimeout((()=>{this.state.activeConferenceCalls.forEach((n=>{const a=this.state.activeCalls[n.callId];if(e||!a){const e=a?a.callAttributes:{isAutoMergeOn:!0};let s=this.state.isMultipartyAllowed?Object.assign(n.callInfo,JSON.parse(localStorage.getItem("callInfo"))):n.callInfo||{};s.callStateTimestamp=s.callStateTimestamp?new Date(s.callStateTimestamp):new Date,a&&(n.contact=a.contact,s.renderContactId=a.callInfo.renderContactId);const r=n.contact,i=new P(t.Constants.CALL_TYPE.ADD_PARTICIPANT,new t.Contact(r),new t.PhoneCallAttributes({participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY,...e}),new t.CallInfo(s),n.callId);i.fromContact=n.fromContact,i.toContact=n.toContact,this.addCall(i),this.connectParticipant(null,null,i)}})),this.state.activeConferenceCalls=[]}),1e3)}processCallDestroyed(e){if(e.callId){let n=null;try{n=this.getCall({callId:e.callId})}catch(t){}if(n)if(this.state.isMultipartyAllowed)if(e.target===this.state.agentId)if(n.callType===t.Constants.CALL_TYPE.CONSULT.toString()){let a=this.destroyCalls(n,e.reason),s=new t.CallResult({call:a.pop()});(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,payload:s})}else this.hangupMultiParty(n,e.reason,null);else{let a;try{a=this.getPrimaryCall()}catch(t){}let s=this.processEndCall(n,null,e.reason,!1),r=new t.CallResult({call:s.pop()});(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,payload:r}),a&&a.callInfo&&a.callInfo.renderContactId&&e.target===a.callInfo.renderContactId&&(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,payload:new t.ParticipantResult({callId:a.callId,contact:new t.Contact(r.call.contact),phoneNumber:r.call.contact&&r.call.contact.phoneNumber,callInfo:new t.CallInfo(r.call.callInfo),initialCallHasEnded:r.call.callAttributes&&r.call.callAttributes.initialCallHasEnded})})}else this.hangup(e.reason)}}subsystemLogout(){(0,t.publishEvent)({eventType:t.Constants.SHARED_EVENT_TYPE.LOGOUT_RESULT,payload:new t.LogoutResult({success:!this.state.throwError,loginFrameHeight:350})})}omniLogout(){return this.executeAsync("SubsystemLogout",new t.LogoutResult({success:!0,loginFrameHeight:350}))}getContacts(e,n){let a=this.filterContacts(this.state.messagingContacts,e);return this.executeAsync("getContacts",new t.ContactsResult({contacts:a}))}executeAsync(e,n){if(this.log(`Executing action - ${e}`,n),this.state.throwError){if(this.state.customError){const e=this.state.customError.split(".");return Promise.reject(new t.CustomError({namespace:e[0],labelName:e[1]}))}return Promise.reject("demo error")}switch(e){case"mute":case"unmute":if(!this.state.capabilities.hasMute)return Promise.reject(new Error("Mute is not supported"));break;case"conference":if(!this.state.capabilities.hasMerge)return Promise.reject(new Error("Conference is not supported"));break;case"swapCalls":if(!this.state.capabilities.hasSwap)return Promise.reject(new Error("Swap Calls is not supported"));break;case"pauseRecording":case"resumeRecording":if(!this.state.capabilities.hasRecord)return Promise.reject(new Error("Recording is not supported"));break;case"getSignedRecordingUrl":if(!this.state.capabilities.hasSignedRecordingUrl||!this.state.capabilities.signedRecordingUrl)return Promise.reject(new Error("Signed recording url is not supported"));break;case"onAgentWorkEvent":switch(n.workEvent){case t.Constants.WORK_EVENT.PAUSED:case t.Constants.WORK_EVENT.UNPAUSED:return Promise.resolve(n);case t.Constants.WORK_EVENT.ACCEPTED:return console.log("Agent accepted the work",n),Promise.resolve(n);case t.Constants.WORK_EVENT.DECLINED:return console.log("Agent declined the work",n),Promise.resolve(n)}}return 0===this.state.delayMs?Promise.resolve(n):this.delay(this.state.delayMs).then((()=>Promise.resolve(n)))}delay(t,e){return new Promise((n=>{setTimeout(n.bind(null,e),t)}))}getCurrentUserContact(){return new t.Contact({phoneNumber:this.state.agentId,id:this.state.agentId,type:this.state.type,name:this.state.userFullName})}dial(e,n,a,i,o){if(!o&&this.hasActiveCalls(t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER))return Promise.reject(new Error("Agent is not available for an outbound call"));n={...n,isOnHold:n?.isOnHold??!1,callStateTimestamp:new Date,renderContactId:e.id};const l={participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER,parentId:o?this.getPrimaryCall().callId:null,...o&&{isConsultCall:o}};let c=t.Constants.CALL_TYPE.OUTBOUND.toLowerCase();o?c=t.Constants.CALL_TYPE.CONSULT:i?c=t.Constants.CALL_TYPE.DIALED_CALLBACK:e.type===t.Constants.CONTACT_TYPE.AGENT&&(c=t.Constants.CALL_TYPE.INTERNAL_CALL.toLowerCase());const E=new P(c,e,l,new t.CallInfo(n));E.fromContact=this.getCurrentUserContact(),this.addCall(E);const T=new t.CallResult({call:E});if(!n.isSoftphoneCall&&a&&(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_STARTED,payload:T}),this.state.agentAvailable=!1,this.state.onlineUsers.includes(e.id)&&e.type===t.Constants.CONTACT_TYPE.AGENT){const n=this.getCurrentUserContact(),a=new t.Contact(n),i=new t.Contact(e);this.messageUser(e.id,o?s:r,{phoneNumber:e.phoneNumber,callId:E.callId,contact:e,renderContact:n,fromContact:a,toContact:i,isConsultCall:o,callAttributes:l})}return this.executeAsync("dial",T)}startInboundCall(e,n,a){if(a=a||{isUnifiedRoutingEnabled:!1},(n=n||{isOnHold:!1}).callStateTimestamp=new Date,!this.state.agentAvailable){const t=`Agent is not available for a inbound call from phoneNumber - ${e}`;return this.log(t),Promise.reject(new Error(t))}let s={participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER};const r=Math.random().toString(36).substring(5);let i=new t.Contact({phoneNumber:e,id:r,name:"Customer "+r});return this.createVoiceCall(void 0,t.Constants.CALL_TYPE.INBOUND,e,n&&n.additionalFields).then((e=>{s.voiceCallId=e.voiceCallId;const r=new P(t.Constants.CALL_TYPE.INBOUND.toLowerCase(),i,s,new t.CallInfo(n),e.vendorCallKey||this.generateCallId());r.fromContact=i,r.toContact=this.getCurrentUserContact(),this.addCall(r);const o=new t.CallResult({call:r});if(a?.isUnifiedRoutingEnabled){null==this.state.flowConfig?this.state.flowConfig={...a}:Object.assign(this.state.flowConfig,a),console.log("Inside isUnifiedRoutingEnabled "+a.isUnifiedRoutingEnabled);var l=this.executeOmniFlowForUnifiedRouting(e,a);console.log("response From execute onmi flow"+l)}else console.log("Non UnifiedRouting flow"),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_STARTED,payload:o});return this.executeAsync("startInboundCall",o)}))}getAllPhoneContacts(e){let n=[];for(let a=1;a<=e;a++)n=n.concat(new t.Contact({id:"id"+a,type:t.Constants.CONTACT_TYPE.AGENT,name:["Agent Name "]+a,phoneNumber:"555555444"+a,availability:this.getRandomAvailability()}));for(let a=e+1;a<=2*e;a++)n=n.concat(new t.Contact({id:"id"+a,type:t.Constants.CONTACT_TYPE.QUEUE,name:"Queue Name "+a,queue:"Queue"+a,queueWaitTime:(400*Math.random()).toString()}));for(let a=2*e+1;a<=3*e;a++)n=n.concat(new t.Contact({id:"id"+a,type:t.Constants.CONTACT_TYPE.PHONEBOOK,name:"Phonebook Entry "+a,phoneNumber:"55566644"+a}));for(let a=3*e+1;a<=4*e;a++)n=n.concat(new t.Contact({id:"id"+a,type:t.Constants.CONTACT_TYPE.PHONENUMBER,name:"Phone Number "+a,phoneNumber:"5557774"+a}));for(let a=4*e+1;a<=5*e;a++)n=n.concat(new t.Contact({endpointARN:"arn"+a,type:t.Constants.CONTACT_TYPE.PHONENUMBER,name:["ARN "]+a,phoneNumber:"5555554"+a}));return n}getAllMessagingContacts(e){let n=[],a={0:t.Constants.CONTACT_LIST_TYPE.ALL,1:t.Constants.CONTACT_LIST_TYPE.CONFERENCE,2:t.Constants.CONTACT_LIST_TYPE.TRANSFER};for(let s=1;s<=e;s++)n=n.concat(new t.Contact({id:"id"+s,type:t.Constants.CONTACT_TYPE.AGENT,name:["Agent Name "]+s,availability:this.getRandomAvailability(),listType:a[s%3]}));for(let s=e+1;s<=2*e;s++)n=n.concat(new t.Contact({id:"id"+s,type:t.Constants.CONTACT_TYPE.QUEUE,name:"Queue Name "+s,queue:"Queue"+s,queueWaitTime:(400*Math.random()).toString(),listType:a[s%3]}));for(let s=2*e+1;s<=3*e;s++)n=n.concat(new t.Contact({id:"id"+s,type:t.Constants.CONTACT_TYPE.PHONENUMBER,name:"External Contact "+s,phoneNumber:"55566644"+s,listType:a[s%3]}));return n}getRandomAvailability(){return{0:t.Constants.AGENT_AVAILABILITY.AVAILABLE,1:t.Constants.AGENT_AVAILABILITY.BUSY,2:t.Constants.AGENT_AVAILABILITY.OFFLINE}[Math.floor(3*Math.random())]}getActiveCallsObj(){const e=JSON.parse(localStorage.getItem("activeCalls"))||{};return Object.keys(e).forEach((n=>{e[n].contact&&(e[n].contact=new t.Contact(e[n].contact)),e[n].toContact&&(e[n].toContact=new t.Contact(e[n].toContact)),e[n].fromContact&&(e[n].fromContact=new t.Contact(e[n].fromContact)),e[n].callInfo.callStateTimestamp=e[n].callInfo.callStateTimestamp?new Date(e[n].callInfo.callStateTimestamp):new Date,e[n].callInfo=new t.CallInfo(e[n].callInfo),e[n].callAttributes=new t.PhoneCallAttributes(e[n].callAttributes),e[n]=new t.PhoneCall(e[n])})),e}hasActiveCalls(t){return t?Object.values(this.state.activeCalls).filter((e=>e.callAttributes.participantType===t)).length>0:this.state.activeCalls&&Object.keys(this.state.activeCalls).length>0}getAgentConfig(){return this.executeAsync("getAgentConfig",new t.AgentConfigResult({phones:this.state.agentConfig.phones,selectedPhone:new t.Phone(this.state.agentConfig.selectedPhone)}))}getSharedCapabilities(){return this.executeAsync("getSharedCapabilities",new t.SharedCapabilitiesResult({hasContactSearch:this.state.capabilities.hasContactSearch,hasAgentAvailability:this.state.capabilities.hasAgentAvailability,hasQueueWaitTime:this.state.capabilities.hasQueueWaitTime,debugEnabled:this.state.capabilities.debugEnabled,hasTransferToOmniFlow:this.state.capabilities.hasTransferToOmniFlow,hasPendingStatusChange:this.state.capabilities.hasPendingStatusChange,hasSFDCPendingState:this.state.capabilities.hasSFDCPendingState}))}getVoiceCapabilities(){return this.executeAsync("getVoiceCapabilities",new t.VoiceCapabilitiesResult({hasMute:this.state.capabilities.hasMute,hasMerge:this.state.capabilities.hasMerge,hasRecord:this.state.capabilities.hasRecord,hasSwap:this.state.capabilities.hasSwap,hasSignedRecordingUrl:this.state.capabilities.hasSignedRecordingUrl,supportsMos:this.state.capabilities.supportsMos,hasSupervisorListenIn:this.state.capabilities.hasSupervisorListenIn,hasSupervisorBargeIn:this.state.capabilities.hasSupervisorBargeIn,hasBlindTransfer:this.state.capabilities.hasBlindTransfer,hasPhoneBook:this.state.capabilities.hasPhoneBook,canConsult:this.state.capabilities.canConsult,signedRecordingUrl:"",signedRecordingDuration:null,isDialPadDisabled:this.state.capabilities.isDialPadDisabled,isPhoneBookDisabled:this.state.capabilities.isPhoneBookDisabled,isHidSupported:this.state.capabilities.isHidSupported,hasSetExternalMicrophoneDeviceSetting:this.state.capabilities.hasSetExternalMicrophoneDeviceSetting,hasSetExternalSpeakerDeviceSetting:this.state.capabilities.hasSetExternalSpeakerDeviceSetting}))}getActiveCalls(){try{const e=this.getActiveCallsObj(),n=Object.values(e);return this.executeAsync("getActiveCalls",new t.ActiveCallsResult({activeCalls:n}))}catch(t){return Promise.reject("Error getting active calls. "+t)}}acceptCall(e){let n=null;if(!this.state.throwError){let a=this.getCall(e);const s=new t.Contact({phoneNumber:this.state.agentId,id:this.state.agentId,name:this.state.userFullName});a.receiverContact=s,a.toContact=this.getCurrentUserContact(),"internalcall"===a.callType&&(a.contact.name=a.callInfo.renderContactId);const r=a.callType.toLowerCase(),o=r!==t.Constants.CALL_TYPE.CALLBACK.toLowerCase()&&r!==t.Constants.CALL_TYPE.INTERNAL_CALL.toLowerCase()||a.state===t.Constants.CALL_STATE.CONNECTED?t.Constants.CALL_STATE.CONNECTED:t.Constants.CALL_STATE.RINGING;a.state=o,this.log("acceptCall",a),this.addCall(a),this.state.agentAvailable=!1,r!==t.Constants.CALL_TYPE.TRANSFER.toLowerCase()&&r!==t.Constants.CALL_TYPE.CONSULT.toLowerCase()||this.messageUser(null,i,{callInfo:a.callInfo,callType:r,call:a}),n=new t.CallResult({call:a}),this.updateConferenceUsers(!1)}return this.executeAsync("acceptCall",n)}declineCall(e){this.log("declineCall",e);const n=this.destroyCall(this.getCall(e),t.Constants.HANGUP_REASON.PHONE_CALL_ENDED);return this.state.activeConferenceCalls=[],this.state.agentAvailable=!0,this.executeAsync("declineCall",new t.CallResult({call:n}))}endCall(e,n){this.log("endCall",e,n);let a=this.processEndCall(e,n,t.Constants.HANGUP_REASON.PHONE_CALL_ENDED,!0);return this.executeAsync("endCall",new t.HangupResult({calls:a}))}processEndCall(e,n,a,s){let r=[];if(!this.state.throwError)if(this.state.isMultipartyAllowed){let i={};if(e.callId)i=this.getCall(e),!i.callAttributes||i.callAttributes?.participantType!==t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER||i.contact&&this.state.agentId!==i.contact.id?i.callType?.toLowerCase()===t.Constants.CALL_TYPE.CONSULT.toString().toLowerCase()&&i.callAttributes?.participantType.toLowerCase()===t.Constants.PARTICIPANT_TYPE.THIRD_PARTY.toString().toLowerCase()?r=this.hangupMultiParty(i,a,n):(r=this.destroyCalls(i,a),this.beginWrapup(r[0])):r=this.hangupMultiParty(i,a,n);else{i=Object.values(this.state.activeCalls).filter((t=>!0===t.callAttributes?.isConsultCall))[0]||this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}}),r=this.hangupMultiParty(i,a,n)}s&&this.messageUser(null,l,{callId:i.callId,reason:a,target:e.callId?i.callInfo.renderContactId:this.state.agentId})}else r=this.destroyCalls(e,a),this.beginWrapup(r[0]);return this.state.agentAvailable=0===Object.keys(this.state.activeCalls).length,r}mute(t){return this.processMute(t,!0)}unmute(t){return this.processMute(t,!1)}processMute(e,n){const a=!!e&&e.isGlobal,s=e&&e.isSupervisor;e=this.updateCallInfo({isMuted:n},e);const r=this.getPrimaryCall().callId===e.callId,i=a?this.state.agentId:r&&e.contact?e.contact.id?e.contact.id:e.contact.phoneNumber:e.callInfo.renderContactId;e.callAttributes.target=i;const o=n?c:E;return this.state.isMultipartyAllowed&&!1===s&&this.messageUser(null,o,e,n),this.executeAsync("mute",new t.MuteToggleResult({isMuted:n,call:e,isGlobal:a}))}async processBroadcastMute(e,n){const a=e.callAttributes.target,s=this.state.agentId===a,r=this.getCall({callInfo:{renderContactId:a}}),i=this.getPrimaryCall().contact.id===a;let o=s||i?this.getPrimaryCall():r;o=this.updateCallInfo({isMuted:n},o);let l=await this.executeAsync("mute",new t.MuteToggleResult({isMuted:n,call:o,isGlobal:s}));(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.MUTE_TOGGLE,payload:l})}hold(e){return this.updateHoldState(e,!0),this.executeAsync("hold",new t.HoldToggleResult({isThirdPartyOnHold:this.isOnHold({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}}),isCustomerOnHold:this.isOnHold({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}}),calls:this.state.activeCalls}))}resume(e){return this.updateHoldState(e,!1),this.executeAsync("resume",new t.HoldToggleResult({isThirdPartyOnHold:this.isOnHold({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}}),isCustomerOnHold:this.isOnHold({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}}),calls:this.state.activeCalls}))}pauseRecording(e){const n=!0;return e=e||this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}}),this.isConsultCall(e)&&(e=this.getCall({callAttributes:{isConsultCall:!0}})),this.executeAsync("pauseRecording",new t.RecordingToggleResult({isRecordingPaused:n,contactId:e.callId},this.updateCallInfo({isRecordingPaused:n},e)))}resumeRecording(e){const n=!1;return e=e||this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}}),this.isConsultCall(e)&&(e=this.getCall({callAttributes:{isConsultCall:!0}})),this.executeAsync("resumeRecording",new t.RecordingToggleResult({isRecordingPaused:n,contactId:e.callId},this.updateCallInfo({isRecordingPaused:n},e)))}superviseCall(e){if(this.hasActiveCalls())return Promise.reject(new Error("Agent is not available to supervise a call"));const n=new t.PhoneCall({callType:e.callType,contact:new t.Contact({phoneNumber:e.callType===t.Constants.CALL_TYPE.INBOUND?e.from:e.to}),callId:e.callId,callInfo:new t.CallInfo({initialCallId:e.callId,callStateTimestamp:new Date}),callAttributes:{voiceCallId:e.voiceCallId,participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR},state:this.state.agentConfig.selectedPhone.type===t.Constants.PHONE_TYPE.SOFT_PHONE?t.Constants.CALL_STATE.CONNECTED:t.Constants.CALL_STATE.RINGING});return this.addCall(n),this.executeAsync("superviseCall",new t.SuperviseCallResult({call:n}))}supervisorDisconnect(e){let n;return this.state.throwError||(n=this.destroyCalls({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}})),this.executeAsync("supervisorDisconnect",new t.SupervisorHangupResult({calls:n}))}supervisorBargeIn(e){const n=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}});return n.callAttributes.hasSupervisorBargedIn=e.isBargedIn=!0,e.supervisorName=this.state.userFullName,this.addCall(n),this.messageUser(null,o,e),this.executeAsync("supervisorBargeIn",new t.SuperviseCallResult({call:n}))}isOnHold(t){try{return this.getCall(t).callAttributes.isOnHold}catch(t){return}}updateHoldState(t,e){const n=this.getCall(t);n.callAttributes.isOnHold=e,n.callInfo.isOnHold=e,this.addCall(n)}swapCalls(e,n){const a=this.getCall(e),s=this.getCall(n);return this.updateHoldState(e,!a.callAttributes.isOnHold),this.updateHoldState(n,!s.callAttributes.isOnHold),this.executeAsync("swapCalls",new t.HoldToggleResult({isThirdPartyOnHold:this.isOnHold(e),isCustomerOnHold:this.isOnHold(n),calls:this.state.activeCalls}))}conference(e){const n=e||Object.values(this.state.activeCalls);let a;if(this.state.isMultipartyAllowed&&(this.hasConsultCall(n)||2===Object.keys(this.state.activeCalls).length)){let e;try{e=this.getCall({callAttributes:{isConsultCall:!0}})}catch(n){e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}})}e&&(this.mergeConsultCall(e),e.callAttributes.participantType=t.Constants.PARTICIPANT_TYPE.THIRD_PARTY,this.messageUser(null,T,{consultCall:e,activeConferenceCalls:Object.values(this.state.activeCalls)}));let n=this.getPrimaryCall();this.updateHoldState(n,!1)}else n.forEach((t=>{this.updateHoldState(t,!1)}));return a=new t.HoldToggleResult({isThirdPartyOnHold:!1,isCustomerOnHold:!1}),this.state.isMultipartyAllowed&&(a.calls=this.state.activeCalls,a.isCallMerged=!0),this.executeAsync("conference",a)}hasConsultCall(t){return this.state.isConsultAllowed&&this.state.capabilities.canConsult&&t?.some((t=>!0===t?.callAttributes?.isConsultCall))}mergeConsultCall(e){e.callAttributes.isConsultCall=!1,e.callType=t.Constants.CALL_TYPE.ADD_PARTICIPANT,e.callAttributes.isAutoMergeOn=!0,e.reason=t.Constants.HANGUP_REASON.PHONE_CALL_ENDED;let n=this.state.activeCalls[e.callId];if(n){let a={callAttributes:{isConsultCall:!1,isAutoMergeOn:!0,isOnHold:!1,participantType:e.callAttributes.participantType},callInfo:{isOnHold:!1},callType:t.Constants.CALL_TYPE.ADD_PARTICIPANT,reason:t.Constants.HANGUP_REASON.PHONE_CALL_ENDED};for(const t in a)n[t]="object"==typeof a[t]?Object.assign({},n[t],a[t]):a[t]}else this.addCall(e),this.updateHoldState(e,!1)}setAgentStatus(e,n,a){return this.agentStatus=e,this.toggleAgentPresence(!(e===t.Constants.AGENT_STATUS.OFFLINE)),this.executeAsync("setAgentStatus",new t.GenericResult({success:!0}))}sendDigits(t){return this.executeAsync("sendDigits")}getPhoneContacts(e){let n=[];this.state.onlineUsers.forEach((e=>{this.state.agentId!==e&&(n=n.concat(new t.Contact({id:e,type:t.Constants.CONTACT_TYPE.AGENT,name:this.state.userFullNames.get(e),availability:"AVAILABLE",phoneNumber:e})))}));let a=this.filterContacts(n.concat(this.state.phoneContacts),e);return this.executeAsync("getPhoneContacts",new t.PhoneContactsResult({contacts:a,contactTypes:this.state.contactTypes}))}async addParticipant(e,n,a){const r=this.getCall(n),i=n.callAttributes?.isAutoMergeOn,o={...r.callAttributes,isAutoMergeOn:i,isBlindTransfer:a},l=new t.Contact({phoneNumber:this.state.agentId,id:this.state.agentId,type:this.state.type,name:this.state.userFullName});let c,E={...r.callInfo?new t.CallInfo(r.callInfo):{},renderContact:l,renderContactId:e.id};void 0!==E.isExternalTransfer?c=E.isExternalTransfer:e&&(c=!!e.phoneNumber),E.isExternalTransfer=c,E.callStateTimestamp=new Date,E.initialCallId=r.callId;let T=E.additionalFields?E.additionalFields:r.callInfo&&r.callInfo.additionalFields,u=await this.createVoiceCall(r.callId,t.Constants.CALL_TYPE.TRANSFER,r.phoneNumber,T),C=e.id;if(e.type===t.Constants.CONTACT_TYPE.FLOW){let t=await this.executeOmniFlow(u,e.id);C=t.agent||t.queue}e.id||(e.id=Math.random().toString(36).substring(5));let h=u.vendorCallKey||this.generateCallId();if(this.state?.flowConfig?.isUnifiedRoutingEnabled){let t={transferTo:C,voiceCallId:h},e={dialedNumber:this.state.flowConfig.dialedNumber};await this.executeOmniFlowForUnifiedRouting(t,e)}if(a){this.state.onlineUsers.includes(C)?this.messageUser(C,s,{phoneNumber:r.phoneNumber,callId:h,voiceCallId:u.voiceCallId}):this.state?.flowConfig?.isUnifiedRoutingEnabled&&this.messageUser(null,s,{phoneNumber:r.phoneNumber,callId:h,voiceCallId:u.voiceCallId,flowConfig:this.state.flowConfig});const a=this.destroyCall(n,t.Constants.HANGUP_REASON.PHONE_CALL_ENDED);return this.log("addParticipant - cold transfer (destroyed call)",a),this.beginWrapup(a),this.executeAsync("addParticipant",new t.ParticipantResult({contact:e,phoneNumber:e.phoneNumber,callInfo:new t.CallInfo(E),callAttributes:o,initialCallHasEnded:!0,callId:n.callId}))}o.isOnHold=r.callInfo.isOnHold=!this.state.isMultipartyAllowed&&!i,E.isOnHold=!1;const _=o.voiceCallId;this.state.isMultipartyAllowed&&(E=Object.assign(E,JSON.parse(localStorage.getItem("callInfo")),{isRecordingPaused:!!r.callInfo&&r.callInfo.isRecordingPaused}));const d=new P(t.Constants.CALL_TYPE.ADD_PARTICIPANT,e,{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY,voiceCallId:_,isAutoMergeOn:i},new t.CallInfo(E),u.vendorCallKey||this.generateCallId());return d.parentCallId=r.callId,d.callAttributes.isOnHold=!1,d.state=t.Constants.CALL_STATE.TRANSFERRING,d.fromContact=l,this.log("addParticipant to parent voiceCall "+_,d),this.addCall(r),this.state.onlineUsers.includes(C)?this.messageUser(C,s,{phoneNumber:this.state.userFullName,callInfo:E,contact:e,initiatorContact:l,callId:d.callId,voiceCallId:u.voiceCallId,activeConferenceCalls:i?Object.values(this.state.activeCalls):[],flowConfig:this.state.flowConfig}):this.state?.flowConfig?.isUnifiedRoutingEnabled&&this.messageUser(null,s,{phoneNumber:this.state.userFullName,callInfo:E,contact:e,initiatorContact:l,callId:d.callId,voiceCallId:u.voiceCallId,activeConferenceCalls:i?Object.values(this.state.activeCalls):[],flowConfig:this.state.flowConfig}),this.addCall(d),this.executeAsync("addParticipant",new t.ParticipantResult({contact:e,phoneNumber:e.phoneNumber,callInfo:new t.CallInfo(E),callAttributes:o,initialCallHasEnded:o.initialCallHasEnded,callId:d.callId}))}onAgentWorkEvent(t){return this.messageUser(null,"AGENT_WORK_NOTIFICATION",t),this.executeAsync("onAgentWorkEvent",t)}executeOmniFlow(t,e){return fetch("/api/executeOmniFlow",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({flowName:e,voiceCallId:t.vendorCallKey||this.generateCallId()})}).then((t=>t.json())).then((t=>t)).catch((t=>Promise.reject(t)))}executeOmniFlowForUnifiedRouting(t,e){var n=e.dialedNumber,a=e.flowDevName,s=e.fallbackQueue;let r={dialedNumber:n,voiceCallId:t.voiceCallId,fallbackQueue:s};return t?.transferTo&&(r.transferTarget=t.transferTo),e?.isTransferFlow?r.flowDevName=a:r.flowName=a,fetch("/api/executeOmniFlow",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((t=>t.json())).then((t=>t)).catch((t=>(console.log("ERR ",t),Promise.reject(t))))}createVoiceCall(t,e,n,a){return fetch("/api/createVoiceCall?caller="+n+"&type="+e+(t?"&parentCallId="+t:"")+(a?"&additionalFields="+a:""),{headers:{"Strict-Transport-Security":"max-age=31536000"}}).then((t=>t.json())).then((t=>(t.voiceCallId||this.log("Could not contact Service Cloud Real ,Time. VoiceCall will be created by Salesforce Service Degradation Service."),t))).catch((t=>Promise.reject(t)))}connectParticipant(e,n,a){if(!this.hasActiveCalls())return;if(a?.callType===t.Constants.CALL_TYPE.CONSULT&&-1===Object.keys(this.state.activeCalls).indexOf(a.callId))return;let s;if(a&&(a.receiverContact?(a.callInfo.renderContactId=a.receiverContact.id,s=a.receiverContact):a.contact&&a.contact.id?a.callInfo.renderContactId=a.contact.id:a.contact&&a.contact.phoneNumber&&(a.callInfo.renderContactId=a.contact.phoneNumber)),this.state.isMultipartyAllowed&&a&&!this.state.activeCalls[a.callId]&&(a.callType=t.Constants.CALL_TYPE.ADD_PARTICIPANT,a.callAttributes.participantType=t.Constants.PARTICIPANT_TYPE.THIRD_PARTY,this.addCall(a)),n===t.Constants.CALL_TYPE.INTERNAL_CALL.toLowerCase()?(a=this.getCall({...a||{},callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}})).state=t.Constants.CALL_STATE.CONNECTED:n===t.Constants.CALL_TYPE.CONSULT.toLowerCase()?(a=this.getCall({...a||{},callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}})).state=t.Constants.CALL_STATE.CONNECTED:(a=this.getCall({...a||{},callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}})).state=t.Constants.CALL_STATE.TRANSFERRED,this.log("connectParticipant",a),this.addCall(a),n||(n=a.callType.toLowerCase()),n!==t.Constants.CALL_TYPE.INTERNAL_CALL.toLowerCase()&&n!==t.Constants.CALL_TYPE.CONSULT.toLowerCase()){let e=a.callInfo||{};e.callStateTimestamp=e.callStateTimestamp?new Date(e.callStateTimestamp):new Date,(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PARTICIPANT_CONNECTED,payload:new t.ParticipantResult({contact:s||a.contact,phoneNumber:a.contact&&a.contact.phoneNumber,callAttributes:a.callAttributes,callInfo:new t.CallInfo(e),initialCallHasEnded:a.callAttributes&&a.callAttributes.initialCallHasEnded,callId:a.callId})})}else(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_CONNECTED,payload:new t.CallResult({call:a})})}connectSupervisor(){const e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}});e.state=t.Constants.CALL_STATE.CONNECTED,this.log("connectSupervisor",e),this.addCall(e),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.SUPERVISOR_CALL_CONNECTED,payload:new t.SuperviseCallResult({call:e})})}removeParticipant(e,n){n=this.getCall({...n||{},callAttributes:{participantType:e}});const a=t.Constants.HANGUP_REASON.PHONE_CALL_ENDED,s=this.destroyCall(n,a);this.log("removeParticipant",n),this.state.isMultipartyAllowed&&this.messageUser(null,l,{callId:n.callId,reason:a}),this.state.agentAvailable=0===Object.keys(this.state.activeCalls).length,this.beginWrapup(s);const r=new t.CallResult({call:s});return(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PARTICIPANT_REMOVED,payload:r}),this.executeAsync("removeParticipant",r)}removeSupervisor(){const e=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.SUPERVISOR}}),n=this.destroyCall(e);this.log("removeSupervisor",e);const a=new t.SupervisorHangupResult({calls:n});return(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.SUPERVISOR_HANGUP,payload:a}),this.executeAsync("removeSupervisor",a)}connectCall(e,n){const a=n||this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}});a.state=t.Constants.CALL_STATE.CONNECTED,a.callInfo=Object.assign(a.callInfo,e),this.addCall(a),this.log("connectCall",a),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.CALL_CONNECTED,payload:new t.CallResult({call:a})})}hangup(e,n){let a=this.destroyCalls({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.AGENT}},e);return a.map((t=>(t.callInfo.isSoftphoneCall=!1,t.agentStatus=n,t.reason=e,t))),this.state.agentAvailable=0===Object.keys(this.state.activeCalls).length,(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.HANGUP,payload:new t.HangupResult({calls:a})}),this.beginWrapup(a[0]),this.executeAsync("hangup",a)}hangupMultiParty(e,n,a){let s=this.getActiveCallsList();return this.processCallsToDestroy(s,n),s.map((t=>(t.callInfo.isSoftphoneCall=!1,t.agentStatus=a,t.reason=n,t))),this.state.agentAvailable=0===Object.keys(this.state.activeCalls).length,(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.HANGUP,payload:new t.HangupResult({calls:[e]})}),this.beginWrapup(e),s}isConsultCall(e){return this.state.isConsultAllowed&&this.state.capabilities.canConsult&&(!0===e?.callAttributes?.isConsultCall||e?.callType?.toLowerCase()===t.Constants.CALL_TYPE.CONSULT.toLowerCase())}initiateHangupMultiParty(e,n){let a;try{a=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}})}catch(e){a=this.getCall({callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.THIRD_PARTY}})}this.hangupMultiParty(a,e,n),this.messageUser(null,l,{callId:a.callId,reason:e})}beginWrapup(e){setTimeout((()=>{this.state.agentAvailable&&(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.AFTER_CALL_WORK_STARTED,payload:{callId:e.callId}})}),0)}endWrapup(){this.log("endWrapup")}publishMessage(e){this.log("publishMessage",e),(0,t.publishEvent)({eventType:t.Constants.SHARED_EVENT_TYPE.MESSAGE,payload:e})}handleMessage(e){new BroadcastChannel("rc-request").postMessage({type:t.Constants.SHARED_EVENT_TYPE.MESSAGE,payload:e}),this.log("handleMessage",e)}getSignedRecordingUrl(e,n,a){return this.executeAsync("getSignedRecordingUrl",new t.SignedRecordingUrlResult({success:this.state.capabilities.hasSignedRecordingUrl,url:this.state.capabilities.signedRecordingUrl,duration:parseInt(this.state.capabilities.signedRecordingDuration),callId:a}))}requestCallback(e){const{phoneNumber:n}=e,a=new t.CallInfo({callStateTimestamp:new Date}),s=new t.PhoneCall({callId:this.generateCallId(),phoneNumber:n,callInfo:a,callType:t.Constants.CALL_TYPE.CALLBACK.toLowerCase(),contact:new t.Contact({phoneNumber:n}),callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}});this.addCall(s),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.QUEUED_CALL_STARTED,payload:new t.CallResult({call:s})})}previewCall(e){const{phoneNumber:n}=e,a=new t.CallInfo({callStateTimestamp:new Date}),s=new t.PhoneCall({callId:this.generateCallId(),phoneNumber:n,callInfo:a,callType:t.Constants.CALL_TYPE.OUTBOUND.toLowerCase(),contact:new t.Contact({phoneNumber:n}),callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER,dialerType:t.Constants.DIALER_TYPE.OUTBOUND_PREVIEW}});this.addCall(s),(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.PREVIEW_CALL_STARTED,payload:new t.CallResult({call:s})})}updateAudioStats(e){this.log("updateAudioStats",e);let n=[];e.stats.forEach((e=>{let a,s;e.inputChannelStats&&(a=new t.StatsInfo(e.inputChannelStats)),e.outputChannelStats&&(s=new t.StatsInfo(e.outputChannelStats)),n.push(new t.AudioStatsElement({inputChannelStats:a,outputChannelStats:s}))}));const a=new t.AudioStats({stats:n,callId:e.callId,isAudioStatsCompleted:e.isAudioStatsCompleted});(0,t.publishEvent)({eventType:t.Constants.VOICE_EVENT_TYPE.UPDATE_AUDIO_STATS,payload:a})}updateRemoveTransferCallParticipantVariant(t){this.state.updateRemoveTransferCallParticipantVariant=t}publishSetAgentStatus(e){(0,t.publishEvent)({eventType:"SET_AGENT_STATUS",payload:new t.AgentStatusInfo({statusId:e})})}publishCallBargedInEventToAgents(e){(0,t.publishEvent)({eventType:"CALL_BARGED_IN",payload:new t.SupervisedCallInfo(e)})}isSupervisorListeningIn(){return this.state.capabilities.hasSupervisorListenIn&&Object.values(this.state.activeCalls||{}).some((e=>e?.callAttributes?.participantType===t.Constants.PARTICIPANT_TYPE.SUPERVISOR))}async ctrSync(t){if(!t)return{success:!1,message:"Voice Call ID is required"};try{if(!(await this.verifyCallState()).allParticipantsHungUp)return{success:!1,message:"Cannot sync CTR: Not all participants have hung up"};const e=await fetch("/api/updateVoiceCall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voiceCallId:t,endTime:(new Date).toISOString(),isActiveCall:!1})});return e.ok?(await e.json()).success?{success:!0,message:"Voice call updated successfully"}:{success:!1,message:"Voice call update failed"}:{success:!1,message:`Voice call update failed with status ${e.status}`}}catch(t){return{success:!1,message:`Voice call update failed: ${t.message}`}}}async verifyCallState(){return Object.keys(this.state.activeCalls).length>0?{allParticipantsHungUp:!1}:{allParticipantsHungUp:!0}}}class m extends t.TelephonyConnector{constructor(t){super(),this.sdk=t}getActiveCalls(){return this.sdk.getActiveCalls()}acceptCall(t){return this.sdk.acceptCall(t)}declineCall(e){return this.sdk.declineCall(e||{callAttributes:{participantType:t.Constants.PARTICIPANT_TYPE.INITIAL_CALLER}})}endCall(t,e){return this.sdk.endCall(t,e)}mute(t){return this.sdk.mute(t)}unmute(t){return this.sdk.unmute(t)}hold(t){return this.sdk.hold(t)}resume(t){return this.sdk.resume(t)}pauseRecording(t){return this.sdk.pauseRecording(t)}resumeRecording(t){return this.sdk.resumeRecording(t)}swap(t,e){return this.sdk.swapCalls(t,e)}conference(t){return this.sdk.conference(t)}dial(t,e){return this.sdk.dial(t,{},!1,e&&e.isCallback,e&&e.isConsultCall)}sendDigits(t){return this.sdk.sendDigits(t)}getPhoneContacts(t){return this.sdk.getPhoneContacts(t)}addParticipant(t,e,n){return this.sdk.addParticipant(t,e,n)}getAgentConfig(){return this.sdk.getAgentConfig()}setAgentConfig(t){return this.sdk.setAgentConfig(t)}getVoiceCapabilities(){return this.sdk.getVoiceCapabilities()}setCapabilities(t){return this.sdk.setCapabilities(t)}wrapUpCall(){this.sdk.endWrapup()}getSignedRecordingUrl(t,e,n){return this.sdk.getSignedRecordingUrl(t,e,n)}superviseCall(t){return console.log("superviseCall",t),this.sdk.superviseCall(t)}supervisorDisconnect(t){return console.log("supervisorDisconnect",t),this.sdk.supervisorDisconnect(t)}supervisorBargeIn(t){return console.log("supervisorBargeIn",t),this.sdk.supervisorBargeIn(t)}}class y extends t.VendorConnector{constructor(t){super(),this.sdk=new b(t),this.telephonyConnector=new m(this.sdk)}getTelephonyConnector(){return this.telephonyConnector}init(t){return this.sdk.init(t)}setAgentStatus(t,e,n){return this.sdk.setAgentStatus(t,e,n)}onAgentWorkEvent(t){return this.sdk.onAgentWorkEvent(t)}logout(){return this.sdk.omniLogout()}handleMessage(t){return this.sdk.handleMessage(t)}getContacts(t,e){return this.sdk.getContacts(t,e)}getSharedCapabilities(){return this.sdk.getSharedCapabilities()}}class D extends C.EventEmitter{}new D;const V=new y;window.addEventListener("load",(()=>{(0,t.initializeConnector)(V),function(e){e.sdk.eventEmitter.on("event",(async n=>{if(n&&n.data)try{let s,r;switch(n.data.type){case a.LOGIN_SUBMIT:e.sdk.subsystemLoginResult(n.data.success);break;case a.GET_SHOW_LOGIN_PAGE:{const{showLoginPage:t}=e.sdk.state;e.sdk.messageUser(n.fromUsername,a.SHOW_LOGIN_PAGE,{type:a.SHOW_LOGIN_PAGE,value:t})}break;case a.GET_AGENT_CONFIG:{const{agentConfig:t,contactCenterChannels:s,agentId:r,userPresenceStatuses:i,isMultipartyAllowed:o,isConsultAllowed:l}=e.sdk.state;e.sdk.messageUser(n.fromUsername,a.AGENT_CONFIG,{type:a.AGENT_CONFIG,value:t,userPresenceStatuses:i,contactCenterChannels:s,referrer:`${document.referrer}`,agentId:r,isMultipartyAllowed:o,isConsultAllowed:l})}break;case a.GET_CAPABILITIES:{const{capabilities:t,agentId:s}=e.sdk.state;e.sdk.messageUser(n.fromUsername,a.CAPABILITIES,{type:a.CAPABILITIES,value:t,referrer:`${document.referrer}`,agentId:s})}break;case a.CALL_INFO_UPDATED:e.sdk.updateCallInfoObj(n);break;case a.GET_ACTIVE_CALLS:e.sdk.messageUser(n.fromUsername,a.ACTIVE_CALLS,{type:a.ACTIVE_CALLS,value:Object.values(e.sdk.getActiveCallsObj())});break;case a.THROW_ERROR:e.sdk.throwError(n.data.value);break;case a.CUSTOM_ERROR:e.sdk.customErrorChanged(n.data.value);break;case a.SET_SHOW_LOGIN_PAGE:e.sdk.showLoginPage(n.data.value);break;case a.SET_AGENT_CONFIG:e.sdk.updateAgentConfig({selectedPhone:n.data.value.selectedPhone});break;case a.SET_CAPABILITIES:e.sdk.updateCapabilities({hasMute:n.data.value.hasMute,hasRecord:n.data.value.hasRecord,hasSwap:n.data.value.hasSwap,hasMerge:n.data.value.hasMerge,hasContactSearch:n.data.value.hasContactSearch,hasSignedRecordingUrl:n.data.value.hasSignedRecordingUrl,signedRecordingUrl:n.data.value.signedRecordingUrl,signedRecordingDuration:n.data.value.signedRecordingDuration,supportsMos:n.data.value.supportsMos,hasSupervisorListenIn:n.data.value.hasSupervisorListenIn,hasSupervisorBargeIn:n.data.value.hasSupervisorBargeIn,hasBlindTransfer:n.data.value.hasBlindTransfer,hasPhoneBook:n.data.value.hasPhoneBook,debugEnabled:n.data.value.debugEnabled,hasAgentAvailability:n.data.value.hasAgentAvailability,hasQueueWaitTime:n.data.value.hasQueueWaitTime,hasTransferToOmniFlow:n.data.value.hasTransferToOmniFlow,hasPendingStatusChange:n.data.value.hasPendingStatusChange,canConsult:n.data.value.canConsult,isDialPadDisabled:n.data.value.isDialPadDisabled,isPhoneBookDisabled:n.data.value.isPhoneBookDisabled,isHidSupported:n.data.value.isHidSupported,hasSetExternalMicrophoneDeviceSetting:n.data.value.hasSetExternalMicrophoneDeviceSetting,hasSetExternalSpeakerDeviceSetting:n.data.value.hasSetExternalSpeakerDeviceSetting});break;case a.SET_CONTACT_TYPES:e.sdk.updateContactTypes(n.data.contactTypes);break;case a.START_OUTBOUND_CALL:await e.sdk.dial(new t.Contact({phoneNumber:n.data.phoneNumber}),n.data.callInfo,!0);break;case a.CONSULT:await e.sdk.dial(new t.Contact(n.data.contact),n.data.callInfo,!0,!1,!0);break;case a.START_INBOUND_CALL:case a.PROGRESSIVE_DIALER:await e.sdk.startInboundCall(n.data.phoneNumber,n.data.callInfo,n.data.flowConfig);break;case a.CONNECT_PARTICIPANT:e.sdk.connectParticipant(null,null,n.data.call);break;case a.SET_AGENT_STATUS:e.sdk.publishSetAgentStatus(n.data.statusId);break;case a.CONNECT_SUPERVISOR:e.sdk.connectSupervisor();break;case a.REMOVE_PARTICIPANT:case a.END_CALL:e.sdk.removeParticipant(n.data.participantType,n.data.call);break;case a.REMOVE_SUPERVISOR:e.sdk.removeSupervisor();break;case a.CONNECT_CALL:e.sdk.connectCall(n.data.callInfo);break;case a.AGENT_HANGUP:{const{isMultipartyAllowed:t}=e.sdk.state;t?e.sdk.initiateHangupMultiParty(n.data.reason,n.data.agentErrorStatus):e.sdk.hangup(n.data.reason,n.data.agentErrorStatus)}break;case a.SOFTPHONE_LOGOUT:e.sdk.subsystemLogout();break;case a.CREATE_TRANSCRIPTION:fetch("/api/createTranscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.data)}).then((t=>{e.sdk.log(`Create transcript returned with ${t.success}`)})).catch((t=>{e.sdk.log(`Create transcript failed - ${t}`)}));break;case a.SEND_VOICE_MAIL:fetch("/api/sendVoiceMail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.data.voiceMailDetails)}).then((t=>{e.sdk.log(`Store recording link returned with ${t.success}`)})).catch((t=>{e.sdk.log(`Store recording link failed - ${t}`)}));break;case a.SEND_REALTIME_CONVERSATION_EVENTS:fetch("/api/sendRealtimeConversationEvents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.data.sendRealtimeConversationEventsDetails)}).then((t=>{e.sdk.log(`sendRealtimeConversationEvents returned with ${t.success}`)})).catch((t=>{e.sdk.log(`sendRealtimeConversationEvents failed - ${t}`)}));break;case a.SEND_RECORDING:fetch("/api/updateVoiceCall",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.data.recordingInfo)}).then((t=>{e.sdk.log(`Store recording link returned with ${t.success}`)})).catch((t=>{e.sdk.log(`Store recording link failed - ${t}`)}));break;case a.MESSAGE_FROM_CONNECTOR:await e.sdk.publishMessage(n.data.message);break;case a.REQUEST_CALLBACK:e.sdk.requestCallback(n.data.payload);break;case a.PUSH_DIALER:e.sdk.previewCall(n.data.payload);break;case a.SEND_AUDIO_STATS:await e.sdk.updateAudioStats(n.data.audioStats);break;case a.CTR_SYNC:try{const t=await e.sdk.ctrSync(n.data.voiceCallId);e.sdk.messageUser(n.fromUsername,a.CTR_SYNC_RESULT,{type:a.CTR_SYNC_RESULT,success:t.success,message:t.message})}catch(t){e.sdk.messageUser(n.fromUsername,a.CTR_SYNC_RESULT,{type:a.CTR_SYNC_RESULT,success:!1,message:t.message})}break;case a.REMOVE_TRANSFER_PARTICIPANT_VARIANT:e.sdk.updateRemoveTransferCallParticipantVariant(n.data.variant);break;case a.HARDPHONE_EVENT:{const s=n.data.eventType,r=n.data.payload;let i;switch(s){case a.VOICE_EVENT_TYPE.MUTE_TOGGLE:i=r.isMuted?await e.sdk.mute(r.call):await e.sdk.unmute(r.call);break;case a.VOICE_EVENT_TYPE.HOLD_TOGGLE:i=r.isCustomerOnHold?await e.sdk.hold(r.call):await e.sdk.resume(r.call);break;case a.VOICE_EVENT_TYPE.RECORDING_TOGGLE:i=r.isRecordingPaused?await e.sdk.pauseRecording(r.call):await e.sdk.resumeRecording(r.call);break;case a.VOICE_EVENT_TYPE.PARTICIPANT_ADDED:i=await e.sdk.addParticipant(new t.Contact(r.contact),r.call);break;case a.VOICE_EVENT_TYPE.PARTICIPANTS_SWAPPED:i=await e.sdk.swapCalls(r.call,r.thirdPartyCall);break;case a.VOICE_EVENT_TYPE.PARTICIPANTS_CONFERENCED:i=await e.sdk.conference(r)}(0,t.publishEvent)({eventType:s,payload:i})}break;case a.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_STARTED:case a.SHARED_EVENT_TYPE.AFTER_CONVERSATION_WORK_ENDED:(0,t.publishEvent)({eventType:n.data.type,payload:new t.ACWInfo(n.data.acwInfo)});break;case a.CALL_UPDATED:s=new t.PhoneCall({callInfo:new t.CallInfo(n.data.payload)}),r=new t.CallResult({call:s}),(0,t.publishEvent)({eventType:n.data.eventType,payload:r});break;default:(0,t.publishEvent)({eventType:n.data.type})}}catch(s){const r=n.data.eventType;e.sdk.messageUser(n.fromUsername,a.ERROR,{type:a.ERROR,error:`${s.message} (Event: ${r||n.data.type})`}),console.error(`Error occured when published event ${r} from the hardphone simulator: ${s.message}`),e.sdk&&e.sdk.state.publishHardphoneErrors&&(0,t.publishError)({eventType:r,error:s})}}))}(V),function(e){e.sdk.eventEmitter.on("event",(async n=>{if(n&&n.data)try{switch(n.data.type){case a.GET_AGENT_CONFIG:{const{agentConfig:t,contactCenterChannels:s,agentId:r,userPresenceStatuses:i,isSCVMultipartyAllowed:o}=e.sdk.state;e.sdk.messageUser(n.fromUsername,a.AGENT_CONFIG,{type:a.AGENT_CONFIG,value:t,userPresenceStatuses:i,contactCenterChannels:s,referrer:`${document.referrer}`,agentId:r,isSCVMultipartyAllowed:o})}break;case a.SET_AGENT_CONFIG:e.sdk.updateAgentConfig({selectedPhone:n.data.value.selectedPhone});break;case a.SET_AGENT_STATUS:e.sdk.publishSetAgentStatus(n.data.statusId)}}catch(s){const r=n.data.eventType;e.sdk.messageUser(n.fromUsername,a.ERROR,{type:a.ERROR,error:`${s.message} (Event: ${r||n.data.type})`}),console.error(`Error occured when published event ${r} from the hardphone simulator: ${s.message}`),e.sdk.state.publishHardphoneErrors&&(0,t.publishError)({eventType:r,error:s})}}))}(V)}))})()})();
//# sourceMappingURL=main.bundle.js.map